# ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____  
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯       _____________________________________________________        ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯        __/¯¯\__[ Dynamically Engineered Digital Security ]__/¯¯\__         ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  _________________________ ________________ ___________________________________  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__// | Application Development | Virtualization | Network and Hardware Magistration | \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__// 
#//¯¯    
#\\  [ Use-ViperBombServices ] @: Services & Group Policy Template Generator [ Extensively Modified version of "MadBomb122" & Charles Spark's scripts ] 
#//   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____      
#\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/---\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\___  
#//¯¯\\___________________________________________________________________________________¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\___ __ ____ -- ____ __ ____ -- ____ __ ____ -- ____ __ ___// 
# ¯¯¯\\__[ Initial Script Prerequisite Declarations ]____________________________________//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯¯  
#     ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
#
#     Foreword: This script has been extensively modified/completely revamped, however I still make every effort to credit the original authors.
#     ¯¯¯¯¯¯¯¯                       ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯          ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#               Revisions include, the 'code-behind' PowerShell script, as well as the XAML GUI.
#
#               MadBomb122 has a real name and in respect to him, I have chosen to leave that information outside of this script.
#               I have collaborated with MadBomb122 over the course of the last 6-7 months, tentatively, in helping to teach him some refinement
#               techniques on my journey to advance my Application Development experience.
#
#               The desired end result of working with this script, is to easily implement government grade STIG templates for end users, which 
#               you can find some of those technical details/documents here -> @ https://github.com/nsacyber/Windows-Secure-Host-Baseline
#              
#               - MCC / SDP
#   _________________________
#   [ Original Script & GUI ] -> I will be adding an option that enables the use his legacy script
#   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#       Author: Madbomb122
#      Website: https://GitHub.com/Madbomb122/BlackViperScript/
#   _________________________
#   [ Service Configuration ] -> I will be adding additional service configuration types for Windows Server 2016 +
#   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#       Author: Charles "Black Viper" Sparks
#      Website: http://www.BlackViper.com/
#                                                                                   #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-Script # Provides Global Script Definitions _______________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( ParameterSetName =    "Version" ) ] [ Switch ] $Version   ,
            [ Parameter ( ParameterSetName =     "Update" ) ] [ Switch ] $Company   ,
            [ Parameter ( ParameterSetName =    "MadBomb" ) ] [ Switch ] $MadBomb   ,
            [ Parameter ( ParameterSetName =     "Sparks" ) ] [ Switch ] $Sparks    ,
            [ Parameter ( ParameterSetName =       "Path" ) ] [ Switch ] $Path      ,
            [ Parameter ( ParameterSetName =    "Control" ) ] [ Switch ] $Control   ,
            [ Parameter ( ParameterSetName =  "Copyright" ) ] [ Switch ] $Copyright ,
            [ Parameter ( ParameterSetName =       "Help" ) ] [ Switch ] $Help      ,
            [ Parameter ( ParameterSetName =   "Services" ) ] [ Switch ] $Services  )

        $Default = [ PSCustomObject ]@{

            PassedArgs           = If ( ! $Args ) { "N/A" } Else { $Args }
            TermsOfService       = 0
            DisplayActive        = 1
            DisplayInactive      = 0
            DisplaySkipped       = 0
            MiscSimulate         = 0
            MiscXbox             = 0
            MiscChange           = 0
            MiscStopDisabled     = 0
            DevelDiagErrors      = 0
            DevelLog             = 0
            DevelConsole         = 0
            DevelDiagReport      = 0
            BypassBuild          = 0
            BypassEdition        = 0
            BypassLaptop         = 0
            LoggingServiceFile   = "Service.log"
            LoggingScriptFile    = "Script.log"
            BackupRegistryFile   = "Backup.reg"
            BackupTemplateFile   = "Backup.csv"
            ServiceConfig        = "Black Viper (Sparks v1.0)"
            ScriptConfig         = "DevOPS (MC/SDP v1.0)"

        }

        If ( $Version )
        {
            [ PSCustomObject ]@{
    
                Version        = "ViperBomb v7.0.0"
                Date           = "2020-01-07"
                Script         = $Default.ScriptConfig
                Service        = $Default.ServiceConfig
                Release        = "Testing"
            }
        }

        If ( $Company )
        {
            "https://github.com/secure-digits-plus-llc/FightingEntropy" | % {

                [ PSCustomObject ]@{

                    Base    = "$_"
                    About   = "$_#secure-digits-plus-fighting-entropy"
                    Service = "$_/blob/master/Module/Services/$( $Default.ServiceConfig )"
                    Site    = "https://www.securedigitsplus.com"
                }
            }
        }

        If ( $MadBomb )
        {
            "https://github.com/madbomb122/BlackViperScript" | % { 

                [ PSCustomObject ]@{

                    Base   = "$_"
                    About  = "$_/blob/master/README.md"
                    Donate = "https://www.amazon.com/gp/registry/wishlist/YBAYWBJES5DE/"
                }
            }
        }

        If ( $Sparks )
        {
            [ PSCustomObject ]@{

                Website = "http://www.blackviper.com"
            }
        }

        If ( $Path )
        {
            ( $PSCommandPath , $PSISE.CurrentFile.FullPath )[ $PSISE -ne $Null ] | % {
            
                [ PSCustomObject ]@{ 
            
                    Parent = Split-Path $_ -Parent
                    Leaf   = Split-Path $_ -Leaf
                }
            }
        }

        If ( $Control )
        {
            $Default
        }

        If ( $Copyright )
        {   
            "Copyright (c) 2019 Zero Rights Reserved                                 " ,
            "Services Configuration by Charles 'Black Viper' Sparks                  " ,
            "------------------------------------------------------------------------" ,
            "The MIT License (MIT) + an added Condition " ,
            ( " " * 72 ) , 
            "Copyright (c) 2017-2019 Madbomb122 " ,
            "[ Black Viper Service Script ] " ,
            ( " " * 72 ) , 
            "Permission is hereby granted, free of charge, to any person obtaining a " ,
            "copy of this software and associated documentation files (the Software)," , 
            "to deal in the Software without restriction, including w/o limitation   " , 
            "the rights to: use/copy/modify/merge/publish/distribute/sublicense,     " , 
            "and/or sell copies of the Software, and to permit persons to whom the   " , 
            "Software is furnished to do so, subject to the following conditions:    " ,
            ( " " * 72 ) , 
            "The above copyright notice(s), this permission notice and ANY original  " , 
            "donation link shall be included in all copies or substantial portions of" , 
            "the Software.                                                           " ,
            ( " " * 72 ) , 
            " The software is provided 'As Is', without warranty of any kind, express" ,
            "or implied, including but not limited to warranties of merchantibility, " ,
            "or fitness for a particular purpose and noninfringement. In no event    " , 
            "shall the authors or copyright holders be liable for any claim, damages " ,
            "or other liability, whether in an action of contract, tort or otherwise," , 
            "arising from, out of or in connection with the software or the use or   " ,
            "other dealings in the software.                                         " ,
            ( " " * 72 ) ,
            "In other words, these terms of service must be accepted in order to use," ,
            "and in no circumstance may the author(s) be subjected to any liability  " ,
            "or damage resultant to its use.                                         " 
        }

        If ( $Help )
        {
            "List of Switches                                                                                          " , 
            "$( "-" * 108 )" , 
            "   " ,
            " Switch            Description of Switch                                                                  " , 
            "   " , 
            " -- Basic Switches --                                                                                     " , 
            "  -atos            Accepts ToS                                                                            " , 
            "  -auto            Implies -atos ... Runs the script to be Automated..                                    " , 
            "                   Closes on - User Input, Errors, or End of Script                                       " , 
            "   " , 
	        " -- Service Configuration Switches --                                                                     " , 
	        "  -default         Runs the script with Services to Default Configuration                                 " , 
            "  -safe            Runs the script with Services to Black Viper's Safe Configuration                      " , 
            "  -tweaked         Runs the script with Services to Black Viper's Tweaked Configuration                   " , 
            "  -lcsc File.csv   Loads Custom Service Configuration, File.csv = Name of your backup/custom file         " , 
            "   " ,
            " --Service Choice Switches--                                                                              " , 
            "  -all             Every windows services will change                                                     " , 
            "  -min             Just the services different from the default to safe/tweaked list                      " , 
            "  -sxb             Skips changes to all XBox Services                                                     " , 
            "   " ,
            " --Update Switches--                                                                                      " , 
	        "  -usc             Checks for Update to Script file before running                                        " , 
            "  -use             Checks for Update to Service file before running                                       " , 
            "  -sic             Skips Internet Check, if you can't ping GitHub.com for some reason                     " , 
            "   " ,
            " --Log Switches--                                                                                         " , 
            "  -log             Makes a log file named using default name Script.log                                   " , 
            "  -log File.log    Makes a log file named File.log                                                        " , 
            "  -baf             Log File of Services Configuration Before and After the script                         " , 
            "   " ,
            " --Backup Service Configuration--                                                                         " , 
            "  -bscc            Backup Current Service Configuration, Csv File                                         " , 
            "  -bscr            Backup Current Service Configuration, Reg File                                         " , 
            "  -bscb            Backup Current Service Configuration, Csv and Reg File                                 " , 
            "   " ,
            " --Display Switches--                                                                                     " , 
            "  -sas             Show Already Set Services                                                              " , 
            "  -snis            Show Not Installed Services                                                            " , 
            "  -sss             Show Skipped Services                                                                  " , 
            "   " ,
            " --Misc Switches--                                                                                        " , 
            "  -dry             Runs the Script and Shows what services will be changed                                " , 
            "  -css             Change State of Service                                                                " , 
            "  -sds             Stop Disabled Service                                                                  " , 
            "   " ,
            " --AT YOUR OWN RISK Switches--                                                                            " , 
            "  -secp            Skips Edition Check by Setting Edition as Pro                                          " , 
            "  -sech            Skips Edition Check by Setting Edition as Home                                         " , 
            "  -sbc             Skips Build Check                                                                      " , 
            "   " ,
            " --Dev Switches--                                                                                         " ,
            "  -devl            Makes a log file with various Diagnostic information, Nothing is Changed               " , 
            "  -diag            Shows diagnostic information, Stops -auto                                              " , 
            "  -diagf           Forced diagnostic information, Script does nothing else                                " , 
            "   " ,
            " --Help--                                                                                                 " ,
            "  -help            Shows list of switches, then exits script.. alt -h                                     " , 
            "  -copy            Shows Copyright/License Information, then exits script                                 "
        }

        If ( $Services )
        {
            [ PSCustomObject ]@{

                Xbox     = 'XblAuthManager' , 'XblGameSave' , 'XboxNetApiSvc' , 'XboxGipSvc' , 'xbgm'

                NetTCP   = 'Msmq' , 'Pipe' , 'Tcp' | % { "Net$_`Activator" }

                DataGrid = 'Index' , 'Scoped' , 'Profile' , 'Name' , 'Status' , 'StartType' , 'DelayedAutoStart' , 'DisplayName' , 'PathName' , 'Description'

                Skip     = @( "BcastDVRUserService" , "DevicePickerUserSvc" , "DevicesFlowUserSvc" , "PimIndexMaintenanceSvc" , "PrintWorkflowUserSvc" , 
                              "UnistoreSvc" , "UserDataSvc" , "WpnUserService" | % { "$_`_?????" } ; 'AppXSVC' , 'BrokerInfrastructure' , 'ClipSVC' , 
                              'CoreMessagingRegistrar' , 'DcomLaunch' , 'EntAppSvc' , 'gpsvc' , 'LSM' , 'MpsSvc' , 'msiserver' , 'NgcCtnrSvc' , 'NgcSvc' , 
                              'RpcEptMapper' , 'RpcSs' , 'Schedule' , 'SecurityHealthService' , 'sppsvc' , 'StateRepository' , 'SystemEventsBroker' ,
	                          'tiledatamodelsvc' , 'WdNisSvc' , 'WinDefend' )
            }
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Return-ViperBombGUI #______________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Mandatory , ParameterSetName =  'Main' ) ][ Switch ] $Main  ,
            [ Parameter ( Mandatory , ParameterSetName = 'Alert' ) ][ Switch ] $Alert )

    $GWF  = Resolve-HybridDSC -Graphics

    If ( $Main )
    {
        $Xaml = @"
        <Window                               
                                               xmlns = 'http://schemas.microsoft.com/winfx/2006/xaml/presentation'
                                             xmlns:x = 'http://schemas.microsoft.com/winfx/2006/xaml'
                                               Title = 'Secure Digits Plus LLC | Hybrid @ ViperBomb Service Configuration Utility'
                                              Height = '600'
                                           MinHeight = '600'
                                               Width = '800'
                                            MinWidth = '800'
                                                Icon = '$( $GWF.Icon )'
                                             Topmost = 'True'
                                         BorderBrush = 'Black'
                                          ResizeMode = 'CanResize'
                                 HorizontalAlignment = 'Center'
                               WindowStartupLocation = 'CenterScreen'>
            <Window.Resources>
                <Style x:Key         = 'SeparatorStyle1' 
                       TargetType    = '{x:Type Separator}'>
                    <Setter Property = 'SnapsToDevicePixels' 
                            Value    = 'True'/>
                    <Setter Property = 'Margin' 
                            Value    = '0,0,0,0'/>
                    <Setter Property = 'Template'>
                        <Setter.Value>
                            <ControlTemplate TargetType     = '{x:Type Separator}'>
                                <Border Height              = '24' 
                                        SnapsToDevicePixels = 'True' 
                                        Background          = '#FF4D4D4D' 
                                        BorderBrush         = 'Azure' 
                                        BorderThickness     = '1,1,1,1' 
                                        CornerRadius        = '5,5,5,5'/>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
                <Style TargetType    = '{x:Type ToolTip}'>
                    <Setter Property = 'Background' 
                            Value    = '#FFFFFFBF'/>
                </Style>
            </Window.Resources>
            <Window.Effect>
                <DropShadowEffect/>
            </Window.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height        = '20'/>
                    <RowDefinition Height        = '*'/>
                    <RowDefinition Height        = '60'/>
                </Grid.RowDefinitions>
                <Menu Grid.Row                   = '0'
                              IsMainMenu         = 'True'>
                    <MenuItem     Header         = 'Configuration'>
                        <MenuItem Header         = 'Home'>
                            <MenuItem Name       = 'MenuConfigHomeDefaultMax'
                                      Header     = 'Default Maximum'/>
                            <MenuItem Name       = 'MenuConfigHomeDefaultMin'
                                      Header     = 'Default Minimum'/>
                        </MenuItem>
                        <MenuItem Header         = 'Pro'>
                            <MenuItem Name       = 'MenuConfigProDefaultMax' 
                                      Header     = 'Default Maximum'/>
                            <MenuItem Name       = 'MenuConfigProDefaultMin' 
                                      Header     = 'Default Minimum'/>
                        </MenuItem>
                        <MenuItem     Header     = 'Desktop'>
                            <MenuItem Name       = 'MenuConfigDesktopSafeMax' 
                                      Header     = 'Safe Maximum'/>
                            <MenuItem Name       = 'MenuConfigDesktopSafeMin' 
                                      Header     = 'Safe Minimum'/>
                            <MenuItem Name       = 'MenuConfigDesktopTweakedMax' 
                                      Header     = 'Tweaked Maximum'/>
                            <MenuItem Name       = 'MenuConfigDesktopTweakedMin' 
                                      Header     = 'Tweaked Minimum'/>
                        </MenuItem>
                        <MenuItem     Header     = 'Laptop'>
                            <MenuItem Name       = 'MenuConfigLaptopSafeMax' 
                                      Header     = 'Safe Maximum'/>
                            <MenuItem Name       = 'MenuConfigLaptopSafeMin' 
                                      Header     = 'Safe Minimum'/>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem     Header         = 'Info'>
                        <MenuItem Name           = 'MenuInfoFeedback'
                                  Header         = 'Feedback'/>
                        <MenuItem Name           = 'MenuInfoFAQ'
                                  Header         = 'FAQ'/>
                        <MenuItem Name           = 'MenuInfoAbout'
                                  Header         = 'About'/>
                        <MenuItem Name           = 'MenuInfoCopyright'
                                  Header         = 'Copyright'/>
                        <MenuItem Header         = 'MadBomb122'>
                            <MenuItem Name       = 'MenuInfoMadBombDonate'
                                      Header     = 'Donate to MadBomb122'/>
                            <MenuItem Name       = 'MenuInfoMadBombGitHub'
                                      Header     = 'Original GUI/Script Source -> GitHub'/>
                        </MenuItem>
                        <MenuItem     Name       = 'MenuInfoBlackViper'
                                      Header     = 'BlackViper Service Configuration Website'/>
                        <MenuItem     Name       = 'MenuInfoSecureDigitsPlus'
                                      Header     = 'Secure Digits Plus: Fighting Entropy'/>
                    </MenuItem>
                </Menu>
                <Grid Grid.Row                   = '1'>
                    <TabControl BorderBrush      = 'Gainsboro' 
                                Grid.Row         = '1' 
                                Name             = 'TabControl'>
                        <TabControl.Resources>
                            <Style TargetType    = 'TabItem'>
                                <Setter Property = 'Template'>
                                    <Setter.Value>
                                        <ControlTemplate TargetType                   = 'TabItem'>
                                            <Border Name                              = 'Border' 
                                                    BorderThickness                   = '1,1,1,0' 
                                                    BorderBrush                       = 'Gainsboro' 
                                                    CornerRadius                      = '4,4,0,0' 
                                                    Margin                            = '2,0'>
                                                <ContentPresenter x:Name              = 'ContentSite' 
                                                                  VerticalAlignment   = 'Center' 
                                                                  HorizontalAlignment = 'Center' 
                                                                  ContentSource       = 'Header' 
                                                                  Margin              = '10,2'/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property      = 'IsSelected' 
                                                         Value         = 'True'>
                                                    <Setter TargetName = 'Border' 
                                                            Property   = 'Background' 
                                                            Value      = 'LightSkyBlue'/>
                                                </Trigger>
                                                <Trigger Property      = 'IsSelected' 
                                                         Value         = 'False'>
                                                    <Setter TargetName = 'Border' 
                                                            Property   = 'Background' 
                                                            Value      = 'GhostWhite'/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </TabControl.Resources>
                        <TabItem Header = 'Service Dialog'>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height = '60'/>
                                    <RowDefinition Height = '32'/>
                                    <RowDefinition Height =  '*'/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row = '0' >
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width = '1.25*' />
                                        <ColumnDefinition Width = '1.75*'/>
                                        <ColumnDefinition Width = '0.75*' />
                                        <ColumnDefinition Width = '0.75*' />
                                    </Grid.ColumnDefinitions>
                                    <GroupBox Grid.Column         = '0'
                                              Header              = 'Selected Profile' 
                                              Margin              = '5'>
                                        <TextBlock Name           = 'CurrentProfile'
                                                   TextAlignment  = 'Center'
                                                   Margin         = '5'/>
                                    </GroupBox>
                                    <GroupBox Grid.Column         = '1' 
                                              Header              = 'Operating System' 
                                              Margin              = '5' >
                                        <TextBlock Name           = 'CurrentOS'
                                                   TextAlignment  = 'Center'
                                                   Margin         = '5'/>
                                    </GroupBox>
                                    <GroupBox Grid.Column         = '2' 
                                              Header              = 'Current Build' 
                                              Margin              = '5' >
                                        <TextBlock Name           = 'CurrentBuild'
                                                   TextAlignment  = 'Center'
                                                   Margin         = '5'/>
                                    </GroupBox>
                                    <GroupBox Grid.Column         = '3' 
                                              Header              = 'Chassis' 
                                              Margin              = '5' >
                                        <TextBlock Name           = 'CurrentChassis'
                                                   TextAlignment  = 'Center'
                                                   Margin         = '5'/>
                                    </GroupBox>
                                </Grid>
                                <Grid Grid.Row                  = '1'>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width = '50'/>
                                        <ColumnDefinition Width = '*'/>
                                        <ColumnDefinition Width = '150'/>
                                        <ColumnDefinition Width = '200'/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column = '0' Margin = '5' FontSize='12' >Search:</TextBlock>
                                    <TextBox   Grid.Column = '1' Margin = '5' Name = 'ServiceDialogSearch' TextWrapping = 'Wrap' />
                                    <ComboBox  Grid.Column = '2' Margin = '5' Name = 'ServiceDialogSelect' VerticalAlignment = 'Center' Height='22'>
                                        <ComboBoxItem Content = 'Name' IsSelected = 'True'/>
                                        <ComboBoxItem Content = 'DisplayName'/>
                                        <ComboBoxItem Content = 'PathName'/>
                                        <ComboBoxItem Content = 'Description'/>
                                    </ComboBox>
                                    <TextBlock Grid.Column    = '3' 
                                               Margin         = '5' 
                                               TextAlignment  = 'Center'>
							            <Run   Background     = '#66FF66' 
                                               Text           = 'Scoped'/>
                                        <Run   Background     = '#FFFF66' 
                                               Text           = 'Unspecified'/>
                                        <Run   Background     = '#FF6666' 
                                               Text           = 'Non Scoped'/>
                                    </TextBlock>
                                </Grid>
                                <DataGrid Grid.Row                   = '2'
                                          Grid.Column                = '0'
                                          Name                       = 'ServiceDialogGrid'
                                          FrozenColumnCount          = '2' 
                                          AutoGenerateColumns        = 'False' 
                                          AlternationCount           = '2' 
                                          HeadersVisibility          = 'Column' 
                                          CanUserResizeRows          = 'False' 
                                          CanUserAddRows             = 'False' 
                                          IsTabStop                  = 'True'
                                          IsTextSearchEnabled        = 'True'
                                          SelectionMode              = 'Extended'>
                                    <DataGrid.RowStyle>
                                        <Style TargetType            = '{x:Type DataGridRow}'>
                                            <Style.Triggers>
                                                <Trigger Property    = 'AlternationIndex'
                                                         Value       = '0'>
                                                    <Setter Property = 'Background'
                                                            Value    = 'White'/>
                                                </Trigger>
                                                <Trigger Property    = 'AlternationIndex'
                                                         Value       = '1'>
                                                    <Setter Property = 'Background'
                                                            Value    = '#FFD8D8D8'/>
                                                </Trigger>
                                                <Trigger Property    = 'IsMouseOver'
                                                         Value       = 'True'>
                                                    <Setter Property = 'ToolTip'>
                                                        <Setter.Value>
                                                            <TextBlock Text         = '{Binding Description}'
                                                                       TextWrapping = 'Wrap'
                                                                       Width        = '400'
                                                                       Background   = '#FFFFFFBF'
                                                                       Foreground   = 'Black'/>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Setter Property                = 'ToolTipService.ShowDuration'
                                                            Value                   = '360000000'/>
                                                </Trigger>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding          = '{Binding Compliance}'
                                                                   Value            = 'True'/>
                                                        <Condition Binding          = '{Binding Matches}'
                                                                   Value            = 'False'/>
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property                = 'Background' 
                                                            Value                   = '#F08080'/>
                                                </MultiDataTrigger>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding          = '{Binding Compliance}'
                                                                   Value            = 'False'/>
                                                        <Condition Binding          = '{Binding Matches}'
                                                                   Value            = 'False'/>
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property                = 'Background' 
                                                            Value                   = '#FFFF66'/>
                                                </MultiDataTrigger>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding          = '{Binding Compliance}'
                                                                   Value            = 'True'/>
                                                        <Condition Binding          = '{Binding Matches}'
                                                                   Value            = 'True'/>
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property                = 'Background'
                                                            Value                   = '#66FF66'/>
                                                </MultiDataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.RowStyle>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header                  = 'Index'
                                                            Width                   = '40'
                                                            Binding                 = '{Binding Index}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                        <DataGridTextColumn Header                  = '@' 
                                                            Width                   = '20'
                                                            Binding                 = '{Binding Scoped}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                        <DataGridTextColumn Header                  = 'Profile' 
                                                            Width                   = '75'
                                                            Binding                 = '{Binding Profile}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                        <DataGridTextColumn Header                  = 'Name'
                                                            Width                   = '150'
                                                            Binding                 = '{Binding Name}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                        <DataGridTextColumn Header                  = 'Status'
                                                            Width                   = '75'
                                                            Binding                 = '{Binding Status}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                        <DataGridTextColumn Header                  = 'StartType' 
                                                            Width                   = '75' 
                                                            Binding                 = '{Binding StartType}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                        <DataGridTextColumn Header                  = 'Delay'
                                                            Width                   = '50'
                                                            Binding                 = '{Binding DelayedAutoStart}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                        <DataGridTextColumn Header                  = 'DisplayName'
                                                            Width                   = '150'
                                                            Binding                 = '{Binding DisplayName}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                        <DataGridTextColumn Header                  = 'PathName'
                                                            Width                   = '150'
                                                            Binding                 = '{Binding PathName}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                        <DataGridTextColumn Header                  = 'Description'
                                                            Width                   = '150'
                                                            Binding                 = '{Binding Description}'
                                                            CanUserSort             = 'True'
                                                            IsReadOnly              = 'True'/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <TextBlock Grid.Row = '2' Name = 'ServiceDialogEmpty' Margin = '20' VerticalAlignment = 'Center' HorizontalAlignment = 'Center' FontSize = '20'/>
                            </Grid>
                        </TabItem>
                        <TabItem                            Header                  = 'Preferences'>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height = '1.25*'/>
                                    <RowDefinition Height = '*'/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row = '0'>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width = '*'/>
                                        <ColumnDefinition Width = '*'/>
                                        <ColumnDefinition Width = '*'/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column = '2'>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height = '*'/>
                                            <RowDefinition Height = '*'/>
                                        </Grid.RowDefinitions>
                                        <GroupBox Grid.Row = '0' Header = 'Bypass / Checks [ Risky Options ]' Margin = '5'>
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height = '*'/>
                                                    <RowDefinition Height = '*'/>
                                                    <RowDefinition Height = '*'/>
                                                </Grid.RowDefinitions>
                                                <CheckBox   Grid.Row = '1' Margin = '5' Name = 'BypassBuild' Content = "Skip Build/Version Check"/>
                                                <ComboBox   Grid.Row = '0' VerticalAlignment = 'Center' Height = '24' Name = 'BypassEdition'>
                                                    <ComboBoxItem Content = 'Override Edition Check' IsSelected = 'True'/>
                                                    <ComboBoxItem Content = 'Windows 10 Home'/>
                                                    <ComboBoxItem Content = 'Windows 10 Pro'/>
                                                </ComboBox>
                                                <CheckBox   Grid.Row = '2' Margin = '5' Name = 'BypassLaptop' Content = 'Enable Laptop Tweaks'/>
                                            </Grid>
                                        </GroupBox>
                                        <GroupBox Grid.Row = '1' Header = 'Display' Margin = '5' >
                                            <Grid >
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height = '30'/>
                                                    <RowDefinition Height = '30'/>
                                                    <RowDefinition Height = '30'/>
                                                </Grid.RowDefinitions>
                                                <CheckBox  Grid.Row = '0' Margin = '5' Name = 'DisplayActive'    Content = "Show Active Services"           />
                                                <CheckBox  Grid.Row = '1' Margin = '5' Name = 'DisplayInactive'  Content = "Show Inactive Services"         />
                                                <CheckBox  Grid.Row = '2' Margin = '5' Name = 'DisplaySkipped'   Content = "Show Skipped Services"          />
                                            </Grid>
                                        </GroupBox>
                                    </Grid>
                                    <Grid Grid.Column = '0'>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height = '*'/>
                                            <RowDefinition Height = '2*'/>
                                        </Grid.RowDefinitions>
                                        <GroupBox Grid.Row = '0' Header = 'Service Configuration' Margin = '5'>
                                            <ComboBox  Grid.Row = '1' Name = 'ServiceProfile' Height ='24'>
                                                <ComboBoxItem Content = 'Black Viper (Sparks v1.0)' IsSelected = 'True'/>
                                                <ComboBoxItem Content = 'DevOPS (MC/SDP v1.0)' IsEnabled = 'False'/>
                                            </ComboBox>
                                        </GroupBox>
                                        <GroupBox Grid.Row = '1' Header = 'Miscellaneous' Margin = '5'>
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height = '30'/>
                                                    <RowDefinition Height = '30'/>
                                                    <RowDefinition Height = '30'/>
                                                    <RowDefinition Height = '30'/>
                                                </Grid.RowDefinitions>
                                                <CheckBox  Grid.Row = '0' Margin = '5' Name = 'MiscSimulate'     Content = "Simulate Changes [ Dry Run ]"   />
                                                <CheckBox  Grid.Row = '1' Margin = '5' Name = 'MiscXbox'         Content = "Skip All Xbox Services"         />
                                                <CheckBox  Grid.Row = '2' Margin = '5' Name = 'MiscChange'       Content = "Allow Change of Service State"  />
                                                <CheckBox  Grid.Row = '3' Margin = '5' Name = 'MiscStopDisabled' Content = "Stop Disabled Services"         />
                                            </Grid>
                                        </GroupBox>
                                    </Grid>
                                    <Grid Grid.Column = '1'>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height = '*'/>
                                            <RowDefinition Height = '2*'/>
                                        </Grid.RowDefinitions>
                                        <GroupBox Grid.Row = '0' Header = 'User Interface' Margin = '5'>
                                            <ComboBox  Grid.Row = '1' Name = 'ScriptProfile' Height = '24' >
                                                <ComboBoxItem Content = 'DevOPS (MC/SDP v1.0)' IsSelected =  'True'/>
                                                <ComboBoxItem Content = 'MadBomb (MadBomb122 v1.0)' IsEnabled  = 'False' />
                                            </ComboBox>
                                        </GroupBox>
                                        <GroupBox Grid.Row = '1' Header = 'Development' Margin = '5'>
                                            <Grid >
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height = '30'/>
                                                    <RowDefinition Height = '30'/>
                                                    <RowDefinition Height = '30'/>
                                                    <RowDefinition Height = '30'/>
                                                </Grid.RowDefinitions>
                                                <CheckBox  Grid.Row = '0' Margin = '5' Name = 'DevelDiagErrors'  Content = "Diagnostic Output [ On Error ]" />
                                                <CheckBox  Grid.Row = '1' Margin = '5' Name = 'DevelLog'         Content = "Enable Development Logging"     />
                                                <CheckBox  Grid.Row = '2' Margin = '5' Name = 'DevelConsole'     Content = "Enable Console"                 />
                                                <CheckBox  Grid.Row = '3' Margin = '5' Name = 'DevelDiagReport'  Content = "Enable Diagnostic"              />
                                            </Grid>
                                        </GroupBox>
                                    </Grid>
                                </Grid>
                                <Grid Grid.Row = '1'>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height = '*'/>
                                        <RowDefinition Height = '*'/>
                                    </Grid.RowDefinitions>
                                    <GroupBox Grid.Row = '0' Header = 'Logging: Create logs for all changes made via this utility' Margin = '5'>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width = '75'/>
                                                <ColumnDefinition Width = '*'/>
                                                <ColumnDefinition Width = '6*'/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height = '*' />
                                                <RowDefinition Height = '*' />
                                            </Grid.RowDefinitions>
                                            <Label    Grid.Row = '0' Grid.Column = '0' Content = 'Services:' VerticalAlignment = 'Center' HorizontalAlignment = 'Right'/>
                                            <Button   Grid.Row = '0' Grid.Column = '1' Margin  = '5' Name = 'LoggingServiceBrowse' Content   = 'Browse'  />
                                            <TextBox  Grid.Row = '0' Grid.Column = '2' Margin  = '5' Name = 'LoggingServiceFile'   IsEnabled = 'False'   />
                                            <Label    Grid.Row = '1' Grid.Column = '0' Content = 'Script:'   VerticalAlignment = 'Center' HorizontalAlignment = 'Right'/>
                                            <Button   Grid.Row = '1' Grid.Column = '1' Margin  = '5' Name = 'LoggingScriptBrowse'  Content   = 'Browse'  />
                                            <TextBox  Grid.Row = '1' Grid.Column = '2' Margin  = '5' Name = 'LoggingScriptFile'    IsEnabled = 'False'   />
                                        </Grid>
                                    </GroupBox>
                                    <GroupBox Grid.Row = '1' Header = 'Backup: Save your current Service Configuration' Margin = '5'>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width = '75'/>
                                                <ColumnDefinition Width = '*'/>
                                                <ColumnDefinition Width = '6*'/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height = '*' />
                                                <RowDefinition Height = '*' />
                                            </Grid.RowDefinitions>
                                            <Label    Grid.Row = '0' Grid.Column = '0' Content = 'Registry:' VerticalAlignment = 'Center' HorizontalAlignment = 'Right' />
                                            <Button   Grid.Row = '0' Grid.Column = '1' Margin  = '5' Name = 'BackupRegistryBrowse' Content   = 'Browse'  />
                                            <TextBox  Grid.Row = '0' Grid.Column = '2' Margin  = '5' Name = 'BackupRegistryFile'   IsEnabled = 'False'   />
                                            <Label    Grid.Row = '1' Grid.Column = '0' Content = 'Template:' VerticalAlignment = 'Center' HorizontalAlignment = 'Right' />
                                            <Button   Grid.Row = '1' Grid.Column = '1' Margin  = '5' Name = 'BackupTemplateBrowse' Content   = 'Browse'  />
                                            <TextBox  Grid.Row = '1' Grid.Column = '2' Margin  = '5' Name = 'BackupTemplateFile'   IsEnabled = 'False'   />
                                        </Grid>
                                    </GroupBox>
                                </Grid>
                            </Grid>
                        </TabItem>
                        <TabItem Header = 'Console'>
                            <Grid Background = '#FFE5E5E5'>
                                <ScrollViewer VerticalScrollBarVisibility = 'Visible'>
                                    <TextBlock Name = 'ConsoleOutput' TextTrimming = 'CharacterEllipsis' Background = 'White' FontFamily = 'Lucida Console'/>
                                </ScrollViewer>
                            </Grid>
                        </TabItem>
                        <TabItem Header = 'Diagnostics'>
                            <Grid Background = '#FFE5E5E5'>
                                <ScrollViewer VerticalScrollBarVisibility = 'Visible'>
                                    <TextBlock Name = 'DiagnosticOutput' TextTrimming = 'CharacterEllipsis' Background = 'White' FontFamily = 'Lucida Console'/>
                                </ScrollViewer>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
                <Grid Grid.Row = '2'>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width = '*'/>
                        <ColumnDefinition Width = '0.5*'/>
                        <ColumnDefinition Width = '0.5*'/>
                        <ColumnDefinition Width = '*'/>
                    </Grid.ColumnDefinitions>
                    <GroupBox Header = 'Service Config' Margin = '5' Grid.Column = '0'>
                        <TextBlock Name ='ServiceLabel' TextAlignment = 'Center' Margin = '5'/>
                    </GroupBox>
                    <Button    Grid.Column = '1' Name =  'Start' Content = 'Start'  Height = '20' Margin = '5'/>
                    <Button    Grid.Column = '2' Name = 'Cancel' Content = 'Cancel' Height = '20' Margin = '5'/>
                    <GroupBox Header = 'Script/Module' Margin = '5' Grid.Column='3'>
                        <TextBlock Name ='ScriptLabel' TextAlignment = 'Center' Margin = '5' />
                    </GroupBox>
                </Grid>
            </Grid>
        </Window>
"@

        $Named = @( @( "Home" , "Pro" | % { "$_`Default" } ; "DesktopSafe" , "DesktopTweaked" , "LaptopSafe" ) | % { "$_`Max" , "$_`Min" } | % { "MenuConfig$_" } ; 
        @( "Feedback" , "FAQ" , "About" , "Copyright" ; "Donate" , "GitHub"   | % { "MadBomb$_" } ; "BlackViper" , "SecureDigitsPlus" ) | % { "MenuInfo$_" } ; 
        "Search" , "Select" , "Grid" , "Empty"                                | % { "ServiceDialog$_" } ;
        "OS" , "Profile" , "Build" , "Chassis"                                | % { "Current$_"       } ;
        'Active' , 'Inactive' , 'Skipped'                                     | % { "Display$_"       } ; 
        'Simulate' , 'Xbox' , 'Change' , 'StopDisabled'                       | % { "Misc$_"          } ; 
        'DiagErrors' , 'Log' , 'Console' , 'DiagReport'                       | % { "Devel$_"         } ; 
        'Build' , 'Edition' , 'Laptop'                                        | % { "Bypass$_"        } ; 
        'Service' , 'Script'    | % { "$_`Browse" , "$_`File" }               | % { "Logging$_"       } ; 
        'Registry' , 'Template' | % { "$_`Browse" , "$_`File" }               | % { "Backup$_"        } ; 
        'Service' , 'Script'                                                  | % { "$_`Profile" , "$_`Label" } ; 
        'Start' , 'Cancel' )

        $GUI   = Convert-XAMLToWindow -Xaml $Xaml -NE $Named -Passthru
    }

    If ( $Alert )
    {
        $XAML = @"
        <Window xmlns        = "http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x          = "http://schemas.microsoft.com/winfx/2006/xaml"
            Title            = "Notice" 
            Height           = "225" 
            Width            = "300" 
            BorderBrush      = "Black" 
            Background       = "White" 
            WindowStyle      = "ToolWindow">
            <Grid Background     = "#FFE5E5E5">
                <GroupBox Header = "Caution" Margin="5">
                    <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height = "3*" />
                    <RowDefinition Height = "25" />
                    <RowDefinition Height = "50" />
                </Grid.RowDefinitions>
                <TextBlock Grid.Row = "0" Margin = "5" Name = "Tbox" TextWrapping = "Wrap"/>
                <CheckBox  Grid.Row = "1" Margin = "5" Name = "Cbox" Content = "CheckBox" HorizontalAlignment = "Left" />
                        <Grid Grid.Row = "2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width = "*"/>
                                <ColumnDefinition Width = "*"/>
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column = "0" Margin ="10" Name = "Yes" Content = "Yes"  />
                            <Button Grid.Column = "1" Margin ="10" Name = "No"  Content = "No"  />
                        </Grid>
                    </Grid>
                </GroupBox>
            </Grid>
        </Window>
"@

        $Named = "Tbox" , "Cbox" , "Yes" , "No"

        $GUI   = Convert-XAMLToWindow -Xaml $Xaml -NE $Named -Passthru

    }

    [ PSCustomObject ]@{ 

        XAML  = $Xaml
        Named = $Named
        GUI   = $GUI
    }                                                                               #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-ScriptMode # Script Variable Collection ________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( ParameterSetName =     'SEC' ) ] [ Switch ] $SEC     , 
            [ Parameter ( ParameterSetName =    'Logc' ) ] [ Switch ] $Logc    ,

            # Basic Switches
            # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            [ Parameter ( ParameterSetName =    'ATOS' ) ] [ Switch ] $ATOS    , # Accepts ToS
            [ Parameter ( ParameterSetName =    'Auto' ) ] [ Switch ] $Auto    , # Implies -atos...Runs the script to be Automated.. Closes on - User Input, Errors, or End of Script

            # Service Configuration Switches
            # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            [ Parameter ( ParameterSetName = 'Default' ) ] [ Switch ] $Default , # Runs the script with Services to Default Configuration
            [ Parameter ( ParameterSetName =    'Safe' ) ] [ Switch ] $Safe    , # Runs the script with Services to Black Viper's Safe Configuration
            [ Parameter ( ParameterSetName = 'Tweaked' ) ] [ Switch ] $Tweaked , # Runs the script with Services to Black Viper's Tweaked Configuration

            #        -lcsc File.csv  Loads Custom Service Configuration, File.csv = Name of your backup/custom file

            # Service Choice Switches
            # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            [ Parameter ( ParameterSetName =     'All' ) ] [ Switch ] $All     , # Every windows services will change
            [ Parameter ( ParameterSetName =     'Min' ) ] [ Switch ] $Min     , # Just the services different from the default to safe/tweaked list
            [ Parameter ( ParameterSetName =     'SXB' ) ] [ Switch ] $SXB     , # Skips changes to all XBox Services

            # Update Switches
            # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            [ Parameter ( ParameterSetName =     'USC' ) ] [ Switch ] $USC     , # Checks for Update to Script file before running
            [ Parameter ( ParameterSetName =     'USE' ) ] [ Switch ] $USE     , # Checks for Update to Service file before running
            [ Parameter ( ParameterSetName =     'SIC' ) ] [ Switch ] $SIC     , # Skips Internet Check, if you can't ping GitHub.com for some reason

            # Log Switches
            # ¯¯¯¯¯¯¯¯¯¯¯¯

            [ Parameter ( ParameterSetName =     'Log' ) ] [ Switch ] $Log     , # Makes a log file using default name Script.log

            #        -log File.log   Makes a log file named File.log

            [ Parameter ( ParameterSetName =     'BAF' ) ] [ Switch ] $BAF     , # Log File of Services Configuration Before and After the script

            # Backup Service Configuration
            # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            [ Parameter ( ParameterSetName =    'BSCC' ) ] [ Switch ] $BSCC    , # Backup Current Service Configuration, Csv File
            [ Parameter ( ParameterSetName =    'BSCR' ) ] [ Switch ] $BSCR    , # Backup Current Service Configuration, Reg File
            [ Parameter ( ParameterSetName =    'BSCB' ) ] [ Switch ] $BSCB    , # Backup Current Service Configuration, Csv and Reg File

            # Display Switches
            # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            [ Parameter ( ParameterSetName =    'SNIS' ) ] [ Switch ] $SNIS    , # Show Already Set Services
            [ Parameter ( ParameterSetName =     'SSS' ) ] [ Switch ] $SSS     , # Show Not Installed Services
            [ Parameter ( ParameterSetName =     'SAS' ) ] [ Switch ] $SAS     , # Show Skipped Services

            # Misc Switches
            # ¯¯¯¯¯¯¯¯¯¯¯¯¯

            [ Parameter ( ParameterSetName =     'SDS' ) ] [ Switch ] $SDS     , # Stop Disabled Service
            [ Parameter ( ParameterSetName =     'CSS' ) ] [ Switch ] $CSS     , # Change State of Service
            [ Parameter ( ParameterSetName =     'Dry' ) ] [ Switch ] $Dry     , # Runs the Script and Shows what services will be changed

            # AT YOUR OWN RISK Switches
            # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            [ Parameter ( ParameterSetName =     'SBC' ) ] [ Switch ] $SBC     , # Skips Build Check
            [ Parameter ( ParameterSetName =    'SECH' ) ] [ Switch ] $SECH    , # Skips Edition Check by Setting Edition as Home
            [ Parameter ( ParameterSetName =    'SECP' ) ] [ Switch ] $SECP    , # Skips Edition Check by Setting Edition as Pro

            # Dev Switches
            # ¯¯¯¯¯¯¯¯¯¯¯¯

            [ Parameter ( ParameterSetName =    'Devl' ) ] [ Switch ] $Devl    , # Makes a log file with various Diagnostic information, Nothing is Changed

            [ Parameter ( ParameterSetName =    'Diag' ) ] [ Switch ] $Diag    ) # Shows diagnostic information, Stops -auto

            #        -diagf          Forced diagnostic information, Script does nothing else

            #        Help
            #        ¯¯¯¯
            #        -help           Shows list of switches, then exits script.. alt -h

            #        -copy           Shows Copyright/License Information, then exits script #>

        $Arch     = GCIM Win32_ComputerSystem | % { $_.PCSystemType | % { $_ -eq 1  , $_ -ne 1 } }

        $X        = $(

            If ( $All     ) { @{ 0 = '-all'     ; 1 =  1 ; 2 = $True  ; 3 = 'All_or_Min=-Full'                              } }
            If ( $Min     ) { @{ 0 = '-min'     ; 1 =  1 ; 2 = $True  ; 3 = 'All_or_Min=-Min'                               } }
            If ( $BSCC    ) { @{ 0 = '-bscc'    ; 1 =  2 ; 2 = $True  ; 3 = "Config=1" , "Type=1" | % { "BackupService$_" } } }
            If ( $BSCR    ) { @{ 0 = '-bscr'    ; 1 =  2 ; 2 = $True  ; 3 = "Config=1" , "Type=0" | % { "BackupService$_" } } }
            If ( $BSCB    ) { @{ 0 = '-bscb'    ; 1 =  2 ; 2 = $True  ; 3 = "Config=1" , "Type=2" | % { "BackupService$_" } } }
            If ( $BAF     ) { @{ 0 = '-baf'     ; 1 =  1 ; 2 = $True  ; 3 = 'LogBeforeAfter=1'                              } } 
            If ( $SNIS    ) { @{ 0 = '-snis'    ; 1 =  1 ; 2 = $True  ; 3 = 'ShowNonInstalled=1'                            } }
            If ( $SSS     ) { @{ 0 = '-sss'     ; 1 =  1 ; 2 = $True  ; 3 = 'ShowSkipped=1'                                 } }
            If ( $SAS     ) { @{ 0 = '-sas'     ; 1 =  1 ; 2 = $True  ; 3 = 'ShowAlreadySet=1'                              } }
            If ( $SDS     ) { @{ 0 = '-sds'     ; 1 =  1 ; 2 = $True  ; 3 = 'StopDisabled=1'                                } }
            If ( $SIC     ) { @{ 0 = '-sic'     ; 1 =  1 ; 2 = $True  ; 3 = 'InternetCheck=1'                               } }
            If ( $CSS     ) { @{ 0 = '-css'     ; 1 =  1 ; 2 = $True  ; 3 = 'ChangeState=1'                                 } }
            If ( $USC     ) { @{ 0 = '-usc'     ; 1 =  1 ; 2 = $True  ; 3 = 'ScriptVerCheck=1'                              } }
            If ( $USE     ) { @{ 0 = '-use'     ; 1 =  1 ; 2 = $True  ; 3 = 'ServiceVerCheck=1'                             } }
            If ( $ATOS    ) { @{ 0 = '-atos'    ; 1 =  1 ; 2 = $True  ; 3 = 'AcceptToS=Accepted'                            } }
            If ( $Dry     ) { @{ 0 = '-dry'     ; 1 =  1 ; 2 = $True  ; 3 = 'DryRun=1'                                      } }
            If ( $Devl    ) { @{ 0 = '-devl'    ; 1 =  1 ; 2 = $True  ; 3 = 'DevLog=1'                                      } }
            If ( $SBC     ) { @{ 0 = '-sbc'     ; 1 =  1 ; 2 = $True  ; 3 = 'BuildCheck=1'                                  } }
            If ( $SXB     ) { @{ 0 = '-sxb'     ; 1 =  1 ; 2 = $True  ; 3 = 'XboxService=1'                                 } }
            If ( $SECH    ) { @{ 0 = '-sech'    ; 1 =  1 ; 2 = $True  ; 3 = 'EditionCheck=Home'                             } }
            If ( $SECP    ) { @{ 0 = '-secp'    ; 1 =  1 ; 2 = $True  ; 3 = 'EditionCheck=Pro'                              } }
            If ( $SEC     ) { @{ 0 = '-sec'     ; 1 = -1 ; 2 = $True  ; 3 = 'EditionCheck=Pro'                              } }
            If ( $Default ) { @{ 0 = '-default' ; 1 =  1 ; 2 = $False ; 3 = 'Black_Viper=1' , 'BV_ArgUsed=2'                } }
            If ( $Safe    ) { @{ 0 = '-safe'    ; 1 =  1 ; 2 = $False ; 3 = 'Black_Viper=2' , 'BV_ArgUsed=2'                } }
            If ( $Tweaked ) { @{ 0 = '-tweaked' ; 1 =  1 ; 2 = $False ; 3 = ( 0 , 3 | % { "BlackViper=$_" } )[$Arch] , ( 1 , 2 | % { "BV_ArgUsed=$_" } )[$Arch] } }
            If ( $Auto    ) { @{ 0 = '-auto'    ; 1 =  1 ; 2 = $False ; 3 = 'Automated=1' , 'AcceptToS=Accepted'            } }
            If ( $Diag    ) { @{ 0 = '-diag'    ; 1 =  2 ; 2 = $True  ; 3 = 'Diagnostic=1' , 'Automated=0'                  } }
            If ( $Log     ) { @{ 0 = '-log'     ; 1 = -1 ; 2 = $True  ; 3 = 'ScriptLog=1' , 'LogName=-'                     } }
            If ( $LogC    ) { @{ 0 = '-logc'    ; 1 = -1 ; 2 = $True  ; 3 = 'ScriptLog=2' , 'LogName=-'                     } } )

        [ PSCustomObject ]@{ 
        
            Arg   = $X[0]
            Match = $X[1]
            Gui   = $X[2]
            Var   = $X[3]
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-Script # Script Variable Collection ____________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        $PassedArg             = $args # <-- Replace $Args w/ 'Initialize-ScriptMode -$Switch'

        "Security.Principal.Windows" | % { IEX "( [ $_`Principal ][ $_`Identity ]::GetCurrent() ).IsInRole( 'Administrator' )" } | % {

            If ( $False ) 
            {                
                Write-Theme -Action "Access [!]" "Limited, attempting elevation" 12 4 15

                SAPS PowerShell "-NoProfile -ExecutionPolicy Bypass -File `"$PSCommandPath`" $PassedArg" -Verb RunAs
                
                If ( $False )
                { 
                    Write-Theme -Action "Exception [!]" "Elevation has failed" 12 4 15
                    Read-Host "Press Enter to Exit"
                    #Exit
                }
            }

            If ( $True )
            { 
                Write-Theme -Action "Access [+]" "Granted" 11 11 15 
            }
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____     
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-ScriptVars # Script Variable Collection ___________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        
        # Operating System Delimiter

        [ Environment ]::OSVersion.Version.Major | % {
        
            If ( $_ -ne 10 )
            {
                Write-Theme -Action "Exception [!]" "Only Windows 10 Client is currently supported" 12 4 15
                Read-Host "Press Enter to Exit"
                Exit
            }
        }

        Resolve-Script -Path | % { "$( $_.Parent )\Services" } | % {
        
            [ PSCustomObject ]@{

                FileBase           = [ PSCustomObject ]@{
 
                    Settings       = "$_\BVSetting.xml"
                    Service        = "$_\$( Resolve-Script -Control | % { $_.ServiceConfig } ).csv"
                }

                Environment        = [ PSCustomObject ]@{ 

                    System         = Resolve-Windows -System
                    MSInfo         = Resolve-Windows -MSInfo
                    Edition        = Resolve-Windows -Edition
                    SKU            = Resolve-Windows -SKU
                    Type           = Resolve-Windows -Type
                }

                Service            = Resolve-Script -Services
            }
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Import-ServiceConfiguration #______________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( ) ] [ String ] $Custom )

        $C      = ( Get-Service *_* | ? ServiceType -eq 224 )[0].Name.Split( '_' )[-1]
        $X      = @( '[X]' , 'Disabled' , 'Manual' , 'Auto' , 'Auto (DS)' )

        If ( ! $Custom )
        {
            @{  
            
                Base = Resolve-Script -Path    | % { "$( $_.Parent        )\Services" }
                File = Resolve-Script -Control | % { "$( $_.ServiceConfig ).csv"      }
        
            } | % { $_.Base , $_.File -join '\' } | % { 
            
                IPCSV $_ | % {
                
                    [ PSCustomObject ]@{ 
                    
                        Service  = $_.Service.Replace( '?????' , $C )
                        "10H:D+" = $X[$_."10H:D+"]
                        "10H:D-" = $X[$_."10H:D-"]
                        "10P:D+" = $X[$_."10P:D+"]
                        "10P:D-" = $X[$_."10P:D-"]
                        "DT:S+"  = $X[$_."DT:S+"]
                        "DT:S-"  = $X[$_."DT:S-"]
                        "DT:T+"  = $X[$_."DT:T+"]
                        "DT:T-"  = $X[$_."DT:T-"]
                        "LT:S+"  = $X[$_."LT:S+"]
                        "LT:S-"  = $X[$_."LT:S-"]
                    }
                }
            }
        }

        If ( $Custom )
        {
            $Custom = Read-Host "Enter full path to custom service configuration"
            
            If ( ! ( Test-Path $Custom ) )
            {
                Write-Theme -Action "Exception [!]" "Path not a valid file."
            }

            If ( $Custom.Split('.')[-1] -ne ".csv" )
            {
                Write-Theme -Action "Exception [!]" "File not in a valid .csv format"
            }
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-ServiceProfile #_______________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

        $Config                          = ( Get-Service *_* | ? ServiceType -eq 224 )[0].Name.Split( '_' )[-1]

        Write-Theme -Action "Collecting [+]" "[ Service Configuration ]: Current Profile"

        $Skipped                         = Resolve-ScriptVars  | % { $_.Service.Skip } | % { $_.Replace( '?????' , $Config ) } | Sort
        $Current                         = Get-CurrentServices | Sort Name

        Write-Theme -Action  "Importing [+]" "[ Service Configuration ]: Target Profile"

        $List                            = Import-ServiceConfiguration

        $Collect                         = [ PSCustomObject ]@{ }

        $Type                            = @( "H" , "P" | % { "10$_`:D" } ; "S" , "T" | % { "DT:$_" } ; "LT:S" ) | % { "$_+" , "$_-" }

        $Type                            | % { $Collect | Add-Member -MemberType NoteProperty -Name $_ -Value @( 0..( $List.Count - 1 ) ) }

        Write-Theme -Action "Processing [+]" "[ Service Configuration ]: Overlay"

        ForEach ( $L in 0..( $List.Count - 1 ) )
        {
            $Index                       = "{0:d3}" -f $L
            $Name                        = $List[$L].Service.Replace( '?????' , $Config )
            $Slot                        = 0..9
            $Push                        = 0..9
            $C                           = 0
            
            If ( $Name -in $List.Service )
            {
                $X                       = $List | ? { $_.Service -eq $Name }

                $Type                    | % {

                    $Slot[$C]            = $X.$_
                    $C ++
                }
            }

            If ( $Name -in $Current.Name )
            {
                $X                       = $Current | ? { $_.Name -eq $Name }

                0..9 | % { 

                    $Push[$_]            = [ PSCustomObject ]@{

                        Index            = $Index
                        Scoped           = "+"
                        Profile          = $Slot[$_]
                        Name             = $Name
                        Status           = $X.Status
                        StartType        = $X.StartType
                        DelayedAutoStart = $X.DelayedAutoStart
                        DisplayName      = $X.DisplayName
                        PathName         = $X.PathName
                        Description      = $X.Description
                    }
                }
            }

            If ( $Name -notin $Current.Name )
            {
                0..9 | % { 
                    
                    $Push[$_]            = [ PSCustomObject ]@{

                        Index                = $Index
                        Scoped               = "-"
                        Profile              = "-"
                        Name                 = $Name
                        Status               = "-"
                        StartType            = "-"
                        DelayedAutoStart     = "-"
                        DisplayName          = "-"
                        PathName             = "-"
                        Description          = "-"
                    }
                }
            }

            $C = 0

            $Type | % { 

                $Collect.$_[$L] = $Push[$C]
                $C ++
            }

                
        }

        $Collect                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Start-DiagnosticCheck #____________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        
        $Section              = @( "Script" , "System" | % { "$_ Information" } ; "Initialization" ; "Display" , "Miscellaneous" , 
                                   "Development" , "Bypass/Force" , "Logging" , "Backup" | % { "$_ Settings" } ; "Version Control" ) | % { "[ $_ ]" }

        $Subtable             = 0..9
        
        #---------------------------------------------#
        
        $Script               = Resolve-Script -Version

        $Splat                = @{ 
            
            Items             = "Version" , "Date" , "Script" , "Service" , "Release"
            Values            = Resolve-Script -Version | % { $_.Version , $_.Date , $_.Script , $_.Service , $_.Release }
        }

        $Subtable[0]          = New-SubTable @Splat
        
        #---------------------------------------------#

        $MSInfo               = Resolve-Windows -MSInfo  | % { "$( $_.Caption ) [$( $_.OSArchitecture )]" }

        $SKU                  = Resolve-Windows -SKU     | % { $_.SKU }

                                Resolve-Windows -Edition | % { 

            $Build            = $_.Build
            $Version          = $_.Version 
        }

        $Chassis              = Resolve-Windows -Type    | % { $_.Chassis }

        $Splat                = @{ 

            Items             = "Operating System" , "Edition / SKU" , "Build" , "Version" , "Chassis Type"
            Values            = $MSInfo  , $SKU , $Build , $Version , $Chassis
        }

        $Subtable[1]          = New-SubTable @Splat

        #---------------------------------------------#

        $Control              = Resolve-Script -Control

        $Splat                = @{

            Items             = "Argument List" , "Terms of Service" 
            Values            = $Control | % { $_.PassedArgs , $_.TermsOfService }
        }

        $Subtable[2]          = New-SubTable @Splat

        $Splat                = @{

            Items             = "Active" , "Inactive" , "Skipped" | % { "Show $_ SVC" }
            Values            = $Control | % { $_.DisplayActive , $_.DisplayInactive , $_.DisplaySkipped }
        }
        
        $Subtable[3]          = New-SubTable @Splat
        
        $Splat                = @{ 
        
            Items             = "Simulate Changes" , "Xbox Services" , "Change * SVC State" , "Stop * Disabled SVC"
            Values            = $Control | % { $_.MiscSimulate , $_.MiscXbox , $_.MiscChange ,$_.MiscStopDisabled }
        }

        $Subtable[4]          = New-SubTable @Splat

        $Splat                = @{ 

            Items             = "Diagnostic Errors" , "Devel Log" , "Enable Console" , "Report Diagnostic"
            Values            = $Control | % { $_.DevelDiagErrors , $_.DevelLog , $_.DevelConsole , $_.DevelDiagReport }
        }

        $Subtable[5]          = New-Subtable @Splat

        $Splat                = @{ 

            Items             = "Build" , "Edition" , "Laptop" | % { "Bypass $_" }
            Values            = $Control | % { $_.BypassBuild , $_.BypassEdition , $_.BypassLaptop }
        }

        $Subtable[6]          = New-SubTable @Splat

        $Splat                = @{

            Items             = "Service" , "Script" | % { "Log $_ File" }
            Values            = $Control | % { $_.LoggingServiceFile , $_.LoggingScriptFile }
        }

        $Subtable[7]          = New-SubTable @Splat

        $Splat                = @{ 

            Items             = "Registry" , "Template" | % { "Backup $_" }
            Values            = $Control | % { $_.BackupRegistryFile , $_.BackupTemplateFile }
        }

        $Subtable[8]          = New-SubTable @Splat

        $Splat                = @{

            Items             = "Service" ,"Script" | % { "$_ Config" }
            Values            = $Control | % { $_.ServiceConfig , $_.ScriptConfig }
        }

        $Subtable[9]          = New-Subtable @Splat

        $Table                = New-Table -Title "Diagnostic/Startup Panel" -Depth 10 -ID $Section -Table $Subtable
        
        Write-Theme -Table $Table -Prompt "Press Enter to Continue, CTRL+C to Exit" 
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Show-Console #_____________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ ValidateSet ( 0 , 5 )   ]
            [ Parameter ( Mandatory ) ] [ Int ] $Mode )

    Add-Type -Name Window -Namespace Console -MemberDefinition @"
        [DllImport("Kernel32.dll")] public static extern IntPtr GetConsoleWindow();
        [DllImport("user32.dll")] public static extern bool ShowWindow(IntPtr hWnd, Int32 nCmdShow);
"@

    [ Console.Window ]::ShowWindow( [ Console.Window ]::GetConsoleWindow() , 5 )
    
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Load-MadBombRevisedGUI #___________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

     #  $Console                                   = Show-Console -Mode 5
        
        $Services                                  = Get-ServiceProfile

        Return-ViperBombGUI -Main                  | % {
        
            $Xaml                                  = $_.Xaml
            $GUI                                   = $_.GUI
            $Named                                 = $_.Named
        }

        $Arch                                      = $env:PROCESSOR_ARCHITECTURE | % { $_.Replace( 'AMD' , 'x' ) }

        $GUI.CurrentOS.Text                        = Resolve-Windows -MSInfo  | % { $_.Caption , "($Arch)" -join ' ' }
        $GUI.CurrentBuild.Text                     = Resolve-Windows -Edition | % { "v{0}.{1}" -f $_.Build , $_.Version }
        $GUI.CurrentChassis.Text                   = Resolve-Windows -Type    | % { $_.Chassis }

        $GUI.ServiceDialogEmpty.Text               = "Select a profile from the configuration menu to begin"
        $GUI.ServiceDialogSearch.IsEnabled         = $False

        $DisableBox = {

            $GUI.ServiceDialogSearch.IsEnabled     = $True
            $GUI.ServiceDialogEmpty.Visibility     = "Collapsed"
            $GUI.ServiceDialogEmpty.Text           = ""
        }

        $GUI.MenuConfigHomeDefaultMax.Add_Click(
        {
            $ServiceProfile                        = @( $Services.'10H:D+' )
            & $DisableBox
            $GUI.CurrentProfile.Text               = "Win10 Home | Default Max"

            $GUI.ServiceDialogGrid                 | % { 
                
                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
            }
        })

        $GUI.MenuConfigHomeDefaultMin.Add_Click(
        {
            $ServiceProfile                        = @( $Services.'10H:D-' )
            & $DisableBox
            $GUI.CurrentProfile.Text               = "Win10 Home | Default Min"

            $GUI.ServiceDialogGrid                 | % { 
                
                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
            }
        })

        $GUI.MenuConfigProDefaultMax.Add_Click(
        { 
            $ServiceProfile                        = @( $Services.'10P:D+' )
            & $DisableBox
            $GUI.CurrentProfile.Text               = "Win10 Pro | Default Max"

            $GUI.ServiceDialogGrid                 | % {
                
                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
            }
        })

        $GUI.MenuConfigProDefaultMin.Add_Click(
        {
            $ServiceProfile                        = @( $Services.'10P:D-' )
            & $DisableBox
            $GUI.CurrentProfile.Text               = "Win10 Pro | Default Min"

            $GUI.ServiceDialogGrid                 | % { 
                
                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
                
                
            }
        })
        
        $GUI.MenuConfigDesktopSafeMax.Add_Click(
        {
            $ServiceProfile                        = @( $Services.'DT:S+' )
            &$DisableBox
            $GUI.CurrentProfile.Text               = "Desktop | Safe Max"

            $GUI.ServiceDialogGrid                 | % {
                
                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
                
                
            }
        })

        $GUI.MenuConfigDesktopSafeMin.Add_Click(
        {
            $ServiceProfile                        = @( $Services.'DT:S-' )
            & $DisableBox
            $GUI.CurrentProfile.Text               = "Desktop | Safe Min"

            $GUI.ServiceDialogGrid                 | % {
            
                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
            }
        })

        $GUI.MenuConfigDesktopTweakedMax.Add_Click(
        {
            $ServiceProfile                        = @( $Services.'DT:T+' )
            & $DisableBox
            $GUI.CurrentProfile.Text               = "Desktop | Tweaked Max"

            $GUI.ServiceDialogGrid                 | % {
            
                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
            }
        })

        $GUI.MenuConfigDesktopTweakedMin.Add_Click(
        {
            $ServiceProfile                        = @( $Services.'DT:T-' )
            & $DisableBox
            $GUI.CurrentProfile.Text               = "Desktop | Tweaked Min"

            $GUI.ServiceDialogGrid                 | % {

                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
                
            }
        })

        $GUI.MenuConfigLaptopSafeMax.Add_Click(
        {
            $ServiceProfile                        = @( $Services.'LT:S+' )
            & $DisableBox
            $GUI.CurrentProfile.Text               = "Laptop | Safe Max"

            $GUI.ServiceDialogGrid                 | % {
            
                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
                
            }
        })

        $GUI.MenuConfigLaptopSafeMin.Add_Click(
        {
            $ServiceProfile                        = @( $Services.'LT:S-' )
            & $DisableBox
            $GUI.CurrentProfile.Text               = "Laptop | Safe Min"
            
            $GUI.ServiceDialogGrid                 | % {
        
                $_.ItemsSource                     = $Null
                $_.ItemsSource                     = $ServiceProfile
            }
        })

        $GUI.MenuInfoFeedback                      | % { $_.Add_Click({ Resolve-Script -Company | % { Start $_.Base  } }) }
        $GUI.MenuInfoFAQ                           | % { $_.Add_Click({ Resolve-Script -Company | % { Start $_.About }}) }
        $GUI.MenuInfoAbout                         | % { 
        
            $_.Add_Click(
            { 
                @{  Title   = "About - ViperBomb Service Configuration Utility"
                    Message = "This utility provides an interface to load and customize " ,
                              "service configuration profiles, such as:`n"                ,
                              "`n"                                                        ,
                              "    Default: Black Viper (Sparks v1.0)`n"                  ,
                              "    Custom: If in proper format`n"                         ,
                              "    Backup: Created via this utility"             -join '' } | % { Show-Message -Title $_.Title -Message $_.Message }
            
            }) 
        }

        $GUI.MenuInfoCopyright                      | % { $_.Add_Click{ Show-Message -Title "Copyright" -Message ( ( Resolve-Script -Copyright ) -join "`n" ) } }
        $GUI.MenuInfoMadBombDonate                  | % { $_.Add_Click{ Resolve-Script -MadBomb | % { Start $_.Donate  } } }
        $GUI.MenuInfoMadBombGitHub                  | % { $_.Add_Click{ Resolve-Script -MadBomb | % { Start $_.Base    } } }
        $GUI.MenuInfoBlackViper                     | % { $_.Add_Click{ Resolve-Script -Sparks  | % { Start $_.WebSite } } }
        $GUI.MenuInfoSecureDigitsPlus               | % { $_.Add_Click{ Resolve-Script -Company | % { Start $_.Site    } } }

        #--------------------------#
        # Logging Service Handling #
        #--------------------------#

        $GUI.LoggingServiceBrowse.Add_Click(
        {
            $GUI.LoggingServiceFile                 | % {
                    
                $_.IsEnabled                        = $True
                $_.Text                             = ( Get-Date -UFormat "%Y%m%d_%H%M" ) , ( Resolve-Script -Control | % { $_.LoggingServiceFile } ) -join '_'
            }

            $Dialog                                 = New-Object System.Windows.Forms.SaveFileDialog
                    
            $Dialog                                 | % {

                $_.Title                            = "Designate Service Logging Output"
                $_.InitialDirectory                 = Resolve-Script -Path | % { "$( $_.Parent )\Services" }
                $_.Filter                           = 'log (*.log) | *.log'
                $_.Filename                         = "$( Get-Date -UFormat "%Y%m%d-%H_%M" )_Service.log"
            }

            $X = $Dialog.ShowDialog()

            If ( $X -eq "OK" )
            {
                $GUI.LoggingServiceFile.Text        = $Dialog.Filename
            }

            Else
            {
                $GUI.LoggingServiceFile             | % {
                          
                    $_.IsEnabled                    = $False
                    $_.Text                         = "<Activate to designate a different file name/path>"
                }
            }

            $Dialog.Dispose()
        })

        #-------------------------#
        # Logging Script Handling #
        #-------------------------# 

        $GUI.LoggingScriptBrowse.Add_Click(
        {
            $GUI.LoggingScriptFile                  | % {
                    
                $_.IsEnabled                        = $True
                $_.Text                             = ( Get-Date -UFormat "%Y%m%d_%H%M" ) , ( Resolve-Script -Control | % { $_.LoggingScriptFile } ) -join '_'
            }

            $Dialog                                 = New-Object System.Windows.Forms.SaveFileDialog
                    
            $Dialog                                 | % {

                $_.Title                            = "Designate Script Logging Output"
                $_.InitialDirectory                 = Resolve-Script -Path | % { "$( $_.Parent )\Services" }
                $_.Filter                           = 'log (*.log) | *.log'
                $_.Filename                         = "$( Get-Date -UFormat "%Y%m%d-%H_%M" )_Script.log"
            }

            $X = $Dialog.ShowDialog()

            If ( $X -eq "OK" )
            {
                $GUI.LoggingScriptFile.Text         = $Dialog.Filename
            }

            Else
            {
                $GUI.LoggingScriptFile              | % {
                          
                    $_.IsEnabled                    = $False
                    $_.Text                         = "<Activate to designate a different file name/path>"
                }
            }

            $Dialog.Dispose()
        })

        #------------------------#
        # Backup Registry (.reg) #
        #------------------------#

        $GUI.BackupRegistryBrowse.Add_Click(
        {
            $GUI.BackupRegistryFile                 | % {
                    
                $_.IsEnabled                        = $True
                $_.Text                             = ( Get-Date -UFormat "%Y%m%d_%H%M" ) , ( Resolve-Script -Control | % { $_.BackupRegistryFile } ) -join '_'
            }

            $Dialog                                 = New-Object System.Windows.Forms.SaveFileDialog
                    
            $Dialog                                 | % {

                $_.Title                            = "Designate Registry Backup File"
                $_.InitialDirectory                 = Resolve-Script -Path | % { "$( $_.Parent )\Services" }
                $_.Filter                           = 'reg (*.reg) | *.reg'
                $_.Filename                         = "$( Get-Date -UFormat "%Y%m%d-%H_%M" )_Backup.reg"
            }

            $X = $Dialog.ShowDialog()

            If ( $X -eq "OK" )
            {
                $GUI.BackupRegistryFile.Text        = $Dialog.Filename
            }

            Else
            {
                $GUI.BackupRegistryFile             | % {
                          
                    $_.IsEnabled                    = $False
                    $_.Text                         = "<Activate to designate a different file name/path>"
                }
            }

            $Dialog.Dispose()
        })

        #------------------------#
        # Backup Template (.csv) #
        #------------------------#

        $GUI.BackupTemplateBrowse.Add_Click(
        {
            $GUI.BackupTemplateFile                 | % {
                    
                $_.IsEnabled                        = $True
                $_.Text                             = ( Get-Date -UFormat "%Y%m%d_%H%M" ) , ( Resolve-Script -Control | % { $_.BackupTemplateFile } ) -join '_'
            }

            $Dialog                                 = New-Object System.Windows.Forms.SaveFileDialog
                    
            $Dialog                                 | % {

                $_.Title                            = "Designate Template Backup File"
                $_.InitialDirectory                 = Resolve-Script -Path | % { "$( $_.Parent )\Services" }
                $_.Filter                           = 'csv (*.csv) | *.csv'
                $_.Filename                         = "$( Get-Date -UFormat "%Y%m%d-%H_%M" )_Template.csv"
            }

            $X = $Dialog.ShowDialog()

            If ( $X -eq "OK" )
            {
                $GUI.BackupTemplateFile.Text        = $Dialog.Filename
            }

            Else
            {
                $GUI.BackupTemplateFile             | % {
                          
                    $_.IsEnabled                    = $False
                    $_.Text                         = "<Activate to designate a different file name/path>"
                }
            }

            $Dialog.Dispose()
        })

        $GUI.ServiceDialogSearch.Add_TextChanged(
        {
            If ( $GUI.ServiceDialogSearch.Text -ne "" )
            {
                $GUI.ServiceDialogSelect.IsEnabled  = $False

                $Filter                             = $GUI.ServiceDialogSelect.SelectedItem.Content
            }

                $GUI.ServiceDialogGrid.ItemsSource  = $Null

                $Array                              = @( )

                $ServiceProfile | ? { $_.$Filter -match $GUI.ServiceDialogSearch.Text } | % { $Array += $_ }

                If ( $Array.Count -lt 1 )
                {
                    $GUI.ServiceDialogGrid.Visibility   = "Collapsed"
                        
                    $GUI.ServiceDialogEmpty.Visibility  = "Visible"
    
                    $GUI.ServiceDialogEmpty.Text        = "No results found"
                }

                If ( $Array.Count -ge 1 )
                {
                    $GUI.ServiceDialogGrid.Visibility   = "Visible"

                    $GUI.ServiceDialogGrid.ItemsSource  = $Array

                    $GUI.ServiceDialogEmpty.Visibility  = "Collapsed"

                    $GUI.ServiceDialogEmpty.Text        = ""
                }

            If ( ( $Filter -ne $Null ) -and ( $GUI.ServiceDialogSearch.Text -eq "" ) )
            {
                $Filter                             = $Null
                $GUI.ServiceDialogSelect.IsEnabled  = $True
                $GUI.ServiceDialogGrid.ItemsSource  = $Null
                $GUI.ServiceDialogGrid.ItemsSource  = $ServiceProfile
            }
        })

        #$GUI.DisplayActive
        #$GUI.DisplayInactive
        #$GUI.DisplaySkipped

        #$GUI.MiscSimulate
        #$GUI.MiscXbox
        #$GUI.MiscChange
        #$GUI.MiscStopDisabled

        #$GUI.DevelDiagErrors
        #$GUI.DevelLog
        #$GUI.DevelConsole
        #$GUI.DevelDiagReport

        #$GUI.BypassBuild
        #$GUI.BypassEdition
        #$GUI.BypassLaptop
        
        # ------------------------ #

        $GUI.ServiceLabel.Text                      = $GUI.ServiceProfile.SelectedItem.Content

        $GUI.ServiceProfile.Add_SelectionChanged(
        {
            $GUI.ServiceLabel.Text                  = $GUI.ServiceProfile.SelectedItem.Content
        })

        # ------------------------ #

        $GUI.ScriptLabel.Text                       = $GUI.ScriptProfile.SelectedItem.Content

        $GUI.ScriptProfile.Add_SelectionChanged(
        {
            $GUI.ScriptLabel.Text                   = $GUI.ScriptProfile.SelectedItem.Content
        })

        # ------------------------ #

        #$GUI.ConsoleOutput
        #$GUI.DiagnosticOutput

        #$GUI.Start

        $GUI.Cancel.Add_Click({ $GUI.DialogResult   = $False })

        $GUI | % { $_.LoggingServiceFile , $_.LoggingScriptFile , $_.BackupRegistryFile , $_.BackupTemplateFile } | % { 
        
            $_.Text = "<Activate to designate a different file name/path>"
        }

        Show-WPFWindow -GUI $GUI

        #------------------------#
        #   Post-Dialog Logic    #
        #------------------------#

        # This will be where the post dialog logic goes that handles the output of the script. It will be kick started
        # when the $GUI.Start is wired up to process the error correction/validation of everything that the program
        # allowed the user to enter/use... and if the output is validated, then the instructions/actions afterward go here.

        # For other examples of how this process works, feel free to scope out the Install-HybridDSC or Initialize-DomainController
        # functions in the main module.

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
        IPMO Hybrid-DSC -Force # What Free Actually Means _______________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
     #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

#StartScript -Global $Control
