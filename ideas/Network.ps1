

$ClassID = @( 1..126 | % { "A" } ; 128..191 | % { "B" } ; 192..223 | % { "C" } )

# Declare Table
$Table     = @{
# ------------- # ------- # ------- # ------- # ---------------------- # 
# NW #    Hosts # Class A # Class B # Class C # Netmask                # 
# ------------- # ------- # ------- # ------- # ---------------------- # 
  8  = 16777214 ,       1 ,     "-" ,     "-" ; # 24 # 255.000.XXX.XXX # 
  9  =  8388606 ,       2 ,     "-" ,     "-" ; # 23 # 255.128.XXX.XXX # 
  10 =  4194302 ,       4 ,     "-" ,     "-" ; # 22 # 255.192.XXX.XXX # 
  11 =  2097150 ,       8 ,     "-" ,     "-" ; # 21 # 255.224.XXX.XXX # 
  12 =  1048574 ,      16 ,     "-" ,     "-" ; # 20 # 255.240.XXX.XXX # 
  13 =   524286 ,      32 ,     "-" ,     "-" ; # 19 # 255.248.XXX.XXX # 
  14 =   262142 ,      64 ,     "-" ,     "-" ; # 18 # 255.252.XXX.XXX # 
  15 =   131070 ,     128 ,     "-" ,     "-" ; # 17 # 255.254.XXX.XXX # 
  16 =    65534 ,     256 ,       1 ,     "-" ; # 16 # 255.255.000.XXX # 
  17 =    32766 ,     512 ,       2 ,     "-" ; # 15 # 255.255.128.XXX # 
  18 =    16382 ,    1024 ,       4 ,     "-" ; # 14 # 255.255.192.XXX # 
  19 =     8190 ,    2048 ,       8 ,     "-" ; # 13 # 255.255.224.XXX # 
  20 =     4094 ,    4096 ,      16 ,     "-" ; # 12 # 255.255.240.XXX # 
  21 =     2046 ,    8192 ,      32 ,     "-" ; # 11 # 255.255.248.XXX # 
  22 =     1022 ,   16384 ,      64 ,     "-" ; # 10 # 255.255.252.XXX # 
  23 =      510 ,   32768 ,     128 ,     "-" ; #  9 # 255.255.254.XXX # 
  24 =      254 ,   65536 ,     256 ,       1 ; #  8 # 255.255.255.XXX # 
  25 =      126 ,  131070 ,     512 ,       2 ; #  7 # 255.255.255.128 # 
  26 =       62 ,  262144 ,    1024 ,       4 ; #  6 # 255.255.255.192 # 
  27 =       30 ,  524288 ,    2048 ,       8 ; #  5 # 255.255.255.224 # 
  28 =       14 , 1048576 ,    4096 ,      16 ; #  4 # 255.255.255.240 # 
  29 =        6 , 2097152 ,    8192 ,      32 ; #  3 # 255.255.255.248 # 
  30 =        2 , 4194304 ,   16384 ,      64 ; #  2 # 255.255.255.252 # 
# ------------- # ------- # ------- # ------- # ---------------------- # 
}

    $ID           = [ PSCustomObject ]@{

        Class     = ""

        IPAddress = ( [ IPAddress ] "10.0.0.1" ).GetAddressBytes()
        IPNetwork = ""
        IPHost    = ""

        SNMask    = ( [ IPAddress ] "255.128.0.0" ).GetAddressBytes()
        SNNetwork = ""
        SNHost    = ""

        Range     = @{ 0 = 1 ; 1 = 1 ; 2 = 1 }
        Divide    = @{ 0 = 1 ; 1 = 1 ; 2 = 1 }
        Output    = @{ }
    }

    # Determine class

    $ID.IPNetwork = $ID.IPAddress[0]
    $ID.IPHost    = $ID.IPAddress[1..3]

    $ID.SNNetwork = $ID.SNMask[0]
    $ID.SNHost    = $ID.SNMask[1..3]
    $ID.Class     = $ClassID[$ID.IPNetwork]

    If ( $ID.Class -eq "A" )
    {
        If ( $ID.SNHost[0] -ne 0 ) 
        {
            $Step         = 256 - $ID.SNHost[0]

            $Divide       = 256 / $Step

            $Output       = @{ }

            0..( $Divide - 1 ) | % { 

                $Output.Add( $_ , @( ) )
            }

            $I            = -1

            0..255 | % { 

                If ( $_ % $ID.SNHost[0] -eq 0 )
                {
                    $I ++
                }

                $Output[$I] += $_
            }
        }
    
        Else 
        {
            $ID.Range[2]  = 0..255 
            $ID.Divide[2] = 1
        }
    }

    If ( $ID.Class -in "A" , "B" )
    {
        If ( $ID.SNHost[1] -ne 0 ) 
        { 
            $ID.Range[1]  = 0..255 | % { $_ % $ID.SNHost[1] }
            $ID.Divide[1] = 256 / $ID.SNHost[1] 
        }
    
        Else
        {
            $ID.Range[1]  = 0..255 
            $ID.Divide[1] = 1
        }
    }

    If ( $ID.Class -in "A" , "B" , "C" )
    {
        If ( $ID.SNHost[0] -ne 0 )
        {
            $ID.Range[0]  = 0..255 | % { $_ % $ID.SNHost[0] }
            $ID.Divide[0] = 256 / $ID.SNHost[0]
        }
    
        Else
        { 
            $ID.Range[0]  = 0..255
            $ID.Divide[0] = 1
        }
    }

    
