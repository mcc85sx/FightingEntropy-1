<#___ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____  
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯       _____________________________________________________        ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯        __/¯¯\__[ Dynamically Engineered Digital Security ]__/¯¯\__         ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  _________________________ ________________ ___________________________________  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__// | Application Development | Virtualization | Network and Hardware Magistration | \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__// 
//¯¯    
\\  [ Hybrid-DSC ] @: Contains All Resources/Scripts/Modules/Functions
//   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____      
\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/---\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\___  
//¯¯\\___________________________________________________________________________________¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯\\ 
\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\___ __ ____ -- ____ __ ____ -- ____ __ ____ -- ____ __ ___// 
 ¯¯¯\\__[ Declares Namespaces, Loads Modules, then says peace out. ]____________________//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯¯  
     ¯¯¯¯                     ( it doesn't actually say peace out, but it could... )¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
#>  
    Using Namespace System.Security.AccessControl
    Using Namespace System.Security.Principal
    Using Namespace System.Management.Automation
    Using Namespace System.DirectoryServices
    Using Namespace System.Net.NetworkInformation
    
    $Hybrid   = @{ # This updates the associated PSM1 File whenever the script is imported, or used.
        
        Path  = $ENV:PSModulePath.Split( ';' ) | % { GCI $_ "*Hybrid-DSC*" -Directory } | % { "$( $_.FullName )\Hybrid-DSC.psm1" } 
        Value = @'
<#___ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____  
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯       _____________________________________________________        ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯        __/¯¯\__[ Dynamically Engineered Digital Security ]__/¯¯\__         ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  _________________________ ________________ ___________________________________  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__// | Application Development | Virtualization | Network and Hardware Magistration | \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯  
\\  [ Hybrid-DSC ] @: Loads the ( Hybrid - Desired State Controller ) Module
//   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____      
\\__//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__//¯¯\\__//==\\__/----\__//==\\__/---\\__//¯¯\\__/----\__//==\\__/----\__//==\\__/----\__//==\\___  
//¯¯\\__________________________________________//¯¯\\__//¯¯\\___________________________¯¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯\\ 
\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\___    ____ -- ____ __ ____ -- ____ __ ____ -- ____ __ ___// 
 ¯¯¯¯   [ Declare Namespaces & Load Modules ] __________________________________________//¯¯\\__//¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯¯  
                                              ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    #>
        
        $ENV:PSModulePath.Split( ';' ) | % { GCI $_ -Recurse "*Hybrid-DSC.ps1*" } | % { IPMO $_.FullName -Force }

<#                                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
  ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
 //¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
 \\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
  ¯¯¯\\ [ Script Functions ]____________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
      ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯    
        Get-HybridDSC               - Gets a description of this table/Help            
        Resolve-HybridDSC           - Collects Necessary Script Information            
        Publish-HybridDSC           - Creates a distributable package for Hybrid-DSC   
        New-Subtable                - Converts Key/Value Subtable for Write-Theme      
        New-Table                   - Converts Key/Value Tables for Write-Theme        
        Convert-HashToArray         - Converts a Hashtable to a formatted array        
        Write-Theme                 - Stylizes Command Line Output                     
        Show-Message                - Shows a Message Box                              
        Convert-XAMLToWindow        - Converts a block of XAML to a hash-table object  
        Show-WPFWindow              - Initializes the Window Object                    
        Get-XAML                    - Loads templatized XAML GUI's                     
        Find-XAMLNamedElements      - Looks for XAML 'Named' Items                     
        Get-LineDepth               - Gets the spacing for clean formatting            
        Confirm-DomainName          - Confirms whether a supplied domain name is valid
        Get-ScriptRoot              - Determines the scripthost's relative location     #>

    Export-ModuleMember -Function Get-HybridDSC , Resolve-HybridDSC , Publish-HybridDSC , New-Subtable , New-Table , Convert-HashToArray ,
    Write-Theme , Show-Message , Convert-XAMLToWindow , Show-WPFWindow , Get-XAML , Find-XAMLNamedElements , Get-LineDepth, Confirm-DomainName

<#                                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
  ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
 //¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
 \\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
  ¯¯¯\\ [ Network Functions ]___________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
      ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Get-NetworkInfo             - Collects various network information
        Start-PingSweep             - Scans everything on the local network address
        Get-NBTSCAN                 - This parses out NBTStat to return NBTScan
        Get-NetworkHosts            - Collects the ARP tables for MAC address Info
        Get-TelemetryData           - Collects external information for DNS and AD
        Resolve-MacAddress          - Resolves the vendor of any given MAC address
        Start-NetworkInfo           - Comprehensive combination of these other tools
        Get-NetworkStatistics       - Comprehensive netstat reparsed correctly
        Initialize-PortScan         - Scans some ports                                  #>

    Export-ModuleMember -Function Get-NetworkInfo , Start-PingSweep , Get-NBTSCAN , Get-NetworkHosts , Get-TelemetryData , Resolve-MacAddress, 
    Start-NetworkInfo , Get-NetworkStatistics , Initialize-PortScan

<#                                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
  ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
 //¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
 \\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
  ¯¯¯\\ [ Directory Functions ]_________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
      ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Invoke-Login                - Initializes a live AD validation login context
        Get-DSCPromoTable           - Retrieves GUI Naming Information
        Get-DSCPromoSelection       - Resets GUI Elements according to selected type
        Initialize-DomainController - Promotes a Domain Controller                      #>
    
    Export-ModuleMember -Function Invoke-Login , Get-DSCPromoTable , Get-DSCPromoSelection , Initialize-DomainController

<#                                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
  ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
 //¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
 \\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
  ¯¯¯\\ [ Permissions Functions ]_______________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
      ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Add-ACL                     - Adds an Access Control list
        New-ACLObject               - Creates a new ACL Object Template
        Unlock-Script               - Will allow for unlocking a file.                  #>

    Export-ModuleMember -Function Add-ACL , New-ACLObject , Unlock-Script

<#                                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
  ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
 //¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
 \\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
  ¯¯¯\\ [ Server Functions ]____________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
      ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Initialize-Server           - Orchestrates initial server configuration
        Get-DSCFeatureList          - Obtains the features used for this modification
        Sync-DNSSuffix              - Ensures the DNS Suffix is set
        Register-PDCTimeSource      - Sets the Primary Domain Controller Time Source
        Install-DSCRoot             - Installs dependencies for MDT and Hybrid-DSC
        Install-HybridDSC           - Creates a Hybrid-DSC Deployment Share
        Initialize-HybridIIS        - Automatically Configures IIS for MDT/BITS
        Initialize-HybridDSC        - Will populate Applications,Images,Certificates    #>

    Export-ModuleMember -Function Initialize-Server , Get-DSCFeatureList , Sync-DNSSuffix , Register-PDCTimeSource , Install-DSCRoot , 
    Install-HybridDSC , Initialize-HybridIIS , Initialize-HybridDSC

<#                                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
  ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
 //¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
 \\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
  ¯¯¯\\ [ MDT Functions ]_______________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
      ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Import-MDTModule            - Loads the Microsoft Deployment Toolkit Module
        Export-Ini                  - Specifically exports an INI file for MDT
        Export-BridgeScript         - Exports the file used to distribute Hybrid-DSC
        Update-HybridDSC            - Recycles all Deployment Share Content
        Update-Branding             - Updates the branding for a child item device      #>

    Export-ModuleMember -Function Import-MDTModule , Export-Ini , Export-BridgeScript , Update-HybridDSC , Update-Branding

<#                                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
  ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
 //¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
 \\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
  ¯¯¯\\ [ Diagnostic Functions ]________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
      ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Initialize-ViperBomb        - Loads the ViperBomb Service Configuration Tool
        Resolve-UninstallList       - Obtains Uninstall Programs List
        Resolve-LocalMachine        - Retrieves environment variables
        Get-CurrentServices         - Gets a list of the systems current services
        Resolve-Windows             - Obtains Windows Environment Variables
        Get-DiskInfo                - Locates Hard Disk Statistics
        Resolve-ViperBomb           - Collects Information needed for ViperBomb GUI
        Start-ViperBombDiagnostics  - Loads the ViperBomb Console Configuration Panel
        Import-ServiceConfiguration - Collects a Service configuration for import
        New-ServiceTemplate         - Creates a new template instance (Immutable)
        Get-ServiceProfile          - Converts loaded profile into useable GUI object
        Show-Console                - Enables/Disables the Console                      
        Get-CurrentPID              - Collects the (QMark/Processor) ID                 #>

    Export-ModuleMember -Function Initialize-ViperBomb , Resolve-UninstallList , Resolve-LocalMachine , Get-CurrentServices , Resolve-Windows , 
    Get-DiskInfo , Resolve-ViperBomb , Start-ViperBombDiagnostics , Import-ServiceConfiguration , New-ServiceTemplate , Get-ServiceProfile , 
    Show-Console , Get-CurrentPID
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
<#___                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
 ¯¯¯#>  Write-Theme -Action "Hybrid-DSC [+]" "Module Loaded" <#_________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
     ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯     #>
'@ }

    SC @Hybrid
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-ScriptRoot # Returns the current execution context path _______________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        ( $PSCommandPath , $PSISE.CurrentFile.FullPath )[ $PSISE -ne $Null ] | % {
            
            [ PSCustomObject ]@{ Parent = Split-Path $_ -Parent ; Leaf = Split-Path $_ -Leaf }
        }   
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-IPV4Class # Returns the IPV4 Address Class ____________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ ValidateNotNullOrEmpty () ]
            [ Parameter ( Mandatory ) ] [ String ] $Address )

        $Address.Split('.')[0] | % { 

            "No Network,Class A,Localhost,Class B,Class C,Multicast,R/D,Broadcast".Split(',')[@(0;@(1)*126;2;@(3)*64;@(4)*32;@(5)*16;@(6)*15;7)][$_]
        
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-HybridDSC # Provides ViperBomb Script Definitions _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Mandatory , ParameterSetName =      "Script" ) ] [ Switch ] $Script      ,
            [ Parameter ( Mandatory , ParameterSetName =     "Network" ) ] [ Switch ] $Network     ,
            [ Parameter ( Mandatory , ParameterSetName =   "Directory" ) ] [ Switch ] $Directory   ,
            [ Parameter ( Mandatory , ParameterSetName = "Permissions" ) ] [ Switch ] $Permissions ,
            [ Parameter ( Mandatory , ParameterSetName =      "Server" ) ] [ Switch ] $Server      ,
            [ Parameter ( Mandatory , ParameterSetName =         "MDT" ) ] [ Switch ] $MDT         ,
            [ Parameter ( Mandatory , ParameterSetName =  "Diagnostic" ) ] [ Switch ] $Diagnostic  ,
            [ Parameter ( Mandatory , ParameterSetName =         "All" ) ] [ Switch ] $All         ,
            [ Parameter ( Mandatory , ParameterSetName =      "Report" ) ] [ Switch ] $Report      )

        $Functions                            = [ PSCustomObject ]@{ 

            Script                            = [ PSCustomObject ]@{

                "Resolve-HybridDSC"           = "Collects Necessary Script Information"
                "Publish-HybridDSC"           = "Creates a distributable package for Hybrid-DSC"
                "New-Subtable"                = "Converts Key/Value Subtable for Write-Theme"
                "New-Table"                   = "Converts Key/Value Tables for Write-Theme"
                "Convert-HashToArray"         = "Converts a Hashtable to a formatted array"
                "Write-Theme"                 = "Stylizes Command Line Output"
                "Show-Message"                = "Shows a Message Box"
                "Convert-XAMLToWindow"        = "Converts a block of XAML to a hash-table object"
                "Show-WPFWindow"              = "Initializes the Window Object"
                "Get-XAML"                    = "Loads templatized XAML GUIs"
                "Find-XAMLNamedElements"      = "Looks for XAML 'Named' Items"
                "Confirm-DomainName"          = "Confirms whether a supplied domain name is valid"
                "Get-ScriptRoot"              = "Determines the scripthost's relative location"
            }

            Network                           = [ PSCustomObject ]@{

                "Get-NetworkInfo"             = "Collects various network information"
                "Start-PingSweep"             = "Scans everything on the local network address"
                "Get-NBTSCAN"                 = "This parses out NBTStat to return NBTScan"
                "Get-NetworkHosts"            = "Collects the ARP tables for MAC address Info"
                "Get-TelemetryData"           = "Collects external information for DNS and AD"
                "Resolve-MacAddress"          = "Resolves the vendor of any given MAC address"
                "Start-NetworkInfo"           = "Comprehensive combination of these other tools"
                "Get-NetworkStatistics"       = "Comprehensive netstat reparsed correctly"
                "Initialize-PortScan"         = "Scans some ports"
            }

            Directory                         = [ PSCustomObject ]@{

                "Invoke-Login"                = "Initializes a live AD validation login context"
                "Get-DSCPromoTable"           = "Retrieves GUI Naming Information"
                "Get-DSCPromoSelection"       = "Resets GUI Elements according to selected type"
                "Initialize-DomainController" = "Promotes a Domain Controller"
            }

            Permissions                       = [ PSCustomObject ]@{

                "Add-ACL"                     = "Adds an Access Control list"
                "New-ACLObject"               = "Creates a new ACL Object Template"
                "Unlock-Script"               = "Will allow for unlocking a file."
            }

            Server                            = [ PSCustomObject ]@{ 
    
                "Initialize-Server"           = "Orchestrates initial server configuration"
                "Get-DSCFeatureList"          = "Obtains the features used for this modification"
                "Sync-DNSSuffix"              = "Ensures the DNS Suffix is set"
                "Register-PDCTimeSource"      = "Sets the Primary Domain Controller Time Source"
                "Install-DSCRoot"             = "Installs dependencies for MDT and Hybrid-DSC"
                "Install-HybridDSC"           = "Creates a Hybrid-DSC Deployment Share"
                "Initialize-HybridIIS"        = "Automatically Configures IIS for MDT/BITS"
                "Initialize-HybridDSC"        = "Will populate Applications,Images,Certificates"
            }

            MDT                               = [ PSCustomObject ]@{

                "Import-MDTModule"            = "Loads the Microsoft Deployment Toolkit Module"
                "Export-Ini"                  = "Specifically exports an INI file for MDT"
                "Export-BridgeScript"         = "Exports the file used to distribute Hybrid-DSC"
                "Update-HybridDSC"            = "Recycles all Deployment Share Content"
                "Update-Branding"             = "Updates the branding for a child item device"
            }

            Diagnostic                        = [ PSCustomObject ]@{

                "Initialize-ViperBomb"        = "Loads the ViperBomb Service Configuration Tool"
                "Resolve-UninstallList"       = "Obtains Uninstall Programs List"
                "Resolve-LocalMachine"        = "Retrieves environment variables"
                "Get-CurrentServices"         = "Gets a list of the systems current services"
                "Resolve-Windows"             = "Obtains Windows Environment Variables"
                "Get-DiskInfo"                = "Locates Hard Disk Statistics"
                "Resolve-ViperBomb"           = "Collects Information needed for ViperBomb GUI"
                "Start-ViperBombDiag"         = "Loads the ViperBomb Console Configuration Panel"
                "Import-ServiceConfiguration" = "Collects a Service configuration for import"
                "New-ServiceTemplate"         = "Creates a new template instance (Immutable)"
                "Get-ServiceProfile"          = "Converts loaded profile into useable GUI object"
                "Show-Console"                = "Enables/Disables the Console"
                "Get-CurrentPID"              = "Collects the (QMark/Processor) ID"
            }
        }

        $Functions | % {

            If ( $Script      ) { $_.Script      }
            If ( $Network     ) { $_.Network     }
            If ( $Directory   ) { $_.Directory   }
            If ( $Permissions ) { $_.Permissions }
            If ( $Server      ) { $_.Server      }
            If ( $MDT         ) { $_.MDT         }
            If ( $Diagnostic  ) { $_.Diagnostic  }
            If ( $All         ) { $_             }
            If ( $Report      ) 
            { 
                $Return           = [ PSCustomObject ]@{ 
                
                    Section       = "Script,Network,Directory,Permissions,Server,MDT,Diagnostic".Split(',')
                    SubTable      = ""
                    
                }
                    
                $Return                   | % { 

                    $_.Subtable           = ForEach ( $i in 0..6 )
                    {
                        $_.Section[$I]    | % { 

                            $Splat        = @{
                        
                                Items     = $Functions.$_ | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name }
                            }
                        
                            $Splat.Add( "Values" , @( ForEach ( $J in $Splat.Items ) { $Functions.$_.$J } ) )

                            New-Subtable @Splat

                        }
                    }

                    $Splat                = @{ 

                        Title             = "Hybrid-DSC Function Table"
                        Depth             = 7
                        ID                = ForEach ( $i in 0..6 ) { "([ $($_.Section[$i] ) ])" }
                        Table             = ForEach ( $i in 0..6 ) { $_.Subtable[$i] }
                    }

                    $Splat = New-Table @Splat
                }

                Write-Theme -Table $Splat 
            }
        }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-HybridDSC # Module Root Path Delcaration __________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( ParameterSetName =   "Module" ) ] [ Switch ] $Module   ,
            [ Parameter ( ParameterSetName =     "Root" ) ] [ Switch ] $Root     ,
            [ Parameter ( ParameterSetName =    "Share" ) ] [ Switch ] $Share    ,
            [ Parameter ( ParameterSetName =   "Domain" ) ] [ Switch ] $Domain   ,
            [ Parameter ( ParameterSetName = "Graphics" ) ] [ Switch ] $Graphics ,
            [ Parameter ( ParameterSetName =      "All" ) ] [ Switch ] $All      )

        $CS = GCIM Win32_ComputerSystem

        "Secure Digits Plus LLC" | % { 

            $Return       = [ PSCustomObject ]@{

                Author    = $_
                Website   = "https://www.securedigitsplus.com"
                Module    = $ENV:PSModulePath.Split( ';' ) | ? { GCI $_ -Recurse "*Hybrid-DSC*" } | % { "$_\Hybrid-DSC" }
                Registry  = "HKLM:\Software\Policies\$_"
                Company   = @( )
                Drive     = @( )
                Share     = @( )
                Domain    = @( )
                Graphics  = @( )
                Names     = @( )
            }
        }

        $Install = [ PSCustomObject ]@{ 

            Root = {
            
                Switch ( $host.UI.PromptForChoice( "Hybrid-DSC Root Prefab" , "Failed to detect/locate the Hybrid-DSC Root Prefab. Install?" , 
                [ System.Management.Automation.Host.ChoiceDescription [] ]@( '&Yes' , '&No' ) , [ Int ] 1 ) ) 
                {   
                    0   
                    { 
                        Write-Theme -Action "Installing [~]" "Hybrid-DSC Root Prefab"
                        Install-DSCRoot
                    }

                    1
                    {
                        Write-Theme -Action "Exiting [~]" "Unable to proceed"
                        Read-Host "Press Enter to Exit"
                        Exit
                    }
                }
            }

            Share = {

                Switch ( $host.UI.PromptForChoice( "Hybrid-DSC Deployment Share" , "Failed to detect/locate any Hybrid-DSC Deployment shares. Install?" , 
                [ System.Management.Automation.Host.ChoiceDescription [] ]@( '&Yes' , '&No' ) , [ Int ] 1 ) )
                {   
                    0   
                    { 
                        Write-Theme -Action "Installing [~]" "Hybrid-DSC Deployment Share"
                        Install-HybridDSC
                    }

                    1
                    {
                        Write-Theme -Action "Exiting [~]" "Unable to proceed"
                        Read-Host "Press Enter to Exit"
                        Exit
                    }
                }
            }

            Select = {

                Param( $Items , $Object, $Item )
                
                Write-Theme -Action "Option [~]" "Multiple $Items Found"

                $C       = 0..( $Object.Count - 1 )
                $Options = $C | % { "`n[$_] $( $Object[$_] )" }

                Do
                {
                    $S = Read-Host -Prompt @( "Select # of $Item" ; $Options )
                        
                    If ( $S -notin $C ) { Echo "Not a valid option" }
                    If ( $S    -in $C ) { $Object = $Object[$S] }
                }

                Until ( $Object.Count -eq 1 )
            }
        }

        # Returns the default module path

        $Return.Module | % { 
            
            If ( $_ -eq $Null ) 
            { 
                Write-Theme -Action "Exception [!]" "Hybrid-DSC Module Resources Missing"
                Break
            }
        }

        If ( ( $Root ) -or ( $Share ) )
        {
            $Return                     | % { 

                If ( ! ( Test-Path $_.Registry ) )
                {
                    & $Install.Root
                }

                Else
                {
                    $_.Registry             = [ PSCustomObject ]@{
            
                        Root                =     $_.Registry  
                        "Hybrid-DSC"        = GP  $_.Registry | % { $_."Hybrid-DSC"        }
                        "Installation Date" = GP  $_.Registry | % { $_."Installation Date" }
                        Child               = GCI $_.Registry | % { $_.PSChildName         }
                    }
                }
            }

            $Return | % { 

                If ( Test-Path $Return.Registry.Root )
                {
                    $Return.Company         = GCI $Return.Registry.Root

                    If ( $Return.Company.Count -lt 1 ) 
                    { 
                        & $Install.Share 
                    }

                    If ( $Return.Company.Count -gt 1 ) 
                    { 
                        ICM $Install.Select -ArgumentList  "Channels" ,   $_.Company , "Channel" 
                    }

                    $Return.Drive           = GCI $Return.Company.PSPath

                    If (   $_.Drive.Count -lt 1 ) 
                    { 
                        & $Install.Share 
                    } 
                    
                    If (    $_.Drive.Count -gt 1 ) 
                    { 
                        ICM $Install.Select -ArgumentList    "Drives" ,   $_.Drive ,   "Drive" 
                    }

                    $Return.Share           = GCI $Return.Drive.PSPath | % { GP $_.PSPath } | % {
            
                        [ PSCustomObject ]@{ 

                            Background  = $_.Background
                            Branch      = $_.Branch
                            Company     = $_.Company
                            Description = $_.Description
                            Directory   = $_.Directory
                            Drive       = $_.Drive
                            DSDrive     = $_.DSDrive
                            Hours       = $_.Hours
                            IIS_AppPool = $_.IIS_AppPool
                            IIS_Install = $_.IIS_Install
                            IIS_Name    = $_.IIS_Name
                            IIS_Proxy   = $_.IIS_Proxy
                            IIS_Skip    = $_.IIS_Skip
                            Legacy      = $_.Legacy
                            LMCred_Pass = $_.LMCred_Pass
                            LMCred_User = $_.LMCred_User
                            Logo        = $_.Logo
                            NetBIOS     = $_.NetBIOS
                            Phone       = $_.Phone
                            Remaster    = $_.Remaster
                            Samba       = $_.Samba
                            WWW         = $_.WWW
                            Server      = $_.Server
                        }
                    }
                }
            }
        }

        If ( $CS.PartOfDomain -eq $True )
        {
            $Return.Domain              = [ PSCustomObject ]@{
                        
                NetBIOS                 = $ENV:UserDomain
                Branch                  = $ENV:USERDNSDOMAIN
                Domain                  = $True
            }
        }

        If ( $CS.PartOfDomain -eq $False )
        {
            $ID                         = [ PSCustomObject ]@{ Group  = @( ) ; Unique = @( ) }

            nbtstat -n                  | ? { $_ -like "*REGISTERED*" } | % { 
                    
            $X                          = @{ 0 = $_[0..18] ; 1 = $_[19..22] ; 2 = $_[24..34] ; 3 = $_[35..50] }
                    
            $X                          = 0..3 | % { ( $X[$_] | ? { $_ -ne " " } ) -join '' }

                If ( $X[1] -ne "<00>" )
                {
                    [ PSCustomObject ]@{ Name = $X[0] ; ID = $X[1] ; Type = $X[2] ; Status = $X[3] } | % { 

                        If ( $_.Type -eq "Group"  -and $_.Name -notin $ID.Group.Name  ) { $ID.Group   += $_ }
                        If ( $_.Type -eq "Unique" -and $_.Name -notin $ID.Unique.Name ) { $ID.Unique  += $_ }
                    }
                }

                $Return.Domain          = [ PSCustomObject ]@{
                        
                    NetBIOS             = $ID.Group.Name
                    Branch              = $ID.Unique.Name
                    Domain              = $True
                }
            }
        }

        $GFX                = GCI $_.Module "*Graphics*" -Recurse | % { GCI $_.FullName } | % { $_.FullName }
            
        $Return.Graphics    = [ PSCustomObject ]@{ 

            Author          = $Return.Author
            Title           = $Return.Author + " | Hybrid-DSC"
            Background      = $GFX[0]
            Banner          = $GFX[1]
            Icon            = $GFX[2]
            Brand           = $GFX[3]
            Logo            = $GFX[4]
        }
        
        If ( $Module   ) { $Return.Module   }
        If ( $Root     ) { $Return.Registry }
        If ( $Share    ) { $Return.Share    }
        If ( $Graphics ) { $Return.Graphics }
        If ( $Domain   ) { $Return.Domain   }
        If ( $All      ) { $Return          }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-CurrentServices # Retrieves/Displays Current Services _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Write-Theme -Action "Collecting [~]" "Service State Catalog"

        $Return         = [ PSCustomObject ]@{ 
        
            Service     = GCIM Win32_Service | Sort Name
            Return      = ""
        }

        $Y              = ( "{0};{1};{0}, {1}" -f "Delayed Start" , "Trigger Start" ).Split( ';' )

        $Return         | % {
        
            $_.Return   = ForEach ( $I in 0..( $_.Service.Count - 1 ) )
            {
                $X      = $_.Service[$I]
                
                Write-Progress -Activity "Collecting Service Catalog" -PercentComplete ( ( $I / $_.Service.Count ) * 100 )

                "HKLM:\SYSTEM\CurrentControlSet\Services\$( $X.Name )" | % { 

                    $C                   = If ( GP $_ | % { $_.DelayedAutoStart } ) { $Y[0] } Else { $Null }
                    
                    If ( GCI $_ -EA 0 | % { $_.Name -like "*Trigger*" } )
                    {
                        $C               = If ( $C -ne $Null ) { $Y[2] } Else { $Y[1] }
                    }

                    [ PSCustomObject ]@{
                            
                        Name             = $X.Name
                        StartMode        = $X.StartMode | % { If ( $C -ne $Null ) { "$_ ($C)" } Else { $_ } }
                        State            = $X.State
                        DisplayName      = $X.DisplayName
                        PathName         = $X.PathName
                        Description      = $X.Description
                    }
                }
            }
        }
        
        $Return.Return                                                              #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-Windows # CIM / Edition Collection Table __________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( ParameterSetName =  "System" ) ] [ Switch ] $System      ,
            [ Parameter ( ParameterSetName =      "OS" ) ] [ Switch ] $MSInfo      ,
            [ Parameter ( ParameterSetName = "Edition" ) ] [ Switch ] $Edition     ,
            [ Parameter ( ParameterSetName =     "SKU" ) ] [ Switch ] $SKU         ,
            [ Parameter ( ParameterSetName =    "Type" ) ] [ Switch ] $Type        ,
            [ Parameter ( ParameterSetName =      "PS" ) ] [ Switch ] $PS          ,
            [ Parameter ( ParameterSetName =     "Env" ) ] [ Switch ] $Environment ,
            [ Parameter ( ParameterSetName =     "All" ) ] [ Switch ] $All         )

        $Return             = [ PSCustomObject ]@{

            OS              = GCIM Win32_OperatingSystem
            CS              = GCIM Win32_ComputerSystem
            ReleaseID       = GP 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion' | % { $_.ReleaseID }
            Edition         = @( ( '1507,10240,Threshold 1,Release To Manufacturing;1511,10586,Threshold 2,November UX;1607,14393,RX 1' + 
                              ',Anniversary UX;1703,15063,RX 2,CX UX;1703,16299,RX 3,Fall CX UX;1803,17134,RX 4,April 2018 UX;1809,177' + 
                              '63,RX 5,October 2018 UX;1903,18362,19H1,May 2019 UX;1909,18363,19H2,November 2019 UX;2004,19000,20H1,Un' + 
                              'released' ).Replace('RX','Redstone').Replace('UX' ,'Update').Replace('CX','Creators').Split( ';' )       | ? { 
                              
                              $_.Split(',')[0] -eq ( GP 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion' | % { $_.ReleaseID } ) } ) | % { 
                
                                [ PSCustomObject ]@{
                    
                                    Version     = $_.Split(',')[0]
                                    Build       = "10.0.{0}" -f $_.Split(',')[1]
                                    CodeName    = $_.Split(',')[2]
                                    Name        = $_.Split(',')[3]
                                }
                            }

            SKU             = ('Undefined,Ultimate !,Home Basic !,Home Premium !,$ !,Home Basic N !,Business !,Standard # !,Datacenter' + 
                              ' # !,Small Business # !,$ # !,Starter !,Datacenter # Core !,Standard # Core !,$ # Core !,$ # IA64 !,Bus' + 
                              'iness N !,Web # !,Cluster # !,Home # !,Storage Express # !,Storage Standard # !,Storage Workgroup # !,S' + 
                              'torage $ # !,# For Small Business !,Small Business # Premium !,TBD,@ $,@ Ultimate,Web # Core,-,-,-,# Fo' + 
                              'undation,@ Home #,-,@ # Standard No Hyper-V Full,@ # Datacenter No Hyper-V Full,@ # $ No Hyper-V Full,@' + 
                              ' # Datacenter No Hyper-V Core,@ # Standard No Hyper-V Core,@ # $ No Hyper-V Core,Microsoft Hyper-V #,St' + 
                              'orage # Express Core,Storage # Standard Core,# Workgroup Core,Storage # $ Core,Starter N,Professional,P' + 
                              'rofessional N,@ Small Business # 2011 Essentials,-,-,-,-,-,-,-,-,-,-,-,-,Small Business # Premium Core,' + 
                              '@ # Hyper Core V,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,--,-,-,@ Thin PC,-,@ Embedded Industry,-,-,-,-,-,-' + 
                              ',-,@ RT,-,-,Single Language N,@ Home,-,@ Professional with Media Center,@ Mobile,-,-,-,-,-,-,-,-,-,-,-,' + 
                              '-,-,@ Embedded Handheld,-,-,-,-,@ IoT Core'
                              ).Replace("!","Edition").Replace("@","Windows").Replace("#","Server").Replace('$',"Enterprise").Split(',')
            
            Code            = ""
            Chassis         = ",Desktop,Mobile/Laptop,Workstation,Server,Server,Appliance,Server,Maximum".Split(',')
            PSVersion       = $PSVersionTable.BuildVersion
            Env             = [ PSCustomObject ]@{ }

        }

        $Return             | % { 

            $_.Code         = $_.OS.OperatingSystemSKU
            $_.SKU          = $_.SKU[ $_.Code ]
            $_.Chassis      = $_.Chassis[$_.CS.PCSystemType]

            [ Environment ]::GetEnvironmentVariables().GetEnumerator() | % { 

                $Return.Env  | Add-Member -MemberType NoteProperty -Name $_.Name -Value $_.Value
            }
        }

        $Return | % { 

            If ( $System  ) { $_.CS        }
            If ( $MSInfo  ) { $_.OS        }
            If ( $Edition ) { $_.Edition   }
            If ( $SKU     ) { $_.SKU       }
            If ( $Type    ) { $_.Chassis   }
            If ( $PS      ) { $_.PSVersion }
            If ( $Environment ) { $_.Env       }
            If ( $All     ) { $_           }
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\____  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯                                                                    // 
#//¯¯¯                                                                                                                                               \\
#\\  [ Use-ViperBombServices ] @: Services & Group Policy Template Generator [ Modified version of "MadBomb122" & Charles Spark's scripts ]          //
#//   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____   \\  
#\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/---\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__//  
#//¯¯\\___________________________________________________________________________________¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\___ __ ____ -- ____ __ ____ -- ____ __ ____ -- ____ __ ___// 
# ¯¯¯\\__[ Initial Script Prerequisite Declarations ]____________________________________//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯¯  
#     ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
#
#     Foreword: This script has been extensively modified/completely revamped, however I still make every effort to credit the original authors.
#     ¯¯¯¯¯¯¯¯                       ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯          ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#               Revisions include, the 'code-behind' PowerShell script, as well as the XAML GUI.
#
#               MadBomb122 has a real name and in respect to him, I have chosen to leave that information outside of this script.
#               I have collaborated with MadBomb122 over the course of the last 6-7 months, tentatively, in helping to teach him some refinement
#               techniques on my journey to advance my Application Development experience.
#
#               The desired end result of working with this script, is to easily implement government grade STIG templates for end users, which 
#               you can find some of those technical details/documents here -> @ https://github.com/nsacyber/Windows-Secure-Host-Baseline
#              
#               - MCC / SDP
#   _________________________
#   [ Original Script & GUI ] -> I will be adding an option that enables the use his legacy script
#   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#       Author: Madbomb122
#      Website: https://GitHub.com/Madbomb122/BlackViperScript/
#   _________________________
#   [ Service Configuration ] -> I will be adding additional service configuration types for Windows Server 2016 +
#   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#       Author: Charles "Black Viper" Sparks
#      Website: http://www.BlackViper.com/                                          #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-ViperBomb # Provides ViperBomb Script Definitions _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( ParameterSetName =    "Version" ) ] [ Switch ] $Version   ,
            [ Parameter ( ParameterSetName =     "Update" ) ] [ Switch ] $Company   ,
            [ Parameter ( ParameterSetName =    "MadBomb" ) ] [ Switch ] $MadBomb   ,
            [ Parameter ( ParameterSetName =     "Sparks" ) ] [ Switch ] $Sparks    ,
            [ Parameter ( ParameterSetName =       "Path" ) ] [ Switch ] $Path      ,
            [ Parameter ( ParameterSetName =    "Control" ) ] [ Switch ] $Control   ,
            [ Parameter ( ParameterSetName =  "Copyright" ) ] [ Switch ] $Copyright ,
            [ Parameter ( ParameterSetName =    "Message" ) ] [ Switch ] $Message   ,
            [ Parameter ( ParameterSetName =       "Help" ) ] [ Switch ] $Help      ,
            [ Parameter ( ParameterSetName =   "Services" ) ] [ Switch ] $Services  ,
            [ Parameter ( ParameterSetName =      "Names" ) ] [ Switch ] $Names     ,
            [ Parameter ( ParameterSetName =      "Types" ) ] [ Switch ] $Types     ,
            [ Parameter ( ParameterSetName =     "Config" ) ] [ Switch ] $Config    ,
            [ Parameter ( ParameterSetName =        "All" ) ] [ Switch ] $All       )

        $Default                 = [ PSCustomObject ]@{

            PassedArgs           = If ( ! $Args ) { "N/A" } Else { $Args }
            TermsOfService       = 0
            DisplayActive        = 1
            DisplayInactive      = 1
            DisplaySkipped       = 1
            MiscSimulate         = 0
            MiscXbox             = 1
            MiscChange           = 0
            MiscStopDisabled     = 0
            DevelDiagErrors      = 0
            DevelLog             = 0
            DevelConsole         = 0
            DevelDiagReport      = 0
            BypassBuild          = 0
            BypassEdition        = 0
            BypassLaptop         = 0
            LoggingServiceFile   = "Service.log"
            LoggingScriptFile    = "Script.log"
            BackupRegistryFile   = "Backup.reg"
            BackupTemplateFile   = "Backup.csv"
            ServiceConfig        = "Black Viper (Sparks v1.0)"
            ScriptConfig         = "DevOPS (MC/SDP v1.0)"
            Profile              = $Null

        }

        $QMark                   = Get-CurrentPID 

        $ServiceConfig           = [ PSCustomObject ]@{  
 
            Names                = ("AJRouter;ALG;AppHostSvc;AppIDSvc;Appinfo;AppMgmt;AppReadiness;AppVClient;aspnet_state;AssignedAccessManagerSvc;" + 
                                   "AudioEndpointBuilder;AudioSrv;AxInstSV;BcastDVRUserService_$QMARK;BDESVC;BFE;BITS;BluetoothUserService_$QMARK;Br" + 
                                   "owser;BTAGService;BthAvctpSvc;BthHFSrv;bthserv;c2wts;camsvc;CaptureService_$QMARK;CDPSvc;CDPUserSvc_$QMARK;CertP" + 
                                   "ropSvc;COMSysApp;CryptSvc;CscService;defragsvc;DeviceAssociationService;DeviceInstall;DevicePickerUserSvc_$QMARK" + 
                                   ";DevQueryBroker;Dhcp;diagnosticshub.standardcollector.service;diagsvc;DiagTrack;DmEnrollmentSvc;dmwappushsvc;Dns" + 
                                   "cache;DoSvc;dot3svc;DPS;DsmSVC;DsRoleSvc;DsSvc;DusmSvc;EapHost;EFS;embeddedmode;EventLog;EventSystem;Fax;fdPHost" + 
                                   ";FDResPub;fhsvc;FontCache;FontCache3.0.0.0;FrameServer;ftpsvc;GraphicsPerfSvc;hidserv;hns;HomeGroupListener;Home" + 
                                   "GroupProvider;HvHost;icssvc;IKEEXT;InstallService;iphlpsvc;IpxlatCfgSvc;irmon;KeyIso;KtmRm;LanmanServer;LanmanWo" + 
                                   "rkstation;lfsvc;LicenseManager;lltdsvc;lmhosts;LPDSVC;LxssManager;MapsBroker;MessagingService_$QMARK;MSDTC;MSiSC" + 
                                   "SI;MsKeyboardFilter;MSMQ;MSMQTriggers;NaturalAuthentication;NcaSVC;NcbService;NcdAutoSetup;Netlogon;Netman;NetMs" + 
                                   "mqActivator;NetPipeActivator;netprofm;NetSetupSvc;NetTcpActivator;NetTcpPortSharing;NlaSvc;nsi;OneSyncSvc_$QMARK" + 
                                   ";p2pimsvc;p2psvc;PcaSvc;PeerDistSvc;PerfHost;PhoneSvc;pla;PlugPlay;PNRPAutoReg;PNRPsvc;PolicyAgent;Power;PrintN" + 
                                   "otify;PrintWorkflowUserSvc_$QMARK;ProfSvc;PushToInstall;QWAVE;RasAuto;RasMan;RemoteAccess;RemoteRegistry;RetailD" + 
                                   "emo;RmSvc;RpcLocator;SamSs;SCardSvr;ScDeviceEnum;SCPolicySvc;SDRSVC;seclogon;SEMgrSvc;SENS;Sense;SensorDataServi" + 
                                   "ce;SensorService;SensrSvc;SessionEnv;SgrmBroker;SharedAccess;SharedRealitySvc;ShellHWDetection;shpamsvc;smphost;" + 
                                   "SmsRouter;SNMPTRAP;spectrum;Spooler;SSDPSRV;ssh-agent;SstpSvc;StiSvc;StorSvc;svsvc;swprv;SysMain;TabletInputServ" + 
                                   "ice;TapiSrv;TermService;Themes;TieringEngineService;TimeBroker;TokenBroker;TrkWks;TrustedInstaller;tzautoupdate;" + 
                                   "UevAgentService;UI0Detect;UmRdpService;upnphost;UserManager;UsoSvc;VaultSvc;vds;vmcompute;vmicguestinterface;vmi" + 
                                   "cheartbeat;vmickvpexchange;vmicrdv;vmicshutdown;vmictimesync;vmicvmsession;vmicvss;vmms;VSS;W32Time;W3LOGSVC;W3S" + 
                                   "VC;WaaSMedicSvc;WalletService;WarpJITSvc;WAS;wbengine;WbioSrvc;Wcmsvc;wcncsvc;WdiServiceHost;WdiSystemHost;WebCl" + 
                                   "ient;Wecsvc;WEPHOSTSVC;wercplsupport;WerSvc;WFDSConSvc;WiaRpc;WinHttpAutoProxySvc;Winmgmt;WinRM;wisvc;WlanSvc;wl" + 
                                   "idsvc;wlpasvc;wmiApSrv;WMPNetworkSvc;WMSVC;workfolderssvc;WpcMonSvc;WPDBusEnum;WpnService;WpnUserService_$QMARK;" + 
                                   "wscsvc;WSearch;wuauserv;wudfsvc;WwanSvc;xbgm;XblAuthManager;XblGameSave;XboxGipSvc;XboxNetApiSvc" ).Split( ';' )
            Values               = ("0;1;2;3;3;4;3;5;3;6;2;2;3;3;3;2;7;3;3;0;0;0;0;3;3;4;7;2;0;3;2;8;3;3;3;3;3;2;3;3;2;3;1;2;7;3;2;3;3;3;2;3;3;3;2;2" + 
                                   ";1;3;3;3;2;3;1;2;3;3;6;3;3;1;1;3;3;9;0;1;3;3;2;2;1;3;3;3;2;3;1;0;3;3;1;11;2;2;0;3;3;0;0;3;2;2;3;3;2;1;2;2;7;3;3;" + 
                                   "2;8;3;1;3;3;3;3;3;2;3;3;2;3;3;3;3;12;12;1;3;1;2;12;1;1;3;3;1;2;6;13;13;13;0;7;1;3;2;12;3;1;1;3;2;3;3;3;3;3;3;3;2" + 
                                   ";13;3;0;2;3;3;3;2;3;12;5;3;0;3;2;3;3;3;6;1;1;1;1;1;1;1;1;14;3;3;3;2;3;3;3;3;3;3;2;0;3;3;0;3;3;3;3;13;3;3;2;1;1;1" + 
                                   "5;3;3;3;1;3;1;1;3;2;2;7;7;3;3;1;3;1;1;3;1").Split(';')
            Profile              = ("2,2,2,2,2,2,1,1,2,2;2,2,2,2,1,1,1,1,1,1;3,0,3,0,3,0,3,0,3,0;2,0,2,0,2,0,2,0,2,0;0,0,2,2,2,2,1,1,2,2;0,0,1,0,1,0" + 
                                   ",1,0,1,0;0,0,2,0,2,0,2,0,2,0;4,0,4,0,4,0,4,0,4,0;0,0,2,2,1,1,1,1,1,1;3,3,3,3,3,3,1,1,3,3;4,4,4,4,1,1,1,1,1,1;0,0" + 
                                   ",0,0,0,0,0,0,0,0;1,0,1,0,1,0,1,0,1,0;2,2,2,2,1,1,1,1,2,2;0,0,3,0,3,0,3,0,3,0;3,3,3,3,2,2,2,2,3,3" ).Split( ';' )
        }

        $Ref                     = [ PSCustomObject ]@{ 
            
            Company              = "https://github.com/secure-digits-plus-llc/FightingEntropy"
            MadBomb              = "https://github.com/madbomb122/BlackViperScript"
        }

        $Return                  = [ PSCustomObject ]@{ 

            PID                  = $QMark

            Version              = [ PSCustomObject ]@{ 

                Version          = "ViperBomb v7.0.0"
                Date             = "2020-02-07"
                Script           = $Default.ScriptConfig
                Service          = $Default.ServiceConfig
                Release          = "Development"
            }

            Company              = [ PSCustomObject ]@{

                Base             = $Ref.Company
                About            = $Ref.Company + "#secure-digits-plus-fighting-entropy"
                Service          = $Ref.Company + "/blob/master/Module/Services/" + $Default.ServiceConfig
                Site             = "https://www.securedigitsplus.com"
            }

            MadBomb              = [ PSCustomObject ]@{

                Base             = $Ref.MadBomb
                About            = $Ref.MadBomb + "/blob/master/README.md"
                Donate           = "https://www.amazon.com/gp/registry/wishlist/YBAYWBJES5DE/"
            }

            Sparks               = [ PSCustomObject ]@{ 

                Site             = "http://www.blackviper.com"
            }

            Path                 = Get-ScriptRoot

            Control              = $Default

            Copyright            = 
            
                "Copyright (c) 2019 Zero Rights Reserved                                 " ,
                "Services Configuration by Charles 'Black Viper' Sparks                  " ,
                "------------------------------------------------------------------------" ,
                "The MIT License (MIT) + an added Condition" , 
                "$( " " * 72 )" , 
                "Copyright (c) 2017-2019 Madbomb122 " ,
                "[ Black Viper Service Script ] " ,
                "$( " " * 72 )" , 
                "Permission is hereby granted, free of charge, to any person obtaining a " ,
                "copy of this software and associated documentation files (the Software)," , 
                "to deal in the Software without restriction, including w/o limitation   " , 
                "the rights to: use/copy/modify/merge/publish/distribute/sublicense,     " , 
                "and/or sell copies of the Software, and to permit persons to whom the   " , 
                "Software is furnished to do so, subject to the following conditions:    " ,
                "$( " " * 72 )" ,
                "The above copyright notice(s), this permission notice and ANY original  " , 
                "donation link shall be included in all copies or substantial portions of" , 
                "the Software.                                                           " ,
                "$( " " * 72 )" ,
                " The software is provided 'As Is', without warranty of any kind, express" ,
                "or implied, including but not limited to warranties of merchantibility, " ,
                "or fitness for a particular purpose and noninfringement. In no event    " , 
                "shall the authors or copyright holders be liable for any claim, damages " ,
                "or other liability, whether in an action of contract, tort or otherwise," , 
                "arising from, out of or in connection with the software or the use or   " ,
                "other dealings in the software.                                         " ,
                "$( " " * 72 )" ,
                "In other words, these terms of service must be accepted in order to use," ,
                "and in no circumstance may the author(s) be subjected to any liability  " ,
                "or damage resultant to its use.                                         "

            Message              = 
            
                "This utility provides an interface to load and customize`n" ,
                "service configuration profiles, such as:`n"                 ,
                "`n"                                                         ,
                "    Default: Black Viper (Sparks v1.0)`n"                   ,
                "    Custom: If in proper format`n"                          ,
                "    Backup: Created via this utility`n"                     -join '' 

            Help                 = 
            
                "Legacy Switches - [ Pending ] List of Switches                                                            " , 
                "$( "-" * 108 )" , 
                "   " ,
                " Switch            Description of Switch                                                                  " , 
                "   " , 
                " -- Basic Switches --                                                                                     " , 
                "  -atos            Accepts ToS                                                                            " , 
                "  -auto            Implies -atos ... Runs the script to be Automated..                                    " , 
                "                   Closes on - User Input, Errors, or End of Script                                       " , 
                "   " , 
	            " -- Service Configuration Switches --                                                                     " , 
	            "  -default         Runs the script with Services to Default Configuration                                 " , 
                "  -safe            Runs the script with Services to Black Viper's Safe Configuration                      " , 
                "  -tweaked         Runs the script with Services to Black Viper's Tweaked Configuration                   " , 
                "  -lcsc File.csv   Loads Custom Service Configuration, File.csv = Name of your backup/custom file         " , 
                "   " ,
                " --Service Choice Switches--                                                                              " , 
                "  -all             Every windows services will change                                                     " , 
                "  -min             Just the services different from the default to safe/tweaked list                      " , 
                "  -sxb             Skips changes to all XBox Services                                                     " , 
                "   " ,
                " --Update Switches--                                                                                      " , 
	            "  -usc             Checks for Update to Script file before running                                        " , 
                "  -use             Checks for Update to Service file before running                                       " , 
                "  -sic             Skips Internet Check, if you can't ping GitHub.com for some reason                     " , 
                "   " ,
                " --Log Switches--                                                                                         " , 
                "  -log             Makes a log file named using default name Script.log                                   " , 
                "  -log File.log    Makes a log file named File.log                                                        " , 
                "  -baf             Log File of Services Configuration Before and After the script                         " , 
                "   " ,
                " --Backup Service Configuration--                                                                         " , 
                "  -bscc            Backup Current Service Configuration, Csv File                                         " , 
                "  -bscr            Backup Current Service Configuration, Reg File                                         " , 
                "  -bscb            Backup Current Service Configuration, Csv and Reg File                                 " , 
                "   " ,
                " --Display Switches--                                                                                     " , 
                "  -sas             Show Already Set Services                                                              " , 
                "  -snis            Show Not Installed Services                                                            " , 
                "  -sss             Show Skipped Services                                                                  " , 
                "   " ,
                " --Misc Switches--                                                                                        " , 
                "  -dry             Runs the Script and Shows what services will be changed                                " , 
                "  -css             Change State of Service                                                                " , 
                "  -sds             Stop Disabled Service                                                                  " , 
                "   " ,
                " --AT YOUR OWN RISK Switches--                                                                            " , 
                "  -secp            Skips Edition Check by Setting Edition as Pro                                          " , 
                "  -sech            Skips Edition Check by Setting Edition as Home                                         " , 
                "  -sbc             Skips Build Check                                                                      " , 
                "   " ,
                " --Dev Switches--                                                                                         " ,
                "  -devl            Makes a log file with various Diagnostic information, Nothing is Changed               " , 
                "  -diag            Shows diagnostic information, Stops -auto                                              " , 
                "  -diagf           Forced diagnostic information, Script does nothing else                                " , 
                "   " ,
                " --Help--                                                                                                 " ,
                "  -help            Shows list of switches, then exits script.. alt -h                                     " , 
                "  -copy            Shows Copyright/License Information, then exits script                                 "

            Types                = [ PSCustomObject ]@{

                Types            = @( "H" , "P" | % { "10$_`:D" } ; "S" , "T" | % { "DT:$_" } ; "LT:S" ) | % { "$_+" , "$_-" }
                Titles           = @( "Home" , "Pro" | % { "Win10 $_ | Default" } ; "Safe" , "Tweaked" | % { "Desktop | $_" } ; "Laptop | Safe" ) | % { "$_ Max" , "$_ Min" }
            }

            Services             = [ PSCustomObject ]@{ 

                Xbox             = 'XblAuthManager,XblGameSave,XboxNetApiSvc,XboxGipSvc,xbgm'.Split(',')

                NetTCP           = 'Msmq,Pipe,Tcp' | % { "Net$_`Activator" }

                DataGrid         = 'Index,Scoped,Profile,Name,Status,StartType,DelayedAutoStart,DisplayName,PathName,Description'.Split(',')

                Skip             = @( ( 'BcastDVRUserService,DevicePickerUserSvc,DevicesFlowUserSvc,PimIndexMaintenanceSvc,PrintWorkflowUserSvc,UnistoreSvc,' + 
                'UserDataSvc,WpnUserService' -join '' ).Split(',') | % { "$_`_$QMark" } ) + @( 'AppXSVC,BrokerInfrastructure,ClipSVC,CoreMessagingRegistrar,' + 
                'DcomLaunch,EntAppSvc,gpsvc,LSM,MpsSvc,msiserver,NgcCtnrSvc,NgcSvc,RpcEptMapper,RpcSs,Schedule,SecurityHealthService,sppsvc,StateRepository,' + 
                'SystemEventsBroker,tiledatamodelsvc,WdNisSvc,WinDefend' -join '' ).Split(',') | Sort
            }

            Names                = @( 0..4 | % { "MenuConfig" , 'Home,Pro,Desktop,Desktop,Laptop'.Split(',')[$_] , 'Default,Default,Safe,Tweaked,Safe'.Split(',')[$_] -join '' } | % {
                "$_`Max" , "$_`Min" } ; 'Feedback,FAQ,About,Copyright,MadBombDonate,MadBombGitHub,BlackViper,SecureDigitsPlus'.Split(',') | % { "MenuInfo$_" } ;
                'Search,Select,Grid,Empty'.Split(',') | % { "ServiceDialog$_" } ; 'OS,Profile,Build,Chassis'.Split(',') | % { "Current$_" } ; 
                'Active,Inactive,Skipped'.Split(',') | % { "Display$_" } ; 'Simulate,Xbox,Change,StopDisabled'.Split(',') | % { "Misc$_" } ; 
                'DiagErrors,Log,Console,DiagReport'.Split(',') | % { "Devel$_" } ; 'Build,Edition,Laptop'.Split(',') | % { "Bypass$_" } ;
                @( 'Service,Script'.Split(',') | % { "Logging$_" } ; 'Registry,Template'.Split(',') | % { "Backup$_" } ) | % { "$_`Browse,$_`File".Split(',') } ;
                'Service,Script'.Split(',') | % { "$_`Profile" , "$_`Label"  } ; "Start,Cancel" -Split ',' )

            Config              = $ServiceConfig | % {
                
                ForEach ( $i in 0..( $_.Names.Count - 1 ) )
                { 
                    [ PSCustomObject ]@{ 
                
                        Service = $_.Names[$I]
                        Profile = $_.Profile[ $_.Values[$I]]
                    }
                }
            }
        }

        $Return | % { 
        
            If ( $Version   ) { $_.Version   }
            If ( $Company   ) { $_.Company   }
            If ( $MadBomb   ) { $_.MadBomb   }
            If ( $Sparks    ) { $_.Sparks    }
            If ( $Path      ) { $_.Path      }
            If ( $Control   ) { $_.Control   }
            If ( $Copyright ) { $_.Copyright }
            If ( $Message   ) { $_.Message   }
            If ( $Help      ) { $_.Help      }
            If ( $Services  ) { $_.Services  }
            If ( $Types     ) { $_.Types     }
            If ( $Names     ) { $_.Names     }
            If ( $Config    ) { $_.Config    }
            If ( $All       ) { $_ }
        }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Start-ViperDiagnostics #___________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( ) ] [ PSCustomObject ] $Model )

        $System               = Resolve-Windows -All
        $Viper                = Resolve-ViperBomb -All

        $Collect              = [ PSCustomObject ]@{ 

            Title             = @("Script","System"|%{"$_ Information"};"Initialization";("Display,Miscellaneous,Development,Bypass/Force,Logging,B"+
                                  "ackup").Split(',')|%{"$_ Settings"};"Version Control")|%{"[ $_ ]"}

            Section           = "Script,Sys,Cfg,Display,Miscellaneous,Development,Bypass,Logging,Backup,Version".Split(',')

            Info              = @("Version,Date,Script,Service,Release;";"OS,SKU,Build,Version,Chassis;";"Passed Args,Terms of Service;";"Active,In"+
                                "active,Skipped;Show {0} SVC";"Simulate Changes,Xbox Services,Change * SVC State,Stop * Disabled SVC;";"Diagnostic "+
                                "Errors,Devel Log,Enable Console,Report Diagnostic;";"Build Edition,Laptop;Bypass {0}";"Service,Script;Log {0} File";
                                "Registry,Template;Backup {0}";"Service,Script;{0} Config")

            Item              = @("Version,Date,Script,Service,Release";"OS,SKU,Build,Version,Chassis";"PassedArgs,TermsOfService";"DisplayActive,D"+
                                "isplayInactive,DisplaySkipped";"MiscSimulate,MiscXbox,MiscChange,MiscStopDisabled";"DevelDiagErrors,DevelLog,Devel"+
                                "Console,DevelDiagReport";"BypassBuild,BypassEdition,BypassLaptop";"LoggingServiceFile,LoggingScriptFile";"BackupRe"+
                                "gistryFile,BackupTemplateFile";"ServiceConfig,ScriptConfig")

            Subtable          = 0..9
        
            Script            = $Viper.Version
            
            Sys              = [ PSCustomObject ]@{
    
                OS            = $System.OS | % { "$( $_.Caption ) [$( $_.OSArchitecture )]" }
                SKU           = $System.SKU
                Build         = $System.Edition.Build
                Version       = $System.Edition.Version
                Chassis       = $System.Chassis
            }

            Cfg               = $Model | % { If ( $_ -eq $Null ) { $Viper.Control } Else { $_ } }
        }

        ForEach ( $i in 0..9 )
        {
            $X                = $Collect.Info[$I].Split(';')
            $Collect.Info[$I] = If ( $X[1] -like "{0}" ) { ( $X[0].Split(',') | % { $X[1] -f $_ } ) -join ',' } Else { $X[0] }

            $Items            = $Collect.Item[$I].Split(',')
            $Values           = $Items | % { If ( $I -eq 0 ) { $Collect.Script.$_ } If ( $I -eq 1 ) { $Collect.Sys.$_ } If ( $I -gt 1 ) { $Collect.Cfg.$_ } }

            $Collect.Subtable[$I] = New-Subtable -Items $Items -Values $Values
        }

        $Splat                = @{ 

            Title             = "Diagnostic/Startup Panel"
            Depth             = 10
            ID                = $Collect.Title
            Table             = $Collect.Subtable
        }

        $Table                = New-Table @Splat
        
        Write-Theme -Table $Table -Prompt "Press Enter to Continue, CTRL+C to Exit"
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-ServiceProfile #_______________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Write-Theme -Action "Collecting [+]" "[ Service Configuration ]: Current Profile"

        $Get                          = [ PSCustomObject ]@{ 

            Config                    = Resolve-ViperBomb -Config
            Current                   = Get-CurrentServices
            Index                     = ""
            Scoped                    = @( )
            Profile                   = @( )
            Name                      = @( )
            StartMode                 = @( )
            State                     = @( )
            DisplayName               = @( )
            PathName                  = @( )
            Description               = @( )
            Track                     = [ PSCustomObject ]@{

                Current               = [ PSCustomObject ]@{

                    Include           = ""
                    Exclude           = ""
                    Count             = ""
                }

                Config                = [ PSCustomObject ]@{ 
                    
                    Include           = ""
                    Exclude           = ""
                    Profile           = ""
                    Count             = ""
                }
            }
        }

        $Get.Track                    | % { 
        
            $_.Current                | % { 
        
                $_.Include            = $Get.Current     | ? { $_.Name    -in $Get.Config.Service } | % { $_.Name }
                $_.Exclude            = $Get.Current     | ? { $_.Name -notin $Get.Config.Service } | % { $_.Name }
                $_.Count              = $_.Include.Count + $_.Exclude.Count
            }

            $_.Config                 | % { 

                $_.Include            = $Get.Config      | ? { $_.Service    -in $Get.Current.Name   } | % { $_.Service }
                $_.Exclude            = $Get.Config      | ? { $_.Service -notin $Get.Current.Name   } | % { $_.Service }
                $_.Profile            = $Get.Config      | ? { $_.Service    -in $Get.Current.Name   }
                $_.Count              = $_.Include.Count + $_.Exclude.Count
            }
        }

        $Get.Index                    = 0..( $Get.Current.Count - 1 )

        $Get.Index                    = $Get.Index.Count | Measure -Character | % { $_.Characters } | % {
            
            ForEach ( $I in $Get.Index ) { "{0:d$_}" -f $I }
        }
        
        $Get | % { 

            $_.Scoped                 = $_.Index | % { "[-]" }
            $_.Profile                = $_.Index | % { "-,-,-,-,-,-,-,-,-,-" }
            $_.Name                   = $_.Index | % { "-" }
            $_.StartMode              = $_.Index | % { "-" }
            $_.State                  = $_.Index | % { "-" }
            $_.DisplayName            = $_.Index | % { "-" }
            $_.PathName               = $_.Index | % { "-" }
            $_.Description            = $_.Index | % { "-" }
        }

        $Get.Track.Config.Profile     = $Get.Config | ? { $_.Service -in $Get.Current.Name }

        ForEach ( $I in $Get.Index )
        {
            $Get.Name[$I]             = $Get.Current.Name[$I]
                
            If ( $Get.Name[$I]     -in $Get.Track.Current.Include )
            {
                $Get.Scoped[$I]       = "[+]"
                $Get.Profile[$I]      = $Get.Track.Config.Profile | ? { $_.Service -eq $Get.Name[$i] } | % { $_.Profile }
                $Get.StartMode[$I]    = $Get.Current.StartMode[$I]
                $Get.State[$I]        = $Get.Current.State[$I]
                $Get.DisplayName[$I]  = $Get.Current.DisplayName[$I]
                $Get.PathName[$I]     = $Get.Current.PathName[$I]
                $Get.Description[$I]  = $Get.Current.Description[$I]
            }

            If ( ( $Get.Name[$I] -in $Get.Current.Name ) -and ( $Get.Name[$I] -in $Get.Track.Current.Exclude ) )
            {
                $Get.Scoped[$I]       = "[_]"
                $Get.Profile[$I]      = "-,-,-,-,-,-,-,-,-,-"
                $Get.StartMode[$I]    = $Get.Current.StartMode[$I]
                $Get.State[$I]        = $Get.Current.State[$I]
                $Get.DisplayName[$I]  = $Get.Current.DisplayName[$I]
                $Get.PathName[$I]     = $Get.Current.PathName[$I]
                $Get.Description[$I]  = $Get.Current.Description[$I]
            }
        }

        $Return                       = $Get.Index | % { 
        
            [ PSCustomObject ]@{ 
            
                Index                 = $Get.Index[$_]
                Scoped                = $Get.Scoped[$_]
                Profile               = $Get.Profile[$_]
                Name                  = $Get.Name[$_]
                StartMode             = $Get.StartMode[$_]
                State                 = $Get.State[$_]
                DisplayName           = $Get.DisplayName[$_]
                PathName              = $Get.PathName[$_]
                Description           = $Get.Description[$_]
            }
        }

        $Return                       = [ PSCustomObject ]@{

            Svc                       = $Return 
            Cfg                       = $Get.Cfg
            Current                   = $Get.Current
        }

        $Return

        Write-Theme -Action  "Importing [+]" "[ Service Configuration ]: Target Profile"

                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Filter-ServiceProfile #____________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Mandatory ) ] [ PSCustomObject ] $ProfileObject )

        $ProfileObject | % {

            $_.Inf.Control.DisplayActive , $_.Inf.Control.DisplayInactive , $_.Inf.Control.DisplaySkipped , $_.Inf.Control.MiscXbox }

            $_.Cfg         | % { 

                If ( $_.Inf.Control.DisplayActive -eq 1 )
                { 
                    $_.Cfg.Active   = $_.Cfg.Master | ? { $_.State -eq "Running" }                     | % { $_.Name } 
                }

                If ( $_.Inf.Control.DisplayInactive -eq 1 )
                { 
                    $_.Cfg.Inactive = $_.Cfg.Master | ? { $_.State -eq "Stopped" }                     | % { $_.Name } 
                }

                If ( $_.Inf.Control.DisplaySkipped -eq 1 )
                { 
                    $_.Cfg.Skipped  = $_.Cfg.Master | ? { $_.Name -in $ProfileObject.Cfg.Filter.Skip } | % { $_.Name } 
                }

                If ( $_.Inf.Control.MiscXbox -eq 1 )
                { 
                    $_.Cfg.Xbox     = $_.Cfg.Master | ? { $_.Name -in $ProfileObject.Cfg.Filter.Xbox } | % { $_.Name } 
                }
            }
        }
        
        $ProfileObject                                                              #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Show-Console #_____________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Param ( [ Int ] $Switch )
            
            [ Console.Window ]::ShowWindow( [ Console.Window ]::GetConsoleWindow() , $Switch )
    
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-ViperBomb # ____________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

        # OS Version

        [ Environment ]::OSVersion.Version.Major | % {
        
            If ( $_ -ne 10 )
            {
                Write-Theme -Action "Exception [!]" "Only Windows 10 Client is currently supported" 12 4 15
                Read-Host "Press Enter to Exit"
                Break
            }

            Else
            {
                #$Splat               = @{ 
                
                #    Name             = "Window"
                #    Namespace        = "Console"
                #    MemberDefinition = "[DllImport('Kernel32.dll')] public static extern IntPtr GetConsoleWindow(); [DllImport('user32.dll')] public static extern bool ShowWindow(IntPtr hWnd, Int32 nCmdShow)"
                #}

                Add-Type -Name Window -Namespace Console -MemberDefinition "[DllImport('Kernel32.dll')] public static extern IntPtr GetConsoleWindow(); [DllImport('user32.dll')] public static extern bool ShowWindow(IntPtr hWnd, Int32 nCmdShow)"
            }
        }

        # Administrative Rights

        "Security.Principal.Windows" | % { IEX "( [ $_`Principal ][ $_`Identity ]::GetCurrent() ).IsInRole( 'Administrator' )" } | % {

            If ( $False ) 
            {                
                Write-Theme -Action "Access [!]" "Limited, attempting elevation" 12 4 15

                SAPS PowerShell "-NoProfile -ExecutionPolicy Bypass -File `"$PSCommandPath`" $PassedArg" -Verb RunAs
                
                If ( $False )
                { 
                    Write-Theme -Action "Exception [!]" "Elevation has failed" 12 4 15
                    Read-Host "Press Enter to Exit"
                    Break
                }
            }

            If ( $True )
            { 
                Write-Theme -Action "Confirmed [+]" "Administrative Rights" 11 11 15 
            }
        }

        Write-Theme -Array ( Resolve-ViperBomb -Copyright ) -Title "Terms of Service / Copyright" -Prompt "Press Enter to Continue" | % { 

            If ( $_ -eq $True )
            {
                Write-Theme -Action "Accepted [+]" "Terms of Service" 11 11 15
                    
                #$Control.TermsOfService        = 1

                #$Collection                    = Resolve-ViperBomb -All
                #$Windows                       = Resolve-Windows -All
                #$Config                        = Get-ServiceProfile

                #Resolve-ViperBomb -Types       | % {
                
                #    $Type                      = $_.Types 
                #    $Titles                    = $_.Titles
                #}

                #$MSInfo                        = $Windows.OS
                #$System                        = $Windows.CS
                #$Chassis                       = $Windows.Chassis
                #$Path                          = $Collection.Path.Parent + "\Services"
                #$MadBomb                       = $Collection.MadBomb
                #$Company                       = $Collection.Company
                #$Sparks                        = $Collection.Sparks


                $Master                        = [ PSCustomObject ]@{ 

                    Sys                        = Resolve-Windows -All
                    Inf                        = Resolve-ViperBomb -All
                    Cfg                        = Get-ServiceProfile


                    #Wpf                        = [ PSCustomObject ]@{

                        #XAML                   = Get-XAML -Service
                        #Named                  = Resolve-ViperBomb -Names
                        #GUI                    = ""
                    #}
                }

                $Master                        = Filter-ServiceProfile -ProfileObject $Master
                
                $Master                        | % {

                    $_.Inf.Control.TermsOfService  = 1
                    $_.WPF                     | % {
                    
                        $_.GUI                   = Convert-XAMLToWindow -Xaml $_.XAML -NE $_.Named -Passthru 
                    }
                }

                $Service                       = @( )

                $GUI = Convert-XAMLToWindow -Xaml ( Get-Xaml -Service ) -NE ( Resolve-ViperBomb -Names )
            }

            Else 
            {
                Write-Theme -Action "Exception [!]" "Terms of Service was not accepted, aborting" 12 4 15
                Read-Host "Press Enter to Exit"
                Break
            }
        }

        # Defaults

        $Master.WPF.GUI | % { 
        
            $_.DisplayActive , $_.DisplayInactive , $_.DisplaySkipped | % { $_.IsChecked = $True }
            
            $_.CurrentOS.Text                         = "{0} ({1})" -f $Master.Sys.MSInfo.Caption , $env:PROCESSOR_ARCHITECTURE.Replace( 'AMD' , 'x' )
            $_.CurrentBuild.Text                      = $PSVersionTable.BuildVersion
            $_.CurrentChassis.Text                    = $Master.Sys.Chassis

            $_.ServiceDialogEmpty.Text                = "Select a profile from the configuration menu to begin"
            $_.ServiceDialogSearch.IsEnabled          = $False
            $_.ServiceLabel.Text                      = $_.ServiceProfile.SelectedItem.Content
            $_.ScriptLabel.Text                       = $_.ScriptProfile.SelectedItem.Content
        }

        Function Select-ServiceProfile
        {
            [ CmdLetBinding () ] Param ( [ Parameter ( Mandatory ) ] [ PSCustomObject ] $Master )

                $Control = $Master.Collect.Control
                $Types   = $Master.Profile.Types
        }

        Function Filter-DataGrid
        {
            [ CmdLetBinding () ] Param (

                [ Parameter ( Mandatory ) ] [ PSCustomObject ] $Master )

            $Master.Config
            $Types = $Master.Profile.Types
            $Output                                 = @( )

            @{ 1 = $Config.DisplayActive    }[ $Control.DisplayActive   ] | % { $Output += $_ }
            @{ 1 = $Config.DisplayInactive  }[ $Control.DisplayInactive ] | % { $Output += $_ }
            @{ 1 = $Config.DisplaySkipped   }[ $Control.DisplaySkipped  ] | % { $Output += $_ }
            @{ 1 = $Config.MiscXbox         }[ $Control.MiscXbox        ] | % { $Output += $_ }

            If ( $Output.Count -gt 0 )
            {
                $Output                             = $Output  | ? { $_ -ne $Null } | Sort
                $Service                            = $Service | ? { $_.Name -in $Output }
            }

            [ PSCustomObject ]@{ Service = $Service }
        }

        Function Refresh-DataGrid
        {
            [ CmdLetBinding () ] Param (

                [ Parameter ( Mandatory ) ] [ Windows.Window ] $GUI     ,
                [ Parameter ( Mandatory ) ] [ PSCustomObject ] $Control ,
                [ Parameter ( Mandatory ) ] [ PSCustomObject ] $Config  )

            If ( ! $GUI.ServiceDialogSearch.IsEnabled )
            { 
                $GUI.ServiceDialogSearch.IsEnabled  = $True
                $GUI.ServiceDialogEmpty.Visibility  = "Collapsed"
                $GUI.ServiceDialogEmpty.Text        = "" 
            }

            Resolve-ViperBomb -Types                   | % {

                $Type                               = ( $_.Types  )[ $Control.Profile ]
                $GUI.CurrentProfile.Text            = ( $_.Titles )[ $Control.Profile ]
            }

            $Service                                = @( )
            
            0..( $Config.Master.Count - 1 )         | % {

                $Service                           += [ PSCustomObject ]@{ 

                    Index                           = $Config.Master[$_].Index
                    Scoped                          = $Config.$Type[$_].Scoped
                    Profile                         = $Config.$Type[$_].Profile
                    Name                            = $Config.$Type[$_].Name
                    Status                          = $Config.Master[$_].Status
                    StartType                       = $Config.Master[$_].StartType
                    DelayedAutoStart                = $Config.Master[$_].DelayedAutoStart
                    DisplayName                     = $Config.Master[$_].DisplayName
                    PathName                        = $Config.Master[$_].PathName
                    Description                     = $Config.Master[$_].Description
                }
            }

            Filter-Datagrid -Control $Control -Service $Service | % { $Service = $_.Service }

            $GUI.ServiceDialogGrid.ItemsSource      = $Null

            $Output                                 = @( )

            If ( $Control.DisplayActive   -eq 1 ) { $Config.DisplayActive   | % { $Output += $_ } }
            If ( $Control.DisplayInactive -eq 1 ) { $Config.DisplayInactive | % { $Output += $_ } }
            If ( $Control.DisplaySkipped  -eq 1 ) { $Config.DisplaySkipped  | % { $Output += $_ } }
            If ( $Control.MiscXbox        -eq 1 ) { $Config.MiscXbox        | % { $Output += $_ } }

            If ( $Output.Count -gt 0 )
            {
                $Output                             = $Output  | ? { $_ -ne $Null } | Sort
                $Service                            = $Service | ? { $_.Name -in $Output }
            }

            $GUI.ServiceDialogGrid.ItemsSource      = $Service

            [ PSCustomObject ]@{ Service            = $Service }
        }

        $Select = {
        
            If ( $Control.Profile -in 0..9 ) 
            { 
                Refresh-DataGrid -GUI $GUI -Control $Control -Config $Config | % { $Service = $_.Service } 
            }
        }

        $GUI.MenuInfoFeedback.Add_Click({             Start $Company.Base   })
        $GUI.MenuInfoFAQ.Add_Click({                  Start $Company.About  })
        $GUI.MenuInfoAbout.Add_Click({                Show-Message -Title "About - ViperBomb Service Configuration Utility" -Message ( Resolve-ViperBomb -Message ) })
        $GUI.MenuInfoCopyright.Add_Click({            Show-Message -Title "Copyright" -Message ( ( Resolve-ViperBomb -Copyright ) -join "`n" ) })
        $GUI.MenuInfoMadBombDonate.Add_Click({        Start $MadBomb.Donate  })
        $GUI.MenuInfoMadBombGitHub.Add_Click({        Start $MadBomb.Base    })
        $GUI.MenuInfoBlackViper.Add_Click({           Start $Sparks.Website  })
        $GUI.MenuInfoSecureDigitsPlus.Add_Click({     Start $Company.Site    })
            
        $GUI.MenuConfigHomeDefaultMax.Add_Click({     $Control.Profile         = 0 ; & $Select })
        $GUI.MenuConfigHomeDefaultMin.Add_Click({     $Control.Profile         = 1 ; & $Select })
        $GUI.MenuConfigProDefaultMax.Add_Click({      $Control.Profile         = 2 ; & $Select })
        $GUI.MenuConfigProDefaultMin.Add_Click({      $Control.Profile         = 3 ; & $Select })
        $GUI.MenuConfigDesktopSafeMax.Add_Click({     $Control.Profile         = 4 ; & $Select })
        $GUI.MenuConfigDesktopSafeMin.Add_Click({     $Control.Profile         = 5 ; & $Select })
        $GUI.MenuConfigDesktopTweakedMax.Add_Click({  $Control.Profile         = 6 ; & $Select })
        $GUI.MenuConfigDesktopTweakedMin.Add_Click({  $Control.Profile         = 7 ; & $Select })
        $GUI.MenuConfigLaptopSafeMax.Add_Click({      $Control.Profile         = 8 ; & $Select })
        $GUI.MenuConfigLaptopSafeMin.Add_Click({      $Control.Profile         = 9 ; & $Select })

        $GUI.DisplayActive.Add_Unchecked({            $Control.DisplayActive   = 0 ; & $Select })
        $GUI.DisplayActive.Add_Checked({              $Control.DisplayActive   = 1 ; & $Select })
        $GUI.DisplayInactive.Add_Unchecked({          $Control.DisplayInactive = 0 ; & $Select })
        $GUI.DisplayInactive.Add_Checked({            $Control.DisplayInactive = 1 ; & $Select })
        $GUI.DisplaySkipped.Add_Unchecked({           $Control.DisplaySkipped  = 0 ; & $Select })
        $GUI.DisplaySkipped.Add_Checked({             $Control.DisplaySkipped  = 1 ; & $Select })
        $GUI.MiscXbox.Add_Unchecked({                 $Control.MiscXbox        = 0 ; & $Select })
        $GUI.MiscXbox.Add_Checked({                   $Control.MiscXbox        = 1 ; & $Select })

        $GUI.ServiceDialogSearch.Add_TextChanged(
        {
            $Text = $GUI.ServiceDialogSearch.Text

            If ( $GUI.ServiceDialogSearch.Text -ne "" )
            {
                If ( $GUI.ServiceDialogSelect.IsEnabled -eq $True )
                {
                    $Filter                                 = $GUI.ServiceDialogSelect.SelectedItem.Content
                    $Service                                = $GUI.ServiceDialogGrid.ItemsSource.Clone()
                    $GUI.ServiceDialogSelect.IsEnabled      = $False

                    Filter-Datagrid -Control $Control -Service $Service | % { $Immute = $_.Service }
                }

                $GUI.ServiceDialogGrid.ItemsSource          = $Null

                $Return                                     = @( )

                $Immute.Clone() | ? { $_.$Filter -match $Text } | % { $Return += $_ }
            
                If ( $Return.Count -gt 0 )
                {
                    $GUI.ServiceDialogGrid.Visibility       = "Visible" 
                    $GUI.ServiceDialogGrid.ItemsSource      = $Return
                    $GUI.ServiceDialogEmpty.Visibility      = "Collapsed"
                    $GUI.ServiceDialogEmpty.Text            = ""
                }

                If ( $Return.Count -eq 0 )
                {
                    $GUI.ServiceDialogGrid.Visibility       = "Collapsed"
                    $GUI.ServiceDialogGrid.ItemsSource      = $Null
                    $GUI.ServiceDialogEmpty.Visibility      = "Visible"
                    $GUI.ServiceDialogEmpty.Text            = "No results found"
                }
            }
            
            If ( $GUI.ServiceDialogSearch.Text -eq "" )
            {
                If ( $GUI.ServiceDialogSelect.IsEnabled -eq $False )
                {
                    $GUI.ServiceDialogSelect.IsEnabled  = $True
                    $GUI.ServiceDialogGrid.Visibility   = "Visible"
                    $GUI.ServiceDialogGrid.ItemsSource  = $Immute
                    $GUI.ServiceDialogEmpty.Visibility  = "Collapsed"
                    $GUI.ServiceDialogEmpty.Text        = ""
                }
            }
        })

        # ----------- #
        # Preferences #
        # ----------- #

        Function Open-FileDialog
        {
            [ CmdLetBinding() ] Param ( 

                [ Validateset( 0 , 1 , 2 , 3 ) ]
                [ Parameter (      Mandatory ) ] [            Int ] $ItemDialog , 
                [ Parameter (      Mandatory ) ] [ Windows.Window ] $GUI        ,
                [ Parameter (      Mandatory ) ] [ PSCustomObject ] $Control    )

            $ItemDialog      | % { 

                $Item        = [ PSCustomObject ]@{ 
            
                    Item     = ( $GUI.LoggingServiceFile , $GUI.LoggingScriptFile , $GUI.BackupRegistryFile , $GUI.BackupTemplateFile )[$_]
                    Object   = ( $Control | % { $_.LoggingServiceFile , $_.LoggingScriptFile , $_.BackupRegistryFile , $_.BackupTemplateFile } )[$_]
                    Caption  = @( "Service Logging" , "Script Logging" , "Registry Backup" , "Template Backup" | % { "Designate $_ File" } )[$_]
                    FileType = @( "log" , "log" , "reg" , "csv" | % { "$_ (*.$_) | *.$_" } )[$_]
                    FileName = @( "Service.log" , "Script.log" , "Backup.reg" , "Template.csv" )[$_]
                }
            }

            $Item.Item                              | % {
                    
                $_.IsEnabled                        = $True
                $_.Text                             = ( Get-Date -UFormat "%Y%m%d_%H%M" ) , $Item.Object -join '_'
            }

            $Dialog                                 = New-Object System.Windows.Forms.SaveFileDialog
                    
            $Dialog                                 | % {

                $_.Title                            = $Item.Caption
                $_.InitialDirectory                 = $Path
                $_.Filter                           = $Item.FileType
                $_.Filename                         = ( Get-Date -UFormat "%Y%m%d-%H_%M" ) , $Item.FileName -join '_'
            }

            $X                                      = $Dialog.ShowDialog()

            If ( $X -eq "OK" )
            {
                $Item.Item.Text                     = $Dialog.Filename
            }

            Else
            {
                $Item.Item                          | % {
                          
                    $_.IsEnabled                    = $False
                    $_.Text                         = "<Activate to designate a different file name/path>"
                }
            }

            $Dialog.Dispose()
            
        }

        $GUI.LoggingServiceBrowse.Add_Click({ Open-FileDialog -Item 0 -GUI $GUI -Control $Control })
        $GUI.LoggingScriptBrowse.Add_Click({  Open-FileDialog -Item 1 -GUI $GUI -Control $Control })
        $GUI.BackupRegistryBrowse.Add_Click({ Open-FileDialog -Item 2 -GUI $GUI -Control $Control })
        $GUI.BackupTemplateBrowse.Add_Click({ Open-FileDialog -Item 3 -GUI $GUI -Control $Control })

        #$GUI.MiscSimulate
        #$GUI.MiscChange
        #$GUI.MiscStopDisabled

        #$GUI.DevelDiagErrors
        #$GUI.DevelLog
        #$GUI.DevelConsole
        #$GUI.DevelDiagReport

        #$GUI.BypassBuild
        #$GUI.BypassEdition
        #$GUI.BypassLaptop

        #$GUI.MiscSimulate   [ What If ]
        # Produce a list of services and corresponding changes
        
        #$GUI.MiscChange [ Change the service state ]
        # If running, and non compliant, change the state

        #$GUI.MiscStopDisabled 
        # If a disabled service is running, stop them?

        #$GUI.DevelDiagErrors

        #$GUI.DevelLog
        #$GUI.DevelConsole
        #$GUI.DevelDiagReport
        
        # ------------------------ #

        
        $GUI.ServiceProfile.Add_SelectionChanged( { $GUI.ServiceLabel.Text = $GUI.ServiceProfile.SelectedItem.Content })
        $GUI.ScriptProfile.Add_SelectionChanged(  { $GUI.ScriptLabel.Text  = $GUI.ScriptProfile.SelectedItem.Content })

        # ------------------------ #

        #$GUI.ConsoleOutput
        #$GUI.DiagnosticOutput

        #$GUI.Start

        $GUI.Cancel.Add_Click({ $GUI.DialogResult = $False })

        $GUI | % { $_.LoggingServiceFile , $_.LoggingScriptFile , $_.BackupRegistryFile , $_.BackupTemplateFile } | % { 
        
            $_.Text = "<Activate to designate a different file name/path>"
        }

        Show-WPFWindow -GUI $GUI

        #------------------------#
        #   Post-Dialog Logic    #
        #------------------------#

        # This will be where the post dialog logic goes that handles the output of the script. It will be kick started
        # when the $GUI.Start is wired up to process the error correction/validation of everything that the program
        # allowed the user to enter/use... and if the output is validated, then the instructions/actions afterward go here.

        # For other examples of how this process works, feel free to scope out the Install-HybridDSC or Initialize-DomainController
        # functions in the main module.

                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function New-SubTable # Converts array of keys and values into an Object ___________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ][ String [] ]  $Items ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ][ String [] ] $Values )

        $Table = [ PSCustomObject ]@{ }

        If ( $Items.Count -eq $Values.Count )
        {
            If ( $Items.Count -gt 1 ) 
            { 
                $X     = $Items.Count | Measure -Character | % { $_.Characters }

                $Count = 0..( $Items.Count - 1 )

                $Name  = $Count | % { "{0:d$X}" -f $_ }

                $Count | % { $Table | Add-Member -MemberType NoteProperty -Name "Item:$( $Name[$_] )" -Value @{ ID = "$( $Items[$_] )" ; Value = "$( $Values[$_] )" } }
            }
            
            If ( $Items.Count -eq 1 )
            {
                $Table | Add-Member -MemberType NoteProperty -Name "Item:0" -Value @{ ID = "$( $Items )" ; Value = "$( $Values )" } 
            }
        }
        
        If ( $Items.Count -ne $Values.Count ) 
        { 
            Throw '$Items -ne $Values' 
        }
        
        Return $Table                                                                #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function New-Table # Converts array of objects into a single object _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ][         String    ] $Title ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ][            Int    ] $Depth ,
            [ Parameter ( Position = 2 , Mandatory = $True , ValueFromPipeline = $True ) ][         String [] ] $ID    ,
            [ Parameter ( Position = 3 , Mandatory = $True , ValueFromPipeline = $True ) ][ PSCustomObject [] ] $Table )

        $Object = [ PSCustomObject ]@{ Class = $Title }
        
        If ( ( $ID.Count -ne $Depth ) -or ( $Table.Count -ne $Depth ) ) 
        { 
            Throw '$Depth -ne $ID.Count or $Table.Count' 
        }
        
        If ( $Depth -eq 1 ) 
        { 
            $Count = 1 
        } 
        
        If ( $Depth -gt 1 ) 
        { 
            $Count = 0..( $Depth - 1 ) 
        }
        
        $C         = $Null
        
        $Count     | % {

            If ( $Depth -gt 1 )
            {   
                If ( $C -ne $Null ) 
                { 
                    $C ++ 
                } 
                
                If ( $C -eq $Null ) 
                { 
                    $C = 0 
                } 
                
                $Index   = $ID[$C]
                $Section = $Table[$C] 
            }

            If ( $Depth -eq 1 )
            {   
                $C       = 0
                $Index   = $ID
                $Section = $Table 
            }

            $String = [ Ordered ]@{ }

            $NX = @( 0..9 | % { "{0:d1}" } ; 10..99 | % { "{0:d2}" } ; 100..999 | % { "{0:d3}" } ; 1000..9999 | % { "{0:d4}" } )[ $Depth ]

            $Object | Add-Member -MemberType NoteProperty -Name "ID:$C" -Value $Index

            $Keys = @( $Section | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } )

            ForEach ( $S in $Keys )
            {   
                $SubTable = [ Ordered ]@{ }

                ForEach ( $K in $Keys ) 
                { 
                    $Section.$K | % { 
                    
                        $SubTable.Add( "$K" , @{ ID = $_.ID ; Value = $_.Value } ) 
                    } 
                } 
            } 

            $Object | Add-Member -MemberType NoteProperty -Name "Section:$C" -Value $SubTable
        }
        
        Return $Object                                                               #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Convert-HashToArray # Converts a hashtable into formatted array ____________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( [ Parameter ( Mandatory ) ] [ Hashtable ] $Table )

        $Output                                            = @( )

        $Table                                             | % { 

            $_.GetEnumerator()                             | % { 
            
                If ( $_.Value.GetType().Name -eq "Hashtable" )
                {
                    $Output                               += "[$( $_.Name )]"

                    $Table.$( $_.Name ).GetEnumerator()    | % { 
                    
                        $Output                           += $_.Name , $_.Value -join '=' 
                    }

                    $Output                               += ""
                }

                Else
                {
                    $Output                               += $_.Name , $_.Value -join '=' 
                }
            }

            $Output                                       += ""
        }

        Return $Output                                                               #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___ 
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Write-Theme # Even your grandmother might say "That's pretty cool."_________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] [ OutputType ( "String" ) ] Param ( 

            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 0 ) ][         Switch ]   $Action ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 1 ) ][         String ] $Function ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 2 ) ][      String [] ]    $Array ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 3 ) ][ PSCustomObject ]    $Table ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 4 ) ][         Switch ]     $Free ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][         Switch ]     $Foot ,
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 0 ) ][ String ]       $Type  ,
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 0 ) ][ String ]       $Info  ,
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 2 ) ][ String ]      $Title  ,
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 0 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 1 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 3 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 4 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][    Int ]   $Edge = 11 ,
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 0 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 1 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 3 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 4 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][    Int ] $Center = 12 ,
            [ Parameter ( Position = 5 , ValueFromPipeline = $True , ParameterSetName = 0 ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 1 ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 3 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 4 ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][    Int ]   $Font = 15 ,
            [ Parameter ( Position = 6 , ValueFromPipeline = $True , ParameterSetName = 0 ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 1 ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 3 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 4 ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][    Int ]   $Back =  0 ,
            [ Parameter ( Position = 5 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 3 ) ][ String ]      $Prompt )

        Begin
        {
            $GX = $Edge , $Center , $Font , $Back , 15 , 12 , 9 , 0 , 10 ; $S = " // " , " \\ " ; $F = "/¯¯\" , "\__/" ; $PI = "($( [ Char ] 960 ))" ;
            $L  = $S[1..0] ; $R = $S ; $M = 0..3 | % { IEX "`$M$_ = 0..120 | % { @( '¯' , '_' , ' ' , '-' )[$_] * `$_ }" }

        }

        Process
        {
            If ( $Function )
            {
                $FA = $Function ; $FL = $FA.Length ; $Return = 0..4
                
                If ( $FL -le 58 ) { $Y  = " ]$( $M1[ 62 - $FL ] )__/" }
                If ( $FL -gt 58 ) { $FA = "$( $FA[ 0..58 ] -join '' )... " ; $Y  = "]__/" }
                
                ForEach ( $I in 0..4 ) 
                { 
                    $Return[$I] = [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" }
                    
                    If ( $I    -in 0 , 4 ) { $Return[$I] | % { $_.FG = 0 ; $_.BG = 3 } }
                    If ( $I -notin 0 , 4 ) { $Return[$I].BG = @( 3 ) * 13 }
                }

                $Return[0] | % { 

                    $_.ST  = "  ____  $( $M2[68] )$( "  ____  " * 5 )"
                    $_.FG  = 0
                }
                
                $Return[1] | % { 
                    
                    $_.ST  = @( " /" , $F[0] , "\$( $M1[70] )/" ; $F * 4 ; $F[0] , "\ " )
                    $_.FG  = @( 0 , 1 ) * 6 + 0
                }

                $Return[2] | % { 

                    $_.ST  = @( " \" , $F[1] , "/$( $M0[70] )\" ; @( $F[ 1 , 0 ] )  * 4 ; $F[1] , "/ " ) 
                    $_.FG  = @( 0 ; @( 1 ) * 11 ; 0 )
                }
                    
                $Return[3] | % {
                    
                    $_.ST  = @( "  ¯¯¯\" , "\__[ " , $FA , $Y ; @( $F ) * 4 ; "/¯¯¯  " )
                    $_.FG  = @( 0 , 1 , 2 ; @( 1 , 0 ) * 5 )
                }

                $Return[4] | % {
                    
                    $_.ST  = "      $( $M0[72] )$( "    ¯¯¯¯" * 4 )      "
                    $_.FG  = 0
                }
            }

            If ( $Action )
            {                
                $Return = 0..4
                
                If ( $Type.Length -gt 18 ) 
                { 
                    $T = "$( $Type[ 0..17 ] -join '' )..." 
                } 
                
                Else 
                { 
                    $T = "$( $M2[ ( 21 - $Type.Length ) ] )$Type" 
                }
                
                If ( $Info.Length -gt 66 ) 
                { 
                    $IN = "$( $Info[ 0..65 ] -join '' )..." 
                } 
                
                Else 
                { 
                    $IN = "$Info$( $M2[ ( 69 - $Info.Length ) ])"  
                }

                0..4 | % {

                    $Return[$_] = [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" }

                    If ( $_ -in 0 , 4 )
                    {
                        $Return[$_] | % { $_.FG = 0 ; $_.BG = 3 }
                    }
                    
                    If ( $_ -in 1 , 3 )
                    {
                        $Return[$_] | % { $_.FG = 0 , 1 , 0 , 1 , 0 ; $_.BG = @( 3 ) * 5 }
                    }

                    If ( $_ -eq 2 )
                    {
                        $Return[$_] | % { $_.FG = 0 , 1 , 1 , 2 , 1 , 1 , 0 ; $_.BG = @( 3 ) * 7 } 
                    }
                }

                $Return[0].ST = "  ____    $( $M1[100] )      "
                $Return[1].ST = @( " /" ; $F ; "/$( $M0[98] )\" , "\___  " )
                $Return[2].ST = @( " \" , $F[1] , "/¯¯¯ " , " $T : $In " , "___/" , $F[0] , "\ " )
                $Return[3].ST = @( "  ¯¯¯\" , "\$( $M1[98] )/" ; $F[ 0 , 1 ] ; "/ " )
                $Return[4].ST = "      $( $M0[100] )    ¯¯¯¯  "

            }

            If ( $Free )
            { 

                $FX          = [ PSCustomObject ]@{ 

                    Title    = "Beginning the fight against Technological Tyranny and Cyber Criminal Activities"
                    Sign     = "$( Get-Date -UFormat "%m/%d/%Y" | % { $_.ToCharArray() } )" , "M I C H A E L  C  C O O K  S R" -join '  |  '
                    E0       = "[=]" ; E1 = "\__/" ; E2 = "| |" ; B = ( "[=]" , "\_/" )[ 0 , 1 , 0 ] -join ''
                    ST       = @( "Dynamically Engineered Digital Security" , "Application Development - Virtualization" , "Network & Hardware Magistration" , "What America Once Stood For" | % { "[ $_ ]" } ;
                                  "$Pi A Heightened Sense Of Security $Pi" ; "H Y B R I D" , "B Y" , "S E C U R E - D I G I T S - P L U S - L L C" )
                }

                0..120 | % { IEX "`$B$_ = '_' * $_ ; `$T$_ = '¯' * $_ ; `$S$_ = ' ' * $_" }
                
                $LL0 = "\$S10" ; $LL1 = "/$S10" ; $LR0 = "$S10/" ; $LR1 = "$S10\" ; $N5 = "$( "     *" * 5 )      "
                $N6  = "  *   " * 6 ; 0..1 | % { IEX "`$F$_ = '$( $F[$_] )'" } ; 1..0 | % { IEX "`$R$_ = '$( $F[$_] )'" }

                $Title        = $FX.Title | % { If ( $_.Length -gt 83 ) { "$( $_.Substring( 0 , 78 ) )..." } Else { $_ } } | % { "[ $_ ]" }

                $Rec          = $Title | % { 92 - $_.Length | % { $_ ; $_ % 2 ; ( $_ - ( $_ % 2 ) ) / 2 } }

                $NI           = $M1[$Rec[2]] , $M1[$Rec[1]] , $Title , $M1[$Rec[2]] -join ''
    
                $Return       = 0..38 | % { [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" } }
            
                $Return[0]    | % { 
    
                    $_.ST     = "  $B4" , $S4 , $B100 , $S6
                    $_.FG     = 0 , 0 , 0 , 0
                    $_.BG     = 3 , 3 , 3 , 3
                }
            
                $Return[1]    | % {
            
                    $_.ST     = " /" , $F0 , $F1 , "/$T98\" , "\___  "
                    $_.FG     = 0 , 1 , 0 , 1 , 0
                    $_.BG     = @( 3 ) * 5
                }

                $Return[2]    | % { 
            
                    $_.ST     = " \" , $F1 , "/¯¯¯" , "  $NI  " , "___/" , $F0 , "\ "
                    $_.FG     = 0 , 1 , 1 , 2 , 1 , 1 , 0
                    $_.BG     = @( 3 ) * 7
                }

                $Return[3]    | % {
                
                    $_.ST     = " /" , $F0 , "\$B98/" , $F0 , $F1 , "/ "
                    $_.FG     = 0 , 0 , 1 , 0 , 1 , 0
                    $_.BG     = @( 3 ) * 6
                }

                $Return[4]    | % {
                            
                    $_.ST     = " \" , "\   " , "$T100" , "    ¯¯\(  "
                    $_.FG     = 0 , 0 , 0 , 0
                    $_.BG     = @( 3 ) * 4
                }

                $Return[5]    | % { 
                            
                    $_.ST     = " /" , "/$S11" , $B88 , "$S11\" , "\ "
                    $_.FG     = 0 , 0 , 4 , 0 , 0
                    $_.BG     = @( 3 ) * 5
                }

                $Return[6]    | % {  
                            
                    $_.ST     = " \" , $LL0 , "//$T36]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     = 0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 5 , 7 , 7
                }

                $Return[7]    | % { 
                            
                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[$B48//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 5 , 7 , 7
                }

                $Return[8]    | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     = 0 , 0 , 4 , 5 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 4 , 7 , 7
                }

                $Return[9]    | % {

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[___"   , $FX.ST[0]  , "__//" , $LR1 , "\ "
                    $_.FG     = 0 , 0 , 4 , 5 , 5 , 5 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 4 , 4 , 4 , 7 , 7
                }

                $Return[10]   | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     = 0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 5 , 7 , 7 
                }

                $Return[11]   | % {

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[$B48//" , $LR1 , "\ "
                    $_.FG     = 0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 5 , 7 , 7 
                }

                $Return[12]   | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     = 0 , 0 , 4 , 5 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 4 , 7 , 7 
                }

                $Return[13]   | % { 

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[__"    , $FX.ST[1] , "__//" , $LR1 , "\ "
                    $_.FG     = 0 , 0 , 4 , 5 , 5 , 5 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 4 , 4 , 4 , 7 , 7 
                }

                $Return[14]   | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 5 , 7 , 7
                }

                $Return[15]   | % {

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[$B48//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 5 , 7 , 7 
                }

                $Return[16]   | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 4 , 7 , 7 
                }

                $Return[17]       | % {

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[$B7"   , $FX.ST[2] , "$B6//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 5 , 5 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 4 , 4 , 4 , 7 , 7 
                }

                $Return[18]   | % {

                    $_.ST     = " \" , $LL0 , "//  " , $FX.ST[3] , "   ]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 4 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 6 , 6 , 5 , 7 , 7
                }

                $Return[19]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B36]" , "[$B48//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 5 , 7 , 7
                }

                $Return[20]       | % {

                    $_.ST     = " \" , $LL0 , "//$T86\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7
                }
            
                $Return[21]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B32"  , $FX.B , "\__/" , $FX.B  , "$B32//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 4 , 7 , 7 
                }

                $Return[22]   | % {

                    $_.ST     = " \" , $LL0 , "//$T32"  , "| |$T16| |" , "$T32\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 5 , 7 , 7
                }

                $Return[23]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B32"  , "[=]" , $S2 , $FX.ST[5] , $S3 , "[=]" , "$B32//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 7 , 7 , 5 , 7 , 7 
                }

                $Return[24]   | % {

                    $_.ST     = " \" , $LL0 , "//$T32"  , "| |" , $T16 , "| |" , "$T32\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 4 , 7 , 7
                }

                $Return[25]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B17"  , ( $FX.B * 2 ) , $S6 , $FX.ST[6] , $S7 , ( $FX.B * 2 ) , "$B17//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 7 , 7 , 4 , 7 , 7 
                }
    
                $Return[26]   | % {

                    $_.ST     = " \" , $LL0 , "//$T17"  , "| |" , $T15 , $S6 , $T3 , $S7 , $T15 , "| |" , "$T17\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 8 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 5 , 7 , 7
                }

                $Return[27]   | % { 

                    $_.ST     = " /" , $LL1 , "\\$B17"  , "[=]" , $S1 , $FX.ST[7] , $S2 , "[=]" , "$B17//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 7 , 7 , 5 , 7 , 7
                }

                $Return[28]   | % {

                    $_.ST     = " \" , $LL0 , "//$T17"  , "\_/" , $S1 , $T43 , $S2 , "\_/" ,  "$T17\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 7 , 7 , 4 , 7 , 7
                }

                $Return[29]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B11"  , ( $FX.B * 3 ) , "[=]" , "\__/" , "[=]", ( $FX.B * 3 ) , "$B11//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 7 , 7 , 4 , 7 , 7
                }

                $Return[30]   | % {

                    $_.ST     = " \" , $LL0 , "//$T11"  , "[=]" , $T58 , "[=]" , "$T11\\" ,  $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 5 , 7 , 7
                }

                $Return[31]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B11"  , "[=]", $S2 , $FX.Sign , $S2 , "[=]" , "$B11//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 7 , 7 , 5 , 7 , 7
                }

                $Return[32]   | % {
                           
                    $_.ST     = " \" , "\$S11" , "$T13" , "¯¯  $T19     $T30  ¯¯" , "$T13" , "$S11/" , "/ "
                    $_.FG     =  0 , 0 , 4 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 7 , 7 , 7 , 7 , 7 
                }

                $Return[33]   | % {

                    $_.ST     = " /" , "/$S110\" , "\ "
                    $_.FG     = 0 , 0 , 0
                    $_.BG     = @( 3 ) * 3
                }

                $Return[34]   | % { 
                           
                    $_.ST     = " \" , "\___" + $S72 + @( 0..3 | % { "____" , "    " } ) + "___// "
                    $_.FG     = 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0
                    $_.BG     = 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7
                }

                $Return[35]   | % { 
                           
                    $_.ST     = " /" , $F0 , "\$B70/" + @( $F[ 0,1,0,1,0,1,0,1,0 ] ) + "\ "
                    $_.FG     = 0 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0
                    $_.BG     = 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7
                }

                $Return[36]   | % { 
                           
                    $_.ST     = " \" , $F1 , "/$T70\" + @( $F[ 1 , 0 ] ) * 4 + $F[1] , "/ "
                    $_.FG     = 0 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 0
                    $_.BG     = 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7
                }

                $Return[37]   | % {
                           
                    $_.ST     = "  ¯¯¯\" , "\__[ " , $FX.ST[4] , " ]$B26/" + $F * 4 + "/¯¯¯  "
                    $_.FG     = 0 , 5 , 2 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0
                    $_.BG     = 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7
                }

                $Return[38]   | % {

                    $_.ST     = "      $T72$( "    ¯¯¯¯" * 4 )      "
                    $_.FG     = 0
                    $_.BG     = 7
        
                }
            }

            If ( $Foot )
            {
                $Return = 0..18 

                $SR = "Secure Digits Plus LLC" , "Hybrid | Desired State Controller" , "Dynamically Engineered Digital Security" , "| Application Development" ,
                "Virtualization" , "Network and Hardware Magistration |" , "https://www.securedigitsplus.com" , "Server-Client" , "Seedling-Spawning Script" ,
                "[ Provisional Author : Michael C Cook Sr. | 'The Buck Stops Here' ]";
                
                $Title , $Strength , $Mark = ( 0..1 ) , ( 3..5 ) , ( 6..8 ) | % { $SR[$_] -join ' | ' }

                $101 = @( $F[1] ; $F ) ; $010 = @( $F ; $F[0] ) ; $10 = @( $F[1 , 0] )

                $Math = [ PSCustomObject ]@{
                
                    FG = @{  0 = @( 1 , 0 ) * 14
                             1 = @( @( 0 , 1 ) * 13 ; 0 )
                             2 = @( 0 ; @( 1 ) * 27 ; 0 )
                             3 = @( 2 , 1 ; @( 0 , 1 ) *  9 ; 2 )
                             4 = @( 2 , 1 ; @( 0 ) * 10 ; 1 , 2 )
                             5 = @( 2 , 1 , 0 , 4 , 0 , 1 , 2 )
                             6 = @( 2 , 0 , 4 , 0 , 2 )
                            13 = 2 , 0 , 0 , 0 , 2
                            14 = @( 2 ; @( 0 ) * 11 ; 2 )
                            15 = @( 2 ; @( 0 , 1 ) * 9 ; 0 , 2 )
                            16 = @( 0 , 2 , 1 , 2 ; @( 1 ) * 19 ; 2 , 1 , 2 , 0 )
                            17 = @( @( 1 , 0 ) * 13 ; 1 )
                            18 = @( 0 , 1 ) * 13  
                    }

                    BG = @{  0 = 28 
                             1 = 27
                             2 = 29
                             3 = 29
                             4 = 22
                             5 = 15
                             6 = 13
                            13 = 13
                            14 = 21 
                            15 = 29
                            16 = 27
                            17 = 27
                            18 = 26 }

                    ST = @{  0 = @( "        " ; @( "____" , " -- " ) * 12 ; "____" , "        " )
                             1 = @( "    ___/" ; @( $F ) * 12 ; $F[ 0 ] , "\___    " )
                             2 = @( "   /"     ; @( $F ) * 13 ; $F[ 0 ] , "\   " )
                             3 = @( "   \"     ; $10 * 13 ; $F[ 1 ] , "/   " )
                             4 = @( "   /"     ; $F  *  2 ; $F[ 0 ] , "\ " ; @( "  ¯¯¯¯  " ) * 8 ; " /" ; $F * 2 ; $F[0] , "\   " )
                             5 = @( "   \"     ; $10 *  2 ; $F[ 1 ] , "/ " , " [ $Title ] " , " \" , $F[1] ; $F * 2 ; "/   " )
                             6 = @( "   /"     ; $F * 2  ; "/¯¯¯" , "   ¯¯¯¯\__/$( $M0[47] )\__/¯¯¯   " , "¯¯¯\" ; $10 * 2 ; "\   " )
                             7 = @( "   \"     ; $101 ; "/¯¯¯" , "         __/¯¯\ ([ $( $SR[2] ) ]) /¯¯\__        " , "¯¯¯\" ; $101 ; "/   " )
                             8 = @( "   /"     ; $010 ; "\" , "  $( $M1[9] )/¯¯\__/$( $M1[9] ) $( $M1[16] ) $( $M1[20] )\__/¯¯\$( $M1[8] )  " , "/" ; $010 ; "\   " )
                             9 = @( "   \"     ; $101 ; "/" , " $Strength " , "\" ; $101 ; "/   " )
                            10 = @( "   /"     ; $010 ; "\" , "  $( $M0[25] ) $( $M0[16] ) $( $M0[35] )  " , "/" ; $010 ; "\   " )
                            11 = @( "   \"     ; $101 ; "/" , "   $Mark    " , "\" ; $101 ; "/   " )
                            12 = @( "   /"     ; $010 ; "\___" , "$( $M0[32] )   $( $M0[13] )   $( $M0[24] ) " , "___/" ; $010 ; "\   " )
                            13 = @( "   \"     ; $10  * 2 ; "\ " , "  $( $SR[9] )   " , " /" ; $F * 2 ; "/   " )
                            14 = @( "   /"     ; $F * 2 ; "/ " ; @( "  ____  " ) * 9 ; " \" ; $10 * 2 ; "\   " )
                            15 = @( "   \"     ; $10 * 13 ; $F[1] ,"/   " )
                            16 = @( "    ¯¯¯\" ; $10 * 12 ; $F[1] , "/¯¯¯    " )
                            17 = @( "        " , "¯¯¯\" , $F[1] ; $F * 11 ; "/¯¯¯" , "        " )
                            18 = @( "        " ; @( " -- " , "¯¯¯¯" ) * 12 ; "            " ) }
                }

                ForEach ( $I in 7..12 )
                { 
                    $Math.FG[$I] = 0 , 4 , 0
                    $Math.BG[$I] = 11
                }

                ForEach ( $I in 0..18 ) 
                {
                    $Return[$I] = [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" }

                    $Return[$I].FG = $( If ( $I -in 3, 14, 15 ) { 0 , 1 , 2 , 1 ; $Math.FG[$I] ; 1 , 2 , 1 , 0 }
                                        If ( $I -in     4..13 ) { 0 , 1 , 2 , 2 ; $Math.FG[$I] ; 2 , 2 , 1 , 0 }
                                        If ( $I -notin  3..15 ) { $Math.FG[$I] } )

                    $Return[$I].BG = @( 3 ) * $Math.BG[$I]
                    $Return[$I].ST = $Math.ST[$I]
                }
            }

            If ( $Array )
            {
                $Top                     = 5
                $Bottom                  = @( 6 , 5 )[ $Array.Count % 2 ]
                
                $Return                  = 0..( $Top + ( $Array.Count - 1 ) + $Bottom )

                $Return                  | % {
                
                    $Return[$_]          = [ PSCustomObject ]@{ 
                    
                        ST               = ""
                        FG               = ""
                        BG               = "" 
                    } 
                }

                $Header                  = $Title  | % { If ( $_.Length -gt 83 ) { "$( $_.Substring( 0 , 78 ) )..." } Else { $_ } } | % { "[ $_ ]" }

                $Rec                     = $Header | % { 92 - $_.Length | % { $_ ; $_ % 2 ; ( $_ - ( $_ % 2 ) ) / 2 } }

                $OP                      = $M1[$Rec[2]] , $M1[$Rec[1]] , $Header , $M1[$Rec[2]] -join ''

                $Z                       = 0

                $Return[$Z]              | % {

                    $_.ST                = "  ____    $( $M1[100] )      "
                    $_.FG                = 0
                    $_.BG                = 3
                }

                $Z ++

                $Return[$Z]              | % {
                
                    $_.ST                = @( " /" ; $F ; "/$( $M0[98] )\" , "\___  " )
                    $_.FG                = 0 , 1 , 0 , 1 , 0
                    $_.BG                = @( 3 ) * 5
                }

                $Z ++

                $Return[$Z]              | % {

                    $_.ST                = " \" , $F[1] , "/¯¯¯  " , $OP , "  ___/" , $F[0] , "\ "
                    $_.FG                = 0 , 1 , 1 , 2 , 1 , 1 , 0
                    $_.BG                = @( 3 ) * 7
                }

                $Z ++

                $Return[$Z]              | % { 
                
                    $_.ST                = @( " //¯¯\" , "\$( $M1[98] )/" ; $F ; "/ " )
                    $_.FG                = 0 , 1 , 0 , 1 , 0
                    $_.BG                = @( 3 ) * 5
                }

                $Z ++

                $Return[$Z]              | % { 

                    $_.ST                = " \\   $( $M0[100] )    ¯¯\(  "
                    $_.FG                = 0
                    $_.BG                = 3
                }

                $Z ++

                ForEach ( $I in 0..( $Array.Count - 1 ) )
                {
                    $Line                = $Array[$I] | % { If ( $_.Length -gt 108 ) { "$( $_.Substring( 0 , 105 ) )..." } Else { $_ } }

                    $Rec                 = $Line | % { 108 - $_.Length | % { $_ ; $_ % 2 ; ( $_ - ( $_ % 2 ) ) / 2 } }

                    $OP                  = $M2[$Rec[2]] , $M2[$Rec[1]] , $Line , $M2[$Rec[2]] -join ''

                    $Return[$Z]          | % { 

                        $_.ST            = $L[ $Z % 2 ] , $OP , $R[ $Z % 2 ]
                        $_.FG            = 0 , 2 , 0 
                        $_.BG            = @( 3 ) * 3
                    }

                    $Z++
                }

                If ( $Z % 2 -ne 0 ) 
                { 
                    $Return[$Z]          | % {
                    
                        $_.ST            = " // " , $M2[108] , " \\ "
                        $_.FG            = @( 0 ) * 3
                        $_.BG            = @( 3 ) * 3 
                    }

                    $Z  ++ 
                }

                $Return[$Z]              | % {

                    $_.ST                = @( " \\___" ; $M2[72] ; @( "____" , "    " ) * 4 ; "___// " )
                    $_.FG                = @( 0 ) * 11
                    $_.BG                = @( 3 ) * 11
                }

                $Z  ++

                $Return[$Z]              | % { 

                    $_.ST                = @( " /" , $F[0] , "\$( $M1[70] )/" ; $F * 4 ; $F[0] , "\ " )
                    $_.FG                = @( @( 0 , 1 ) *  6 ; 0 )
                    $_.BG                = @( 3 ) * 13
                }
                
                $Z  ++

                $Return[$Z]              | % { 

                    $_.ST                = @( " \" , $F[1] , "/$( $M0[70] )\" ; @( $F[ 1 , 0 ] ) * 4 ; $F[1] , "/ " )
                    $_.FG                = @( 0 ; @( 1 ) * 11 ; 0 )
                    $_.BG                = @( 3 ) * 13
                }

                $Z  ++

               If ( ! $Prompt ) 
               { 

                    $Return[$Z]          | % {
                        
                        $_.ST            = @( "  ¯¯¯\" , "\$( $M1[70] )/" ; $F * 4 ; "/¯¯¯  " )
                        $_.FG            = @( 0 ; @( 1 , 0 ) * 6 )
                        $_.BG            = @( 3 ) * 13
                    }

                    $Z  ++
                }

                If ( $Prompt )
                {
                    $P = $Prompt | % { 

                        If ( $_.Length -gt 63 ) { "$( $_.Substring( 0 , 59 ) )..." , " ]__/"    } 
                        Else                    { " $_ " , "]$( $M1[ ( 61 - $_.Length ) ] )__/" }
                    }

                    $Return[$Z]          | % { 

                        $_.ST            = @( "  ¯¯¯\" , "\__[ " ; $P ; $F * 4 ; "/¯¯¯  " )
                        $_.FG            = @( 0 , 1 , 2 ; @( 1 , 0 ) * 6 )
                        $_.BG            = @( 3 ) * 13
                    }

                    $Z ++
                }

                $Return[$Z] | % {

                    $_.ST = "      $( $M0[72] )$( "    ¯¯¯¯" * 4 )      "
                    $_.FG = 0
                    $_.BG = 3
                }
            }

            If ( $Table )
            {
                $C                       = 0

                $List                    = [ PSCustomObject ]@{ 
                
                      Class              = @{ Name = $Table | GM | ? { $_.Name -like   "*Class*" } | % { $_.Name } ; Items = @( ) }
                      ID                 = @{ Name = $Table | GM | ? { $_.Name -like      "*ID*" } | % { $_.Name } ; Items = @( ) }
                      Section            = @{ Name = $Table | GM | ? { $_.Name -like "*Section*" } | % { $_.Name } ; Items = @( ) } 
                }

                # Determine Count
                
                $List.Class.Name         | % { $List.Class.Items   += $Table.$_ }
                $List.ID.Name            | % { $List.ID.Items      += $Table.$_ }
                $List.Section.Name       | % { $List.Section.Items += $Table.$_ }

                $List.Class.Items        | % { $C = $C + 5 }
                $List.Section.Name       | % { $C = $C + 3 }
                $List.Section.Items.Keys | % { $C ++       }

                $C                       = $C + $( If ( $C % 2 -ne 0 ) { 5 } Else { 4 } ) # End Section
                
                $Return                  = 0..$C

                0..$C                    | % { $Return[$_] = [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" } }

                $Title                   = $List.Class.Items | % { If ( $_.Length -gt 83 ) { "$( $_.Substring( 0 , 78 ) )..." } Else { $_ } } | % { "[ $_ ]" }

                $Recurse                 = $Title | % { 92 - $_.Length | % { $_ ; $_ % 2 ; ( $_ - ( $_ % 2 ) ) / 2 } }

                $Output                  = $M1[$Recurse[2]] , $M1[$Recurse[1]] , $Title , $M1[$Recurse[2]] -join ''

                $Z                       = 0

                $Return[$Z]              | % { 

                    $_.ST                = "  ____    $( $M1[100] )      "
                    $_.FG                = 0
                    $_.BG                = 3
                }

                $Z ++

                $Return[$Z]              | % { 
                
                    $_.ST                = @( " /" ; $F ; "/$( $M0[98] )\" , "\___  " )
                    $_.FG                = 0 , 1 , 0 , 1 , 0
                    $_.BG                = @( 3 ) * 5
                }

                $Z ++

                $Return[$Z]              | % { 

                    $_.ST                = " \" , $F[1] , "/¯¯¯  " , $Output , "  ___/" , $F[0] , "\ "
                    $_.FG                = 0 , 1 , 1 , 2 , 1 , 1 , 0
                    $_.BG                = @( 3 ) * 7
                }

                $Z ++

                $Return[$Z]              | % { 
                
                    $_.ST                = @( " //¯¯\" , "\$( $M1[98] )/" ; $F ; "/ " )
                    $_.FG                = 0 , 1 , 0 , 1 , 0
                    $_.BG                = @( 3 ) * 5
                }

                $Z ++

                $Return[$Z]              | % { 

                    $_.ST                = " \\   $( $M0[100] )    ¯¯\(  "
                    $_.FG                = 0
                    $_.BG                = 3
                }

                $Z ++

                $Count                   = $( $List.ID.Items.Count - 1 | % { If ( $_ -gt 0 ) { 0..$_ } Else { 0 } } )

                ForEach ( $Y in $Count )
                { 
                    If ( $Count.Length -gt 1 )
                    {
                        $Index           = $List.ID.Items[$Y]
                        $Section         = $List.Section.Items[$Y]
                    }
                        
                    Else
                    {
                        $Index           = $List.ID.Items
                        $Section         = $List.Section.Items
                    }

                    $IDX                 = $( If ( $Index.Length -gt 93 ) { "$( $Index[ 0..93 ] -join '' ) ... " } Else { $Index } )

                    $Return[$Z]          | % {

                        $_.ST            = $L[ $Z % 2 ] , $M1[ 108 ] , $R[ $Z % 2 ]
                        $_.FG            = @( 0 ) * 3
                        $_.BG            = @( 3 ) * 3
                    }

                    $Z ++

                    $Return[$Z]          | % {

                        $_.ST            = $L[ $Z % 2 ] , $M3[  10 ] , $IDX , $M3[ ( 98 - $IDX.Length ) ] , $R[ $Z % 2 ]
                        $_.FG            = 0 , 1 , 2 , 1 , 0
                        $_.BG            = @( 3 ) * 5
                    }

                    $Z ++

                    $Return[$Z]          | % {

                        $_.ST            = $L[ $Z % 2 ] , $M0[ 108 ] , $R[ $Z % 2 ]
                        $_.FG            = @( 0 ) * 3
                        $_.BG            = @( 3 ) * 3
                    }

                    $Z ++
                        
                    $Keys                = @( $Section.Keys   )
                    $Values              = @( $Section.Values )

                    ForEach ( $k in 0..( $Keys.Count - 1 ) ) # Determines distance and overflow handling for all provided names and values
                    {   
                        $RV              = $Values[$K]

                        If ( $RV.ID.Length    -gt 20 ) { $ID = "$( $RV.ID[0..20] -join '' ) ..."                    }      
                        Else                           { $ID = "$( $M2[ ( 25 - $RV.ID.Length ) ] )$( $RV.ID )"      }

                        If ( $RV.Value.Length -gt 75 ) { $VA = "$( $RV.Value[ 0..75 ] -join '' ) ..."               } 
                        Else                           { $VA = "$( $RV.Value )$( $M2[ ( 80 - $RV.Value.Length ) ])" }

                        $Return[$Z]      | % {

                            $_.ST        = $L[ $Z % 2 ] , $ID , " : " , $VA , $R[ $Z % 2 ]
                            $_.FG        = 0 , 2 , 1 , 2 , 0 
                            $_.BG        = @( 3 ) * 5
                        }
                        
                        $Z ++
                    }
                }

                If ( $Z % 2 -ne 0 ) 
                { 
                    $Return[$Z]          | % {
                    
                        $_.ST            = " // " , $M2[108] , " \\ "
                        $_.FG            = @( 0 ) * 3
                        $_.BG            = @( 3 ) * 3 
                    }

                    $Z  ++ 
                }
                    
                $Return[$Z]              | % {

                    $_.ST                = @( " \\___" ; $M2[72] ; @( "____" , "    " ) * 4 ; "___// " )
                    $_.FG                = @( 0 ) * 11
                    $_.BG                = @( 3 ) * 11
                }

                $Z  ++

                $Return[$Z]              | % { 

                    $_.ST                = @( " /" , $F[0] , "\$( $M1[70] )/" ; $F * 4 ; $F[0] , "\ " )
                    $_.FG                = @( @( 0 , 1 ) *  6 ; 0 )
                    $_.BG                = @( 3 ) * 13
                }
                
                $Z  ++

                $Return[$Z]              | % { 

                    $_.ST                = @( " \" , $F[1] , "/$( $M0[70] )\" ; @( $F[ 1 , 0 ] ) * 4 ; $F[1] , "/ " )
                    $_.FG                = @( 0 ; @( 1 ) * 11 ; 0 )
                    $_.BG                = @( 3 ) * 13
                }

                $Z  ++

                If ( ! $Prompt ) 
                { 

                    $Return[$Z]          | % {
                        
                        $_.ST            = @( "  ¯¯¯\" , "\$( $M1[70] )/" ; $F * 4 ; "/¯¯¯  " )
                        $_.FG            = @( 0 ; @( 1 , 0 ) * 6 )
                        $_.BG            = @( 3 ) * 13
                    }

                    $Z  ++
                }

                If ( $Prompt )
                {
                    $P = $Prompt | % { 

                        If ( $_.Length -gt 63 ) { "$( $_.Substring( 0 , 59 ) )..." , " ]__/"    } 
                        Else                    { " $_ " , "]$( $M1[ ( 61 - $_.Length ) ] )__/" }
                    }

                    $Return[$Z]          | % { 

                        $_.ST            = @( "  ¯¯¯\" , "\__[ " ; $P ; $F * 4 ; "/¯¯¯  " )
                        $_.FG            = @( 0 , 1 , 2 ; @( 1 , 0 ) * 6 )
                        $_.BG            = @( 3 ) * 13
                    }

                    $Z ++
                }

                $Return[$Z] | % {

                    $_.ST = "      $( $M0[72] )$( "    ¯¯¯¯" * 4 )      "
                    $_.FG = 0
                    $_.BG = 3
                }
            }
        }

        End
        {
            ForEach ( $i in 0..( $Return.Count - 1 ) )
            {
                $Return[$I] | % {

                    If ( $_.ST.Count -lt 1 ) 
                    {
                        Write-Warning -Message "Value is null, or 0"    
                    }

                    If ( $_.ST.Count -eq 1 )
                    {
                        $Splat = @{ 

                            Object     =     $_.ST
                            Foreground = $GX[$_.FG]
                            Background = $GX[$_.BG]
                            NoNewLine  = $False
                        }

                        Write-Host @Splat
                    }

                    If ( $_.ST.Count -gt 1 )
                    {
                        ForEach ( $X in 0..( $_.ST.Count - 1 ) )
                        {
                            $Splat = @{ 
                                    
                                Object     =     $_.ST[$X]
                                Foreground = $GX[$_.FG[$X]]
                                Background = $GX[$_.BG[$X]]
                                NoNewLine  =        $True
                            }

                            If ( $X -eq $_.ST.Count - 1 )
                            {
                                $Splat.NoNewLine = $False
                            }

                            Write-Host @Splat
                        }
                    }
                }
            }

            If ( $Prompt )
            {
                Read-Host ( "¯" * 116 ) | % { If ( $_ -eq "" ) { $True } If ( $_ -ne "" ) { $False } }
            }
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Convert-XAMLToWindow # Modified, originally by Dr. Tobias Weltner  _________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Param ( [ Parameter ( Mandatory ) ] [ String ] $XAML , [ String [] ] $NE = $Null , [ Switch ] $PassThru )

        @( "Framework" , "Core" | % { "Presentation$_" } ) + "WindowsBase" | % { Add-Type -AssemblyName $_ }
 
        $NR = [ XML.XMLReader ]::Create( [ IO.StringReader ] $XAML ) ; $OP = [ Windows.Markup.XAMLReader ]::Load( $NR )
        
        $NE | % { $OP | Add-Member -MemberType NoteProperty -Name $_ -Value $OP.FindName( $_ ) -Force }
 
        If ( $PassThru ) { $OP } Else { $Null = $GUI.Dispatcher.InvokeAsync( { $OP = $GUI.ShowDialog() ; SV -Name OP -Value $OP -Scope 1 } ).Wait() ; $OP }

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Show-WPFWindow # Modified, originally by Dr. Tobias Weltner ________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Param ( [ Parameter ( Mandatory ) ] [ Windows.Window ] $GUI )

        $OP = $Null ; $Null = $GUI.Dispatcher.InvokeAsync( { $OP = $GUI.ShowDialog() ; SV -Name OP -Value $OP -Scope 1 } ).Wait() ; $OP 
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Find-XAMLNamedElements # Returns named items in a XAML HereString __________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] [ OutputType ( "Array" ) ] Param (

            [ Parameter ( Mandatory = $True , Position = 0 , HelpMessage = "XAML Here String" ) ] [ String ] $XAML )

        $Xaml = $Xaml.Replace( '"' , "'" )
        
        $Array = $Xaml.Split( "`n" )

        $Collect = @( )

        0..( $Array.Count - 1 ) | ? { $Array[$_] -like "* Name = *" } | % {
    
            $Line = $Array[$_].Split(' ') | ? { $_.Length -ne 0 } 

            $Collect += $Line[( 0..( $Line.Count - 1 ) | ? { $Line[$_] -eq "Name" } ) + 2 ] 
        }

        $Return = 0..( $Collect.Count - 1 ) | % { 
        
            $Collect[$_].Replace( "'" , '' ) 
        }

        Return $Return                                                               #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-LineDepth # Returns Distance/Spacing for Clean XAML Formatting _________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Mandatory , ValueFromPipeline ) ] [ String ] $Object )

        $Array     = @( $Object.Split( "`n" ) )
        $Return    = @( 0..( $Array.Count - 1 ) )

        ForEach ( $I in $Return )
        {
            $Parse  = [ PSCustomObject ]@{

                Line    = @( $Array[$I].ToCharArray() )
                Space   = 0
                Factor  = 0
                Remain  = 0
                Content = @( )
            }

            ForEach ( $J in $Parse.Line )
            {
                If ( $Parse.Content.Count -eq 0 )
                {
                    If ( $J -ne " " )
                    {
                        $Parse.Content += $J
                    }

                    Else
                    {
                        $Parse.Space ++
                    }
                }

                Else
                {
                    $Parse.Content += $J
                }
            }

            $Parse | % { 
        
                $_.Remain = $_.Space % 4
                $_.Factor = $( 
            
                    If ( $_.Remain -ne 0 ) 
                    {
                        ( $_.Space - $_.Remain ) / 4
                    }

                    Else
                    {
                        $_.Space / 4
                    }
                )
                $_.Content = $_.Content -join ''
            }

            $Return[$I] = $Parse
        }

        $X = 0..( $Return.Count - 1 )
        $Y = 0..( $Return.Count - 1 ) 

        0..( $Return.Count - 1 ) | % { 

            $X[$_] = $Return[$_].Factor
            $Y[$_] = $( 
    
                If ( $Return[$_].Remain -ne 0 )
                {
                    ( " " * $Return[$_].Remain ) + $Return[$_].Content
                }

                Else
                {
                    $Return[$_].Content
                }
            )
        }

        [ PSCustomObject ]@{

            X = $X -join ','
            Y = ( $Y.Replace( '"' , "'" ) | % { '"' + $_ + '"' } )
        }
    }


    #Get-LineDepth -Object @"
    #"@ | % { $X = $_.X ; $Y = $_.Y } 

    #$M = 0..3 | % { $X = @( '¯' , '_' , ' ' , '-' )[$_] ; IEX "`$M$_ = [ PSCustomObject ]@{ Char = '$X' };" }

    #ForEach ( $I in $M0 , $M1 , $M2 , $M3 )  
    #{
    #    0..120   | % { 
        
    #        $Value = ( $I.Char * $_ ) -join ''

    #        $I   | Add-Member -MemberType NoteProperty -Name $_ -Value $Value 
    #    }
    #}
#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
  Function Confirm-DomainName # Verifies that text entries are valid _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] [ OutputType ( "String" ) ] Param (

            [ Parameter ( Mandatory = $True , ParameterSetName = "0" ) ][ String ] $NetBIOS  ,
            [ Parameter ( Mandatory = $True , ParameterSetName = "1" ) ][ String ] $Domain   ,
            [ Parameter ( Mandatory = $True , ParameterSetName = "2" ) ][ String ] $SiteName )

        $C              = "abcdefghijklmnopqrstuvwxyz" , "0123456789" , ".-" , "``~!@#$%^&*()=+_[]{}\|;:'`",<>/? "
        $I              = $C -join ''

        $Alpha          = $I[ 0..25]
        $Numeric        = $I[26..35] + 0..9
        $Split          = $I[36..37]
        $Special        = $I[38..68] 
        $AN             = $I[ 0..35] + 0..9

        $Reserved       = @{ 
            
            Words       = @( "ANONYMOUS,AUTHENTICATED USER,BATCH,BUILTIN,DIALUP,DIGEST AUTH,INTERACTIVE,INTERNET,NT AUTHORITY,NT DOMAIN" ,
                             "NTLM AUTH,NULL,PROXY,REMOTE INTERACTIVE,RESTRICTED,SCHANNEL AUTH,SELF,SERVER,SERVICE,SYSTEM,TERMINAL SERVER"
                             "THIS ORGANIZATION,USERS,WORLD" ; "LOCAL" | % { $_ , "$_ SYSTEM"  } ; "NETWORK" | % { $_ , "$_ SERVICE" } ; 
                             "GROUP" , "OWNER" | % { $_ , "$_ SERVER" } | % { "CREATOR $_" } ) -join ',' | % { $_.Split( ',' ) } | Sort

            DNSHost     = "-GATEWAY" , "-GW" , "-TAC" <# RFC 952 #>

            SDDL        = "AN,AO,AU,BA,BG,BO,BU,CA,CD,CG,CO,DA,DC,DD,DG,DU,EA,ED,HI,IU,LA,LG,LS,LW,ME,MU,NO,NS,NU,PA,PO,PS,PU,RC,RD" +
                          "RE,RO,RS,RU,SA,SI,SO,SU,SY,WD" | % { $_.Split( ',' ) }
        }

        If ( $NetBIOS  ) 
        { 
            $X          = $NetBIOS

            $Y          = [ PSCustomObject ]@{ 
            
                Min     = 1
                Max     = 15
                Reserve = $Reserved.Words
                Allow   = $I[0..37]
                Deny    = $Special 
            } 
        }

        If ( $Domain ) 
        { 
            $X          = $Domain 
            
            $Y          = [ PSCustomObject ]@{ 
            
                Min     = 2
                Max     = 63
                Reserve = $Reserved.Words
                Allow   = $I[0..37]
                Deny    = $Special 
            } 
        }

        If ( $SiteName ) 
        { 
            $X          = $SiteName
            $Y          = [ PSCustomObject ]@{ 
            
                Min     = 1 
                Max     = 63
                Reserve = $Reserved.Words
                Allow   = $I[0..37]
                Deny    = $Special 
            } 
        }

        If ( $X.Length -lt $Y.Min )
        { 
            "Name is too short" 
        }

        ElseIf ( $X.Length -gt $Y.Max )
        { 
            "Name is too long"
        }

        ElseIf ( ( $X[0..$X[-1]] | ? { $_ -in $Y.Deny } ).Count -gt 0 )
        { 
            "Name has invalid characters"
        }

        Else { }

        If ( $NetBIOS )
        {
            
            
            If ( "." -in $X )
            { 
                "Period found in NetBIOS Domain Name, breaking" 
            }

            ElseIf ( $X -in $Y.Reserve )
            { 
                "Name is reserved" 
            }

            Else { $X }
        }
            
        If ( ( $X[0] -notin $AN ) -or ( $X[-1] -notin $AN ) -eq $True )  
        { 
            "First & Last Character must be Alpha-Numeric" 
        }

        If ( $Domain )
        {
            If ( ( $X.Length -eq 2 ) -and ( $X -in $Reserved.SDDL ) )
            { 
                "Name is reserved" 
            }

            ElseIf ( $X.Split('.').Count -lt 2 )
            {
                "Not a valid domain name, single label domain names are disabled"
            }

            ElseIf ( ( $X.Split('.')[-1].ToCharArray() | ? { $_ -in $Alpha } ).Count -eq 0 )
            {
                "Top Level Domain must contain a non-numeric."   
            }

            Else { $X }
        }
            
        If ( $SiteName )
        {
            $X
        }                                                                             #____    ____    ____    ____    ____    ____    ____    ____      
}#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DSCFeatureList # Collects all server features that pertain to DSC _______//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( [ Parameter ( Position = 0 ) ] [ Switch ] $Underscore )
                        
        $Echo = @( "AD-Domain-Services" , "DHCP" , "DNS" , "GPMC" ; @( "" ; "-AdminCenter" , "-PowerShell" , "-Tools" | % { "-AD$_" } ; 
                   "" , "-Tools" | % { "-ADDS$_" } ; "-DHCP" , "-DNS-Server" , "-Role-Tools" ) | % { "RSAT$_" } ;
                   "" , "-AdminPack" , "-Deployment" , "-Transport"  | % { "WDS$_" } )

        If ( $Underscore ) 
        { 
            $Echo = $Echo.Replace( '-' , '_' ) 
        } 
        
        Return $Echo                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DSCFeatureState # Determines Installation Loadout _______________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( [ Parameter () ][ Switch ] $All )

        $Services = Get-DSCFeatureList
        
        $GWF      = Get-WindowsFeature

        $Array    = @( ) 
        
        $Table    = [ Ordered ]@{ Installed = @( ) ; Available = @( ) }



        ForEach ( $I in $Services ) 
        { 
            $X = $GWF | ? { $_.Name -eq $I } | % { 
            
            If ( $_.InstallState -ne "Installed" ) 
            { 
                $Array           += "$I [_]" 
                $Table.Available += "$I [_]" 
            }

            If ( $_.InstallState -eq "Installed" ) 
            { 
                $Array           += "$I [X]"
                $Table.Installed += "$I [X]" 
            } 
        } 
    }

    Return $( If ( !$All ) { $Table } If ( $All ) { $Array } )     
                                                                                      #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DSCPromoTable # _________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position = 0 , ParameterSetName =      "All" ) ][ Switch ] $All        ,
            [ Parameter ( Position = 0 , ParameterSetName =  "Command" ) ][ Switch ] $Command    ,
            [ Parameter ( Position = 0 , ParameterSetName =  "Process" ) ][ Switch ] $Process    ,
            [ Parameter ( Position = 0 , ParameterSetName =     "Menu" ) ][ Switch ] $Menu       ,
            [ Parameter ( Position = 0 , ParameterSetName =     "Type" ) ][ Switch ] $DomainType ,
            [ Parameter ( Position = 0 , ParameterSetName =      "Top" ) ][ Switch ] $Mode        ,
            [ Parameter ( Position = 0 , ParameterSetName = "Services" ) ][ Switch ] $Services   ,
            [ Parameter ( Position = 0 , ParameterSetName =    "Roles" ) ][ Switch ] $Roles      ,
            [ Parameter ( Position = 0 , ParameterSetName =    "Paths" ) ][ Switch ] $Paths      ,
            [ Parameter ( Position = 0 , ParameterSetName =   "Domain" ) ][ Switch ] $Domain     )
        
        $Table = [ Ordered ]@{ 

            Command    = @( "Forest" ; "" , "" , "Controller" | % { "Domain$_" } ) | % { "Install-ADDS$_" }
            Process    = 0..3
            Menu       =     "Forest" ,       "Tree" ,       "Child" , "Clone"
            DomainType =          "-" , "TreeDomain" , "ChildDomain" ,     "-"
            Mode       = "ForestMode" , "DomainMode" , "ParentDomainName"
            Services   = Get-DSCFeatureList -Underscore
            Roles      = "InstallDNS" , "CreateDNSDelegation" , "NoGlobalCatalog" , "CriticalReplicationOnly"
            Paths      = "Database" ,  "Log" , "Sysvol" | % { "$_`Path" }
            Domain     = @( "Credential" ; "Domain" | % { $_ , "New$_" } | % { $_ , "$_`NetBIOS" } | % { "$_`Name" } ; "ReplicationSourceDC" , "SiteName" )
            Buttons    = "Start" , "Cancel" , "CredentialButton" 
        }

        $Table | % { Return $( If ( $All        ) { $_          } If ( $Command    ) { $_.Command    } If ( $Process    ) { $_.Process  }
                               If ( $Menu       ) { $_.Menu     } If ( $DomainType ) { $_.DomainType } If ( $Mode       ) { $_.Mode     }
                               If ( $Services   ) { $_.Services } If ( $Roles      ) { $_.Roles      } If ( $Paths      ) { $_.Paths    }
                               If ( $Domain     ) { $_.Domain   } ) }                #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DSCPromoSelection # ____________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] [ OutputType ( "PSCustomObject" ) ]  Param ( [ ValidateSet ( 0 , 1 , 2 , 3 ) ]
        
            [ Parameter ( Mandatory = $True , ValueFromPipeline = $True , Position = 0 ) ][            Int ] $Type = 0 ,
            [ Parameter ( Mandatory = $True , ValueFromPipeline = $True , Position = 1 ) ][ PSCustomObject ] $Control  ,
            [ Parameter ( Mandatory = $True , ValueFromPipeline = $True , Position = 2 ) ][      String [] ] $Services ,
            [ Parameter ( Mandatory = $True , ValueFromPipeline = $True , Position = 3 ) ][ Windows.Window ] $GUI      )

            $P                            = $Type
            $B                            = $False , $True
            $Code                         = $Control
            $Return                       = @( )
        # ______________________________________________________________________________ #
        # Command
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Code.Command                 = ( Get-DSCPromoTable    -Command )[$P]
        # ______________________________________________________________________________ #
        # Process
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Code.Process                 = ( Get-DSCPromoTable    -Process )[$P]
        # ______________________________________________________________________________ #
        # Menu
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        =   Get-DSCPromoTable       -Menu
            $Switch                       = @{ 0 = 1,0,0,0 ; 1 = 0,1,0,0 ; 2 = 0,0,1,0 ; 3 = 0,0,0,1 }

            $X                            = $Switch[$P]
                
                0..( $Names.Count - 1 )   | % {  
                    
                    $Y                    = $Names[$_]

                    If ( $X[$_] -eq 0 ) 
                    { 
                        $Code.$Y          = "-" 
                        $GUI.$Y           | % { $_.IsChecked  = $False }
                    }

                    If ( $X[$_] -eq 1 ) 
                    { 
                        $Code.$Y          = "Selected"
                        $GUI.$Y           | % { $_.IsChecked  = $True  }
                    }
                }
        # ______________________________________________________________________________ #
        # Domain Type
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Code.DomainType              = ( Get-DSCPromoTable -DomainType )[$P]
        # ______________________________________________________________________________ #
        # Mode
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Mode
            $Switch                       = @{ 0 = 1,1,0 ; 1 = 0,1,1 ; 2 = 0,1,1  ; 3 = 0,0,0 }
        
            $X                            = $Switch[$P]
            
                0..( $Names.Count - 1 )   | % { 

                    $Y                    = $Names[$_]

                    If ( $Y -eq $Names[2] ) 
                    { 
                        $GUI.$Y           | % { $_.Text = '' }
                    }

                    If ( $X[$_] -eq 0 )
                    { 
                        $Code.$Y          = '-' 
                        $GUI."$Y`Box"     | % { $_.Visibility = "Collapsed" }
                    }
                    
                    If ( $X[$_] -eq 1 )
                    { 
                        $Code.$Y          = '' 
                        $GUI."$Y`Box"     | % { $_.Visibility = "Visible"   }
                        $Return          += $Y
                    }
                }
        # ______________________________________________________________________________ #
        # Services
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Services
            $Switch                       = 0..16 | % { $Services[$_][-2] } | % { If ( $_ -eq "X" ) { 0 } Else { 1 } }
            
                0..( $Names.Count - 1 )   | % { 

                    $X , $Y               = $Switch[$_] , $Names[$_]

                    $GUI.$Y               | % { $_.IsEnabled = $False ; $_.IsChecked = $True }

                    If ( $X -eq 0 ) 
                    { 
                        $Code.$Y          = 'Installed' 
                    }

                    If ( $X -eq 1 ) 
                    { 
                        $Code.$Y          = 'Available'
                        $GUI.$Y           | % { $_.IsEnabled = $True }
                    }

                }
        # ______________________________________________________________________________ #
        # Roles
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Roles
            $Switch                       = @{ 0 = 1,1,0,0 ; 1 = 1,1,1,0 ; 2 = 1,1,1,0 ; 3 = 1,1,1,1 }
            $Default                      = @{ 0 = 1,0,0,0 ; 1 = 1,0,0,0 ; 2 = 1,1,0,0 ; 3 = 1,0,0,0 }
            
            $X                            = $Switch[$P]
            $Y                            = $Default[$P]

                ForEach ( $Z in 0..( $Names.Count - 1 ) )
                {
                    $Item                 = $Names[$Z]

                    If ( $X[$Z] -eq 0 ) 
                    { 
                        $Code.$Item       = '-'
                        $GUI.$Item        | % { $_.IsEnabled = $False ; $_.IsChecked = $False }
                    }

                    If ( $X[$Z] -eq 1 ) 
                    { 
                        $Code.$Item       = 1
                        $GUI.$Item        | % { $_.IsEnabled =  $True ; $_.IsChecked = $B[$Y][$Z] }
                        $Return          += $Item
                    }
                }
        # ______________________________________________________________________________ #
        # Paths
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Paths
            $Default                      = "NTDS" , "NTDS" , "SYSVOL" | % { "C:\Windows\$_" }
            
                0..( $Names.Count - 1 )   | % { 

                    $Y                    = $Names[$_]
                    $Code.$Y              = $Default[$_]
                    $GUI.$Y.Text          = $Default[$_]
                }
        # ______________________________________________________________________________ #
        # Domain
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Domain
            $Switch                       = @{ 0 = 0,1,1,0,0,0,0 ; 1 = 1,0,0,1,1,0,1 ; 2 = 1,0,0,1,1,0,1 ; 3 = 1,1,0,0,0,1,1 }
            
            $X                            = $Switch[$P]

                0..( $Names.Count - 1 )   | % { 
                    
                    $Y                    = $Names[$_]
                    $GUI.$Y               | % { $_.Text = "" }

                    If ( $X[$_] -eq 0 )
                    { 
                        $Code.$Y          = '-'
                        $GUI."$Y`Box"     | % { $_.Visibility = "Collapsed" }
                    }

                    If ( $X[$_] -eq 1 ) 
                    { 
                        $Code.$Y          = ''
                        $GUI."$Y`Box"     | % { $_.Visibility =   "Visible" }
                        $Return          += $Y
                    }
                }
        # ______________________________________________________________________________ #
        # DSRM
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            "Credential" | % {
                
                $GUI.$_                   | % { 
                
                    $_.IsEnabled          = $False
                    $_.Text               = "" 
                }
                
                If ( $P -ne 0 ) 
                {
                    $Code.$_              = ""
                }

                Else 
                { 
                    $Code.$_              = "N/A"
                }

                $Return                  += "SafeModeAdministratorPassword"
            
            }

            $Code.Profile                 = $Return 

            Return [ PSCustomObject ]@{ 
            
                Code                      = $Code
                Window                    = $GUI
            }                                                                        #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-DomainController # Launches Hybrid-DSCPromo _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        
        Write-Theme -Action "Searching [~]" "For Valid Domain Controllers"
        
        $Report                           = Start-NetworkInfo -All

        $ST                               = Get-DSCFeatureState -All

        Write-Theme -Action "Loading [~]" "Active Directory Configuration Utility"

        $P                                = 0
        $Promo                            = Get-XAML -HybridDSCPromo   
        $Named                            = Find-XAMLNamedElements -XAML $Promo 
        $GUI                              = Convert-XAMLToWindow   -XAML $Promo -NE $Named -PassThru
        $Code                             = [ PSCustomObject ]@{ 
        
        Command     = "" ; Process     = "" ; Forest      = "" ; Tree        = "" ; Child       = "" ; Clone       = "" ; 
        
        DomainType  = "" ; ForestMode  = "" ; DomainMode  = "" ; ParentDomainName               = "" ;
        
        AD_Domain_Services             = "" ; DHCP        = "" ; DNS         = "" ; GPMC        = "" ; RSAT        = "" ; 
        RSAT_AD_AdminCenter            = "" ; RSAT_AD_PowerShell             = "" ; RSAT_AD_Tools                  = "" ; 
        RSAT_ADDS                      = "" ; RSAT_ADDS_Tools                = "" ; RSAT_DHCP                      = "" ; 
        RSAT_DNS_Server                = "" ; RSAT_Role_Tools                = "" ; WDS                            = "" ; 
        WDS_AdminPack                  = "" ; WDS_Deployment                 = "" ; WDS_Transport                  = "" ;
        
        InstallDNS                     = "" ; CreateDNSDelegation            = "" ; 
        NoGlobalCatalog                = "" ; CriticalReplicationOnly        = "" ;
        
        DatabasePath                   = "" ; LogPath     = "" ; SysvolPath  = "" ;
        
        Credential  = "" ; DomainName  = "" ; DomainNetBIOSName              = "" ; NewDomainName                  = "" ; 
        NewDomainNetBIOSName           = "" ; SiteName                       = "" ; ReplicationSourceDC            = "" ; 
        
        SafeModeAdministratorPassword  = "" ; Profile                        = "" }

        Get-DSCPromoSelection -Type $P -Control $Code -Services $ST -GUI $GUI | % { 
        
            $Code      = $_.Code
            $GUI       = $_.Window
            
            $GUI.Forest.IsChecked = $True

            "Tree" , "Child" , "Clone" | % { $GUI.$_.IsChecked = $False }
        }

        $GUI.Forest.Add_Click{ 

            Get-DSCPromoSelection -Type 0 -Control $Code -Services $ST -GUI $GUI | % { 
        
                $Code      = $_.Code
                $GUI       = $_.Window
            }

            $GUI.Forest.IsChecked = $True

            "Tree" , "Child" , "Clone" | % { $GUI.$_.IsChecked = $False }
        }

        $GUI.Tree.Add_Click{ 

            Get-DSCPromoSelection -Type 1 -Control $Code -Services $ST -GUI $GUI | % { 
        
                $Code      = $_.Code
                $GUI       = $_.Window
            }

            $GUI.Tree.IsChecked = $True

            "Forest" , "Child" , "Clone" | % { $GUI.$_.IsChecked = $False }
        }

        $GUI.Child.Add_Click{ 

            Get-DSCPromoSelection -Type 2 -Control $Code -Services $ST -GUI $GUI | % { 
        
                $Code      = $_.Code
                $GUI       = $_.Window
            }

            $GUI.Child.IsChecked = $True

            "Forest" , "Tree" , "Clone" | % { $GUI.$_.IsChecked = $False }
        }

        $GUI.Clone.Add_Click{ 

            Get-DSCPromoSelection -Type 3 -Control $Code -Services $ST -GUI $GUI | % { 
        
                $Code      = $_.Code
                $GUI       = $_.Window
            }

            $GUI.Clone.IsChecked = $True

            "Forest" , "Tree" , "Child" | % { $GUI.$_.IsChecked = $False }
        }

        $Service                          = Get-DSCPromoTable -Services

        0..( $Service.Count - 1 )         | % {

            IEX "`$GUI.`$( `$Service[$_] ) | ? { `$_.IsEnabled } | % { 
        
            `$_.Add_UnChecked({ `$Code.`$( `$Service[$_] ) = 0 })
              `$_.Add_Checked({ `$Code.`$( `$Service[$_] ) = 1 }) 
            }"
        }

        $GUI.CredentialButton.Add_Click({

            $Alternate           = 0

            If ( $Report -ne $Null )
            {
                $PDC                              = $Report.NetBIOS | ? { $_.ID -eq "<1C>" }

                If ( $PDC.Count -gt 1 )
                {
                    $PDC                          = $PDC[0]
                }

                If ( $PDC -ne $Null )
                {
                    $DC                           = $PDC.Host.Split( '.' )[0]
                    $Domain                       = $PDC.Host.Replace( "$DC." , "" )
                    $NetBIOS                      = $PDC.Name
                }

                If ( $PDC -eq $Null )
                {
                    $BDC                          = $Report.NetBIOS | ? { $_.Service -eq "Domain Controller" }

                    If ( $BDC.Count -gt 1 )
                    {
                        $BDC                      = $BDC[0]
                    }

                    If ( $BDC -ne $Null )
                    {
                        $DC                       = $BDC.Host.Split( '.' )[0]
                        $Domain                   = $BDC.Host.Replace( "$DC." , "" )
                        $NetBIOS                  = $BDC.Name
                    }
                }

                $Popup                            = Get-XAML -DCFound 
                $GUIX                             = Convert-XAMLToWindow -XAML $Popup -NE ( Find-XAMLNamedElements -XAML $Popup ) -PassThru

                $GUIX.Ok                          | % { $_.Add_Click({ $GUIX.DialogResult =  $True }) }
                $GUIX.Cancel                      | % { $_.Add_Click({ $GUIX.DialogResult = $False }) }
                $GUIX.DC                          | % { $_.Content = $DC      }
                $GUIX.Domain                      | % { $_.Content = $Domain  }
                $GUIX.NetBIOS                     | % { $_.Content = $NetBIOS }

                $Null                             = $GUIX.Ok.Focus()

                $PopupResult                      = Show-WPFWindow -GUI $GUIX

                If ( $PopupResult -eq $True )
                {
                    $DCCred                       = Invoke-Login -DC $DC -Domain $Domain
                    
                    If ( $DCCred -ne $Null )
                    {
                        $GUI.Credential           | % { $_.Text = $DCCred.UserName ; $_.IsEnabled = $False }

                        $Code.Credential          = $DCCred
                        
                        If ( ( $GUI.Forest.IsChecked ) -or ( $GUI.Child.IsChecked ) )
                        {
                            "ParentDomainName"    | % { 
                            
                                $GUI.$_.Text      = "$Domain"
                                $Code.$_          = "$Domain"
                            }

                            "DomainNetBIOSName"   | % {
                            
                                $GUI.$_.Text      = "$NetBIOS"
                                $Code.$_          = "$Domain"
                            }
                        }

                        If ( $GUI.Clone.IsChecked )
                        {
                            "DomainName"          | % {
                            
                                $GUI.$_.Text      = "$Domain"
                                $Code.$_          = "$Domain"
                            }

                            "ReplicationSourceDC" | % {
                            
                                $GUI.$_.Text      = "$DC.$Domain"
                                $Code.$_          = "$DC.$Domain"
                            }
                        }
                    }

                    If ( $DCCred -eq $Null )
                    {
                        Write-Theme -Action "Exception [!]" "Domain Credential not captured, attempting secondary login" 11 1 15
                        $Alternate = 1
                    }
                }

                Else
                {
                    Write-Theme -Action "Exception [!]" "Either the user cancelled or the dialog failed" 12 4 15
                    $Alternate            = 1
                }
            }

            If ( ( $Report -eq $Null ) -or ( $Alternate -eq 1 ) )
            {
                Write-Theme -Action "Not Detected [!]" "Found no network nodes, attempting manual configuration"

                If ( ( $GUI.Tree.IsChecked ) -or ( $GUI.Child.IsChecked ) )
                {
                    $Domain = $GUI.ParentDomainName.Text
                }
                
                If ( $GUI.Clone.IsChecked ) 
                { 
                    $Domain = $GUI.DomainName.Text 
                }

                If ( ( $Domain -eq "" ) -or ( $Domain -eq $Null ) )
                {
                    Show-Message "Error" "Domain Name is Null/Empty"
                    Break
                }

                $X = Confirm-DomainName -Domain $Domain
                
                If ( $X -ne $Domain )
                {
                    Show-Message "Error" "$X"
                    Break
                }
                
                Resolve-DNSName $Domain -Type A | % { Resolve-DNSName $_.IPAddress } | % { $DC = $_.NameHost.Replace( ".$Domain" , '' ) }

                If ( $DC -eq $Null )
                { 
                    Show-Message "Error" "Failed to detect the domain controller"
                    Return
                }

                $DCCred = Invoke-Login -DC $DC -Domain $Domain

                If ( $DCCred -ne $Null )
                {
                    IEX "Using Namespace System.DirectoryServices"

                    $AD                       = "LDAP://$( $DC )/CN=Partitions,CN=Configuration,DC=$( $Domain.Split( '.' ) -join ',DC=' )"
                        
                    $Searcher                 = [ DirectorySearcher ]::New() 

                    $Searcher                 | % {
                    
                        $_.SearchRoot         = [ DirectoryEntry ]::New( $AD , $DCCred.Username , $DCCred.GetNetworkCredential().Password )
                        $_.PageSize           = 1000
                        $_.PropertiesToLoad.Clear()
                    }

                    $EXE = $Searcher.FindAll()

                    0..( $EXE.Count - 1 )     | % { $EXE[$_].Properties } | ? { $_.netbiosname } | % { 
                        
                        $NetBIOS              = $_.netbiosname
                    }
                    
                    $GUI.Credential           | % { $_.Text = $DCCred.UserName ; $_.IsEnabled = $False }

                    $Code.Credential          = $DCCred

                    If ( ( $GUI.Forest.IsChecked ) -or ( $GUI.Child.IsChecked ) )
                    {
                        "ParentDomainName"    | % { 
                            
                            $GUI.$_.Text      = "$Domain"
                            $Code.$_          = "$Domain"
                        }

                        "DomainNetBIOSName"   | % {
                            
                            $GUI.$_.Text      = "$NetBIOS"
                            $Code.$_          = "$NetBIOS"
                        }
                    }

                    If ( $GUI.Clone.IsChecked )
                    {
                        "DomainName"          | % {
                        
                            $GUI.$_.Text      = "$Domain"
                            $Code.$_          = "$Domain"
                        }

                        "ReplicationSourceDC" | % {
                           
                            $GUI.$_.Text      = "$DC.$Domain"
                            $Code.$_          = "$DC.$Domain"
                        }
                    }
                }

                If ( $DCCred -eq $Null )
                {
                    Write-Theme -Action "Exception [!]" "Login Failed" 12 4 15 
                }
            }
        })

        $GUI.Cancel.Add_Click( { $GUI.DialogResult = $False } )

        $GUI.Start.Add_Click({

            If ( $GUI.Forest.IsChecked )
            {
                $GUI.DomainName.Text | % {

                    If ( $_ -eq "" )
                    {
                        Show-Message "Error" "Domain Name is missing"
                        Break
                    }

                    $X = Confirm-DomainName -Domain $_
                    
                    If ( $X -ne $_ )
                    {
                        Show-Message "Error" $X
                        Break
                    }

                    Else 
                    {
                        $Code.DomainName = $_
                    }
                }

                $GUI.DomainNetBIOSName.Text | % {

                    If ( $_ -eq "" )
                    {
                        Show-Message "Error" "Domain Name is missing"
                        Break
                    }

                    $X = Confirm-DomainName -NetBIOS $_
                    
                    If ( $X -ne $_ )
                    {
                        Show-Message "Error" $X
                        Break
                    }

                    Else 
                    {
                        $Code.DomainNetBIOSName = $_
                    }
                }
            }

            If ( ( $GUI.Tree.IsChecked ) -or ( $GUI.Child.IsChecked ) -or ( $GUI.Clone.IsChecked ) )
            {
                $GUI.Credential.Text       | % {
            
                    If ( $_ -eq "" )
                    { 
                        Show-Message "Error" "Credential Missing"
                        Break
                    }
                }

                $GUI.SiteName.Text | % { 
                
                    If ( $_ -eq "" )
                    {
                        Show-Message "Error" "Site Name missing"
                        Break
                    }

                    $X = Confirm-DomainName -SiteName $_
                
                    If ( $X -ne $_ )
                    {
                        Show-Message "Error" $X
                        Break
                    }

                    Else
                    {
                        $Code.SiteName = $_
                    }
                }
            }

            If ( ( $GUI.Tree.IsChecked ) -or ( $GUI.Child.IsChecked ) )
            {
                $GUI.ParentDomainName.Text | % { 

                    If ( $_ -eq "" ) 
                    { 
                        Show-Message "Error" "Parent Domain Name is missing"
                        Break
                    }
                
                    $X = Confirm-DomainName -Domain $_

                    If ( $X -ne $_ )
                    {
                        Show-Message "Error" $X
                        Break
                    } 

                    Else             
                    { 
                        $Code.ParentDomainName = $_ 
                    }
                }
            
                $GUI.NewDomainName.Text | % { 
                
                    If ( $_ -eq "" ) 
                    { 
                        Show-Message "Error" "New Domain Name is missing"
                        Break
                    }

                    If ( $_ -like "*$( $GUI.ParentDomainName.Text )*" )
                    {
                        If ( $GUI.Tree.IsChecked )
                        {
                            Show-Message "Error" "New Domain Name is too similar to Parent Domain"
                            Break
                        }
                    
                        If ( $GUI.Child.IsChecked )
                        {
                            Show-Message "Error" "Child Domain Name cannot contain Parent Domain"
                            Break
                        }
                    }
                        
                    If ( $GUI.Tree.IsChecked )
                    {
                        $X = Confirm-DomainName -Domain $_
                            
                        If ( $X -ne $_ )
                        {
                            Show-Message "Error" $X
                            Break
                        }

                        Else
                        {
                            $Code.NewDomainName = $_ 
                        }
                    }

                    If ( $GUI.Child.IsChecked )
                    {
                        $X = Confirm-DomainName -SiteName $_
                            
                        If ( $X -ne $_ )
                        {
                            Show-Message "Error" $X
                            Break
                        }

                        Else
                        {
                            $Code.NewDomainName = $_ 
                        }
                    }
                }

                $GUI.NewDomainNetBIOSName.Text | % { 
            
                    If ( $_ -eq "" ) 
                    { 
                        Show-Message "Error" "New NetBIOS Domain Name is missing"
                        Break
                    }

                    ElseIf ( ( $NetBIOS -ne $Null ) -and ( $_ -like "*$NetBIOS*" ) ) 
                    { 
                        Show-Message "Error" "New NetBIOS Domain Name is too similar to Parent"
                        Break
                    }

                    Else
                    {
                        $X = Confirm-DomainName -NetBIOS $_

                        If ( $X -ne $_ ) 
                        { 
                            Show-Message "Error" $X
                            Break
                        } 

                        Else             
                        { 
                            $Code.NewDomainNetBIOSName = $_ 
                        }
                    }
                }
            }

                If ( $GUI.Clone.IsChecked )
                {
                    $GUI.DomainName.Text | % { 
                        
                        If ( $_ -eq "" )
                        {
                            Show-Message "Error" "Domain Name cannot be empty"
                            Break
                        }

                        $X = Confirm-DomainName -Domain $_
                        
                        If ( $X -ne $_ ) 
                        { 
                            Show-Message "Error" $X
                            Break
                        } 
                        
                        Else
                        { 
                            $Code.DomainName = $_ 
                        }
                    }
            
                    $GUI.ReplicationSourceDC.Text | % { 
            
                        If ( $_ -eq "" )
                        {
                            Show-Message "Error" "Source Domain Controller Missing"
                            Break
                        }

                        $X = Resolve-DNSName $_ -Type CName | % { $_.PrimaryServer }

                        If ( $X -ne $_ ) 
                        { 
                            Show-Message "Error" $X
                            Break
                        }

                        Else 
                        { 
                            $Code.ReplicationSourceDC  = $_ 
                        } 
                    }
                }

                "Database" , "Log" , "Sysvol" | % { "$_`Path" } | % { $Code.$_ = $GUI.$_.Text }

                If ( $GUI.SafeModeAdministratorPassword.Password -eq "" )                          
                { 
                    Show-Message "Error" "DSRM Key is empty"
                    Break
                }

                If ( $GUI.SafeModeAdministratorPassword.Password.Length -lt 8 )
                { 
                    Show-Message "Error" "Password is too short"
                    Break
                }

                If ( $GUI.SafeModeAdministratorPassword.Password -notmatch $GUI.Confirm.Password )
                { 
                    Show-Message "Error" "Invalid Confirmation"
                    Break
                }
            
                $Code.SafeModeAdministratorPassword = $GUI.SafeModeAdministratorPassword.SecurePassword

                "ForestMode" , "DomainMode" | % { 
            
                    $Code.$_ = $GUI.$_.SelectedIndex

                    If ( $Code.$_ -eq 7 )
                    {
                        $Code.$_ = 6
                    } 
                }
                
                Get-DSCPromoTable -Roles | % {
            
                    If ( $GUI.$_.IsEnabled ) 
                    { 
                        $Code.$_ = $GUI.$_.IsChecked
                    }
                }

                $GUI.DialogResult = $True
            })

            ( "Database" , "NTDS" ) , ( "Log" , "NTDS" ) , ( "Sysvol" , "SYSVOL" ) | % { 
        
                $GUI.$( $_[0] + "Path" ).Text = "C:\Windows\$( $_[1] )"
            }

            $Null = $GUI.SafeModeAdministratorPassword.Focus()

            $OP   = Show-WPFWindow -GUI $GUI

            If ( $OP -eq $True )
            {
                $DSCLoadout      = @( ) 
            
                Get-DSCPromoTable -Services | ? { $Code.$_ -eq "Available" -and $GUI.$_.IsChecked -eq $True } | % {
            
                    $DSCLoadout += $_.Replace( '_' , '-' )
                }

                $Command         = $Code.Command

                $Provision       = [ Ordered ]@{ }

                $Code.Process    | ? { $_ -in 1..2 } | % {

                    $Provision.Add( "DomainType" , ( Get-DSCPromoTable -DomainType )[$_] )
                }
            
                $Code.Profile    | % { 

                    $Provision.Add( $_ , $Code.$_ )
                }

                "Database" , "Log" , "Sysvol" | % { "$_`Path" } | % { 

                    $Provision.Add( $_ , $Code.$_ )
                }

                # Report/Confirmation Screen
             #_    ____________________________
             #\\__//¯¯[_______ Services ______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                If ( $DSCLoadOut.Count -ge 1 )
                {
                    $Section     = 0..2
                    $SubTable    = 0..2
                    $Z           = 0

                    $Section[$Z]  = "Service Configuration"

                    $Names       = @( )
                    $Values      = @( )
            
                    ForEach ( $I in 0..( $DSCLoadOut.Count - 1 ) ) 
                    { 
                        $Names  += "Service [$I]" 
                        $Values += $DSCloadout[$I]
                    }
                
                    $Subtable[$Z] = New-SubTable -Items $Names -Values $Values

                    $Z ++
                }
             #_    ____________________________
             #\\__//¯¯[_______ Command _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                If ( $DSCLoadOut.Count -eq 0 )
                {
                    $Section     = 0..1
                    $SubTable    = 0..1
                    $Z           = 0
                }

                $Section[$Z]  = "Domain Controller Promotion"
                $Subtable[$Z] = New-SubTable -Items "Command/Type" -Values $Command

                $Z ++
             #_    ____________________________
             #\\__//¯¯[______ Parameters _____]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $Section[$Z]  = "Parameters"
                $Names        = @( $Provision.Keys ) 
                $Values       = @( $Provision.Values )
            
                $Subtable[$Z] = New-SubTable -Items $Names -Values $Values
             #_    ____________________________
             #\\__//¯¯[_____ Confirmation ____]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $Splat       = @{ 
                
                    Title    = "Hybrid-DSC Promo Loadout"
                    Depth    = $Section.Count
                    ID       = ForEach ( $I in 0..( $Section.Count - 1 ) ) { "( $( $Section[$I] ) )" }
                    Table    = ForEach ( $I in 0..( $Section.Count - 1 ) ) { $Subtable[$I] } 
                }
            
                $Table       = New-Table @Splat

                Write-Theme -Table $Table -Prompt "Press Enter to Continue, CTRL + C to Exit"
             #_    ____________________________
             #\\__//¯¯[__ Service Installer __]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                If ( $DSCLoadout.Count -gt 0 )
                {
                    Write-Theme -Action "Installing [~]" "Loadout Services"

                    $DSCLoadOut    | % {

                        $Splat     = @{ Name                   = $_
                                        IncludeAllSubFeature   = $True 
                                        IncludeManagementTools = $True }

                        Install-WindowsFeature @Splat
                    }
                }

                IPMO ADDSDeployment -VB
             #_    ____________________________
             #\\__//¯¯[____ DCPromo Tester ___]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Write-Theme -Action "Testing [~]" "Promotion Parameters"

                $Promote = 0

                If ( $Command -eq "Install-ADDSForest" ) 
                { 
                    $EXE = 0
                    $MSG = "Test-ADDSForestInstallation"

                    Test-ADDSForestInstallation @Provision
                }

                If ( $Command -eq "Install-ADDSDomain" )
                {
                    $EXE = 1
                    $MSG = "Test-ADDSDomainInstallation"

                    Test-ADDSDomainInstallation @Provision
                }

                If ( $Command -eq "Install-ADDSDomainController" )
                {
                    $EXE = 2
                    $MSG = "Test-ADDSDomainControllerInstallation"

                    Test-ADDSDomainControllerInstallation @Provision
                }

                If ( $? -eq $True )
                {
                    Write-Theme -Action "Successful [+]" "$MSG Passed"
                    $Promote = 1
                }
                
                If ( $? -eq $False )
                {
                    Write-Theme -Action "Exception [!]" "$MSG Failed" 12 4 15
                    Break
                }

                If ( $Promote -eq 1 )
                {
                    Switch( $Host.UI.PromptForChoice( "Test Successful" , "Proceed with Domain Controller Promotion?" ,
                    [ System.Management.Automation.Host.ChoiceDescription [] ]@( "&Yes" , "&No" ) , [ Int ] 1 ) )
                    {
                        0   {   Write-Theme -Action "Selected [+]" "Promote to Domain Controller"

                                ( "NoRebootOnCompletion" , $False ) , ( "Force" , $True ) | % { $Provision.Add( $_[0] , $_[1] ) }

                                If ( $EXE -eq 0 )   { Install-ADDSForest @Provision }
                                If ( $EXE -eq 1 )   { Install-ADDSDomain @Provision }
                                If ( $EXE -eq 2 )   { Install-ADDSDomainController @Provision }

                                If ( $? -eq $True ) { Write-Theme -Action "Successful [+]" "Promotion Complete, Rebooting" }
                            }
                    
                        1   {   Write-Theme -Action "Selected [+]" "Do not promote to Domain Controller"   }
                    }
                }
            }

            Else { Write-Theme -Action "[!] Exception" "Either the user cancelled, or the dialog failed" 12 4 15 }

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-NetworkMap # Obtains Extensive Network Information _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯     
        
         Write-Theme -Action "Loading [~]" "Network Mapping Components"

             #_    ____________________________
             #\\__//¯¯[___ Resolve Vendors ___]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

        $Resource                                  = [ PSCustomObject ]@{

            Path                                   = Get-ScriptRoot | % { "{0}\Map" -f $_.Parent }
            Count                                  = ""
            Index                                  = ""
            Vendor                                 = ""
        }
             #_    ____________________________
             #\\__//¯¯[___ Overload Scripts __]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

        $Script                                    = [ PSCustomObject ]@{

            Class                                  = {
                
                Param ( $Address )("No Network,X A,Localhost,X B,X C,Multicast,R/D,Broadcast"
                ).Replace("X","Class").Split(',')[@(0;@(1)*126;2;@(3)*64;@(4)*32;@(5)*16;@(6)*15;7)][$Address.Split('.')[0]]
            }

            Netmask                                = {
            
                Param ( $Mask )

                $Mask | % { 
                
                    $X = @{ 0 = 255 ; 1 = 0 ; 2 = 0 ; 3 = 0 }
                    $Y = $_ % 8 ; $Z = ( $_ - ( $Y ) ) / 8
                    If ( $_ -in 16..30 ) { $X[1] = 255 } 
                    If ( $_ -in 24..30 ) { $X[2] = 255 }

                    $X[$Z] = "0,128,192,224,240,248,252,254,255".Split(',')[$Y]
                    $X[0..3] -join '.'
                }
            }

            Vendor                                 = {

                Param ( $Vendor )
                
                $Convert    = [ Convert ]::ToInt64( $Vendor , 16 )

                $Rank       = 0 
                                    
                ForEach ( $J in 1..( $Resource.Count.Count ) )
                {
                    $Rank   = $Rank + $Resource.Count[$J]

                    If ( $Rank -eq $Convert )
                    { 
                        $Resource.Vendor[ ( $Resource.Index[ $J + 1 ] ) ]
                    }
                }
            }

            Range                                  = {

                Param ( $Address , $Mask )

                $ID           = [ PSCustomObject ]@{

                    IPAddress = ( [ IPAddress ] $Address ).GetAddressBytes()
                    Mask      = ( [ IPAddress ] $Mask    ).GetAddressBytes()
                    Build     = 0..3
                    Range     = 0..3
                    Count     = @( )
                }

                $ClassID      = & $Script.Class $Address

                If ( $ID.IPAddress[0] -in @( 0 , 127 ; 224..255 ) )
                {
                    Write-Theme -Action "Exception [!]" "$( $ClassID[$ID.IPAddress[0]] ) Address Detected" 12 4 15
                    Break
                }

                If ( ( $ID.IPAddress[0..1] -join '.' ) -eq "169.254" )
                {
                    Write-Theme -Action "Exception [!] " "Automatic Private IP Address Detected" 12 4 15
                    Break
                }

                ForEach ( $I in 0..3 )
                {
                    $ID.Build[$I] = 256 - $ID.Mask[$I]

                    If ( $ID.Build[$I] -eq 1 )
                    {
                        $ID.Range[$I] = $ID.IPAddress[$I]
                    }

                    If ( $ID.Build[$I] -in 2..255 )
                    {
                        $Z = $ID.Build[$I]

                        ForEach ( $Y in 0..( ( 256 / $Z ) - 1 ) )
                        { 
                            $X = $Z * $Y | % { $_..( $_ + ( $Z - 1 ) ) }

                            If ( $ID.IPAddress[$I] -in $X )
                            {
                                $ID.Range[$I] = "$( $X[0] )..$( $X[$Z - 1] )"
                            }
                        }
                    }

                    If ( $ID.Build[$I] -eq    256 ) { $ID.Range[$I]  = "*" }
                }

                $ID.Count = ( IEX ( ( 0..3 | % { $ID.Build[$_] } ) -join "*" ) ) - 2

                $ID
            }
        }

             #_    ____________________________
             #\\__//¯¯[_____ Gather Info _____]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

        $Root                                      = [ PSCustomObject ]@{ 
        
            Domain                                 = GP "HKLM:\System\CurrentControlSet\Services\TCPIP\Parameters" | % { $_.Domain.ToUpper() }
            Hostname                               = GP "HKLM:\System\CurrentControlSet\Services\TCPIP\Parameters" | % { $_.Hostname.ToUpper() }
            ARP                                    = @( ARP -A )
            NetStat                                = @( netstat -ant )
            Computer                               = GCIM Win32_ComputerSystem
        }
        
        $C = 0

        GCI $Resource.Path "*zip*"                 | % { 
        
            Write-Progress -Activity "Loading $( $_.BaseName )" -PercentComplete ( ( $C / 3 ) * 100 )

            Expand-Archive -Path $_.FullName -DestinationPath $_.DirectoryName -Force ; $C ++
        }

        $C = 0

        GCI $Resource.Path "*txt*"                 | % { 

            Write-Progress -Activity "Loading $( $_.BaseName ).txt" -PercentComplete ( ( $C / 3 ) * 100 )
        
            $Resource.$( $_.Basename )             = GC $_.FullName ; $C ++ ; RI $_.FullName -VB 
        }

             #_    ____________________________
             #\\__//¯¯[___ Parse ARP Table ___]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

        $Return                                   = [ PSCustomObject ]@{
        
            ARP                                   = [ PSCustomObject ]@{ 
            
                Interface                         = $Root.Arp | ? { $_ -match "Interface" } | % { $_.Replace('Interface: ','').Split(' ')[0] }
                Table                             = @( )
            }

            Adapter                               = @( )
            Interface                             = @( )
            Current                               = @( )
            Switch                                = 0
        }

        If ( $Return.ARP.Interface.Count -eq 1 )
        { 
            $Return.Current = $Root.ARP 
        }
        
        If ( $Return.ARP.Interface.Count -gt 1 )
        {
            $Return.Switch                        = 1
            $Y                                    = 0
            $C                                    = $Return.ARP.Interface.Count

            $Item                                 = [ PSCustomObject ]@{
                
                Count                             = ( $Root.ARP.Count / $C )
                Rank                              = 0
                Line                              = $Null
                Current                           = @{ }
            }

            0..( $Root.Arp.Count - 1 )            | % { 
                
                If ( $Item.Line      -eq $Null ) 
                { 
                    $Item.Current.Add( $Item.Rank , @( ) )
                    $Item.Line = 0 
                }
                
                $Item.Current[ $Item.Rank ]      += $Root.Arp[ $Item.Line ]
                $Item.Line ++
                    
                If ( $Item.Line % 14 -eq     0 ) 
                { 
                    $Item.Rank ++ 

                    If ( $Item.Current.Count -ne $C ) 
                    { 
                        $Item.Current.Add( $Item.Rank , @( ) ) 
                    }
                }
            }
        }
            
        Do
        {
            If ( $Return.Switch -eq 1 )
            {
                $Return.Current = $Item.Current[$Y]
            }

            $Return.Current | % { 
    
                ForEach ( $i in "dynamic" , "static" )
                {
                    If ( $_ -match $I )
                    {
                        $X = @{ 0 = ( $_[0..23] ) ; 1 = ( $_[24..41] ) }
                        
                        0..1 | % { $X[$_] = "$( $X[$_] )".Replace(' ','') }
                            
                        If ( $X[0] -notin $Return.Adapter.IPV4 )
                        {
                            $Return.Arp.Table += [ PSCustomObject ]@{

                                Hostname              = "-"
                                IPV4                  = ($X[0])
                                Class                 = & $Script.Class $X[0]
                                Mac                   = ($X[1])
                                Vendor                = ($X[1])[0,1,3,4,6,7] -join ''
                                    
                            }
                        }
                    }
                }
            }

            If ( $Return.Switch -eq 1 )
            {
                If ( $Y -eq $Item.Range.Count - 1 ) 
                {
                    $Y ++ 
                }
                
                Else 
                {
                    $Return.Switch = 0 
                }
            }
        }
        
        Until ( $Return.Switch -eq 0 )

             #_    ____________________________
             #\\__//¯¯[__ Format ARP Tables __]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

        If ( $Return.Arp.Table.Count -eq 0 )
        {
            Write-Theme -Action "Exception [!]" "Functional Adapter(s) Not Detected" 12 4 15
            Break
        }
        
        $C = 0

        $Return.Arp.Table | ? { 

            Write-Progress -Activity "Collecting Interface Information" -PercentComplete ( ( $C / $Return.Arp.Table.Count ) * 100 )

            If ( $_.Vendor -in "ffffff","01005e" )
            {
                $_.Hostname = "-----------------"
                $_.Vendor   = "-----------------"
            }
            
            If ( $_.Vendor -notin "ffffff","01005e","-----------------" )
            {
                $_.HostName = Try { Resolve-DNSName $_.IPV4 -EA 0 | % { $_.NameHost } } Catch { "Unknown" }
                $_.Vendor   = ( & $Script.Vendor $_.Vendor )
            }

            $C ++
        }
             #_    ____________________________
             #\\__//¯¯[__ Collect Interface __]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

        $Return.Interface = @( Get-NetRoute | ? { $_.DestinationPrefix -eq "0.0.0.0/0" }  | % { 
        
            Get-NetIPConfiguration -InterfaceIndex $_.InterfaceIndex -Detailed | % { 

                [ PSCustomObject ]@{ 

                    ComputerName   = $_.ComputerName
                    Alias          = $_.InterfaceAlias
                    Index          = $_.InterfaceIndex
                    Description    = $_.InterfaceDescription
                    MacAddress     = $_.NetAdapter.LinkLayerAddress
                    Vendor         = & $Script.Vendor ( ( $_.NetAdapter.LinkLayerAddress)[0,1,3,4,6,7] -join '' )
                    Domain         = $_.NetProfile.Name.ToUpper() | % { If ( $_ -ne $Root.Domain ) { "$_ [$( $Root.Domain)]" } Else { $Root.Domain } }
                    IPV4Address    = $_.IPV4Address.IPAddress
                    IPV4Prefix     = Get-NetIPAddress -InterfaceIndex $_.InterfaceIndex | ? { $_.IPV4Address } | % { & $Script.Netmask $_.PrefixLength }
                    IPV4Gateway    = $_.IPv4DefaultGateway | % { $_.NextHop }
                    IPV4DNS        = $_.DNSServer | ? { $_.AddressFamily -eq  2 } | % { $_.ServerAddresses }
		    IPV4ARP        = @( )
		    IPV4NET        = @( )
		    IPV4NBT        = @( )
                    IPV6Address    = $_.IPV6Address
                    IPV6Prefix     = Get-NetIPAddress -InterfaceIndex $_.InterfaceIndex | ? { $_.IPV6Address } | % { $_.PrefixLength }
                    IPV6Gateway    = $_.IPV6DefaultGateway | % { $_.NextHop }
                    IPV6DNS        = $_.DNSServer | ? { $_.AddressFamily -eq 23 } | % { $_.ServerAddresses }
                }
            }                   
        })

        If ( $Return.Interface -eq $Null )
        {
            Write-Theme -Action "Exception [!]" "Gateway not detected. Aborting" 12 4 15
            Break
        }

        Write-Theme -Action "Found [+]" "($( $Return.Interface.Count )) Network Interface(s)" 11 11 15

        $Return.Interface         | % {
            
            $_.IPV4ARP            = $Return.Arp | % { 
            
                If ( $_.Interface.Count -eq 1 )
                {
                    $_.Table
                }
                Else
                {
                    ForEach ( $I in 0..( $_.Interface.Count - 1 ) )
                    { 
                        $_.Table[$I]
                    }
                }
            }

            $_.IPV4NET            = & $Script.Range $_.IPV4Address $_.IPV4Prefix | % {
                    
                [ PSCustomObject ]@{

                    Count         = $_.Count + 2
                    Range         = ( $_.Range -join '/' ).Replace( "*" , "0..255" )
                    Collect       = @( )
                
                }
            }
        }
            
        $Return.Interface.IPV4Net | % { 
        
            $Obj = $_
            
            ForEach ( $I in 3..0 )
            {
                $Current = IEX $Obj.Range.Split('/')[$I]
                
                If ( $_.Collect.Count -eq 0 ) 
                { 
                    $Current | % { $Obj.Collect += $_ } 
                }

                Else
                {
                    $Expand  = $Obj.Collect.Clone()
                    $Obj.Collect = @( )
                    
                    ForEach ( $J in $Current ) 
                    {
                        $Expand | % { $Obj.Collect += $J , $_ -join '.' }
                    }
                }
            }

            [ PSCustomObject ]@{

                Range     = $Obj.Collect
                Count     = $Obj.Collect.Count - 2
                Network   = $Obj.Collect[0]
                Broadcast = $Obj.Collect[-1]
            }
        }

        $Root.Netstat                 = @( netstat -ant | ? { $_ -match "TCP" -or $_ -match "UDP" } )

            $Return.NetStat           = ForEach ( $X in "TCP" , "UDP" )
            { 
                ForEach ( $i in 0..( $OP.Count - 1 ) )
                {
                    $Z = ( $OP[$I] | ? { $_ -match "TCP" } ).Split(' ') | ? { $_.Length -gt 0 }

                    [ PSCustomObject ]@{

                        Protocol      = $Z[0]
                        LocalAddress  = $Z[1] 
                        RemoteAddress = $Z[2]
                        Activity      = $Z[3]
                        Purpose       = $Z[4]
                    }
                }
            }


        # Draw Adapter/Network Information

        $Count            = ForEach ( $I in 0..( $Return.Adapter.Count - 1 ) )
        {
            $Splat        = @{ 

                Items     = "Hostname,IPV4,Class,Mac,Vendor".Split(',')
                Values    = $Return.Adapter[$I] | % { $_.Hostname , $_.IPV4 , $_.Class , $_.Mac , $_.Vendor }
            }

            New-SubTable @Splat
        }

        $Splat            = @{ 

            Title         = "Address Resolution & Network Host Map"
            Depth         = $Count.Count
            ID            = 0..( $Count.Count - 1 ) | % { "([ Host # $_ ])" }
            Table         = $Count
        }

        Write-Theme -Table ( New-Table @Splat )

        $Count            = ForEach ( $I in 0..( $Return.Interface.Count - 1 ) )
        { 
            $Splat        = @{ 

                Items     = "Configuration,Hostname,Domain,InterfaceIndex,InterfaceAlias,Gateway,IPV4Address,IPV4DNS,IPV6Address,IPV6DNS".Split(',')
                Values    = $Return.Interface[$I] | % { $_.Configuration , $_.Hostname , $_.Domain , $_.InterfaceIndex , $_.InterfaceAlias , 
                            $_.Gateway , $_.IPV4Address , $_.IPV4DNS , $_.IPV6Address , $_.IPV6DNS }
            }

            New-SubTable @Splat
        }
        
        $Splat            = @{ 

            Title         = "Network Interface Controller List"
            Depth         = $Count.Count
            ID            = 0..( $Count.Count - 1 ) | % { "([ Interface # $_ ])" }
            Table         = $Count
        }

        Write-Theme -Table ( New-Table @Splat )

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-NetworkInfo # Obtains Extensive Network Information ____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯     


        $Return | % { 

            $List                  = ForEach ( $I in 0..( $_.Arp.Count - 1 ) ) 
            { 
                If ( $Range[$_.Arp[$I].Split('.')[0]] -in 1..3 ) { $_.Arp[$I] }
            }
        }

        $NWA                   = @( )
        $HL                    = @( )

        ForEach ( $I in 0..( $List.Count - 1 ) )
        {
            $NW                = ""
            $HA                = $Null
            $X                 = $List[$I].Split( '.' )
            $Y                 = $IPV4.Split( '.' )

            0..3               | % { 

                If ( $X[$_] -eq $Y[$_] ) 
                { 
                    If ( $_ -eq 0 )
                    { 
                        $NW    = $X[$_]
                    }

                    Else 
                    { 
                        $NW    = "$NW.$( $X[$_] )" 
                    }
                }

                Else 
                {
                    $HA        = $X[$_]

                    If ( $I -eq $List.Count - 1 ) 
                    { 
                        $CL    = $Y[$_]
                        $NWX   = $NW 
                    }
                }
            }

            If ( $NW -notin $NWA ) 
            { 
                $NWA          += $NW 
            }
            
            $HL               += $HA
        }

        If ( $NW -notin $NWA ) 
        { 
            $NWA              += $NWx 
        } 
        
        $HL                   += $CL
        $HostRange             = $HL | % { [ Int ]$_ } | Sort
            
        $List                 += $IPV4
            
        $Route                 = Get-NetRoute -AddressFamily IPv4 | ? { $_.DestinationPrefix -like "*$NW*" } | % { $_.DestinationPrefix }
        
        $Subnet , $CIDR        = $Route | ? { $_.Split( '/' )[0] -notin $List } | % { $_.Split( '/' ) }
            
        # Convert the information found from CIDR to Full format for autocorrective measures ( I still need to work on this for Class A/B )

        $Binary                = 0 , 1 , 2, 4 , 8 , 16 , 32 , 64 , 128

        $Div , $For            = $CIDR | % { $_ / 8 ; $_ % 8 }
        
        $NM                    = @( )

        $NM                    = @( 0..( $Div - 1 ) | % { ( $Binary[1..8] | Measure -Sum ).Sum } ; ( $Binary[0..$For] | Measure -Sum ).Sum ) -join '.'

        $NWIPC  = IPCONFIG     | ? { $_ -like "*Subnet Mask*" } | ? { $_ -like "*$NM*" } | % { $_.Split( ':' )[1].Replace( ' ' , '' ) }
                
        If ( $NWIPC -eq $NM )
        { 
            $Return            = [ PSCustomObject ]@{ 

                IPV4           = $IPV4
                Class          = "Class $( $Class[ ( $Range[ ( $NW.Split( "." )[0] )])] ) Address"
                Prefix         = $NW
                NetMask        = $NM
                CIDR           = $CIDR
                MAC            = $MAC
                DNS            = $DNS 
                Subnet         = "$NW.$( $HostRange[ 0] - 1 )"
                Start          = "$NW.$( $HostRange[ 0] )"
                End            = "$NW.$( $HostRange[-1] - 1 )"
                Echo           = "$NW.$( $HostRange[-1] )"
            }
        }

        If (    $LocalHost ) 
        { 
            Return $Return 
        }

        If ( $NetworkHosts )
        {
            0..( $HostRange.Count - 2 ) | % {
                
                Return [ PSCustomObject ]@{ 
                
                    Host       = "$NW.$( $HostRange[$_] )" 
                }

            }
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Start-PingSweep  # Gets actual used network host addresses _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Write-Theme -Action "Scanning [~]" "Network Host Range"

        IEX "Using Namespace System.Net.NetworkInformation"

        Get-NetworkInfo -LocalHost      | % {

            $Range                      = ForEach ( $I in $_.Start , $_.End )
            {
                $I.Replace( $_.Prefix + '.' , "" )
            }

            $HostRange                  = ForEach ( $I in $Range[0]..$Range[1] )
            {
                 $_.Prefix + ".$I"
            }
        }

        $Stopwatch                      = [ System.Diagnostics.Stopwatch ]::StartNew()

        $Return                         = [ PSCustomObject ]@{ 
        
            Success                     = @( )
            Failure                     = @( ) 
        }

        $B                              = 97..119 + 97..105 | % { "0x$( "{0:x}" -f $_ )" }

        $O                              = New-Object PingOptions

        $Report                         = ForEach ( $I in $HostRange )
        {
            New-Object Ping             | % { $_.SendPingAsync( $I , 100 , $B , $O ) } 
        }

        $Stopwatch.Stop()

        $Report.Result                  | ? { $_.Status -eq "Success"   } | % { $Return.Success += $_.Address.ToString() }
            
        $HostRange                      | ? { $_ -notin $Return.Success } | % { $Return.Failure += $_ }

        Write-Theme -Action "Complete [+]" "$( $Stopwatch.Elapsed ) / Hosts Found : [$( $Return.Success.Count )]"

        Return $Return
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-NBTSCAN # Scans all discoverable NetBIOS Nodes _________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯     
        [ CmdLetBinding () ] Param ( 

            [ Parameter ( Position = 0 , HelpMessage = "Output the information to a table" )][ Switch ] $Table )

        $Return                         = @( )

        $IP                             = Start-PingSweep | ? { $_.Success -ne $Null } | % { $_.Success }

        $IPV4                           = Get-NetworkInfo -LocalHost | % { $_.IPV4 }

        $ID                             =  "00" , "01" , "01" , "03" , "06" , "1F" , "20" , "21" , "22" , "23" , "24" , "30" , "31" , "43" , "44" , 
                                           "45" , "46" , "4C" , "42" , "52" , "87" , "6A" , "BE" , "BF" , "03" , "00" , "1B" , "1C" , "1D" , "1E" , 
                                           "2B" , "2F" , "33" , "20" , "01" | % { "<$_>" }

        $Type                           = ( "UNIQUE" , "GROUP" )[ 0 , 0 , 1 + @( 0 ) * 22 + 1 , 0 , 1 , 0 , 1 , 0 , 1 , 1 , 1 , 1 ]

        $SVX                            = "Workstation" , "Messenger" , "Master Browser" , "Messenger" , "RAS Server" , "NetDDE" , "File Server" ,  
                                          "RAS Client" , "Interchange(MSMail Connector)" , "Store" , "Directory" , "Server" , "Client" , "Control" , 
                                          "SMS Administrators Remote Control Tool" , "Chat" , "Transfer" , "on Windows NT" , "mccaffee anti-virus" , 
                                          "on Windows NT" , "MTA" , "IMC" , "Network Monitor Agent" , "Network Monitor Application" , "Messenger" , 
                                          "Name" , "Master Browser" , "Controller" , "Master Browser" , "Browser Service Elections" , "Server" , 
                                          "" , "" , "DCA IrmaLan Gateway Server" , "MS NetBIOS Browse"

        $Filter                         = 0,0,7,0,0,0,0,0,1,1,1,3,3,4,0,4,4,6,7,6,1,1,7,7,0,5,5,5,7,7,2,2,2,7,0

        $Item                           = @( "SVX Service" ; "Microsoft Exchange" , "Lotus Notes" , "Modem Sharing" , "SMS Clients Remote" , "Domain" , 
                                             "DEC TCPIP SVC" | % { "$_ SVX" } ; "SVX" )

        $Service                        = ForEach ( $I in 0..34 ) 
        { 
            $Item[ ( $Filter[$I] ) ].Replace( "SVX" ,"$( $SVX[$I] )" )  
        }

        $List                           = @( )
        
        ForEach ( $I in 0..34 ) 
        { 
            $List                      += [ PSCustomObject ]@{ 
            
                ID                      = $ID[$I]
                Type                    = $Type[$I]
                Service                 = $Service[$I] 
            } 
        }

        Write-Theme -Action "Initiating [~]" "NetBIOS Scanner"

        ForEach ( $I in ( 0..( $IP.Count - 1 ) ) ) 
        {
            Write-Theme -Function "Host # $( $IP[$I] )"

            $DNS = $( Resolve-DnsName -Name $IP[$I] -EA 0 | % { $_.Namehost | % { If ( $_ -ne $Null ) { $_ } Else { "*No Hostname*" } } } )

            $X                          = @( )

            If ( $IP[$I] -eq $IPV4 ) 
            { 
                NBTSTAT -n              | ? { $_ -like "*Registered*" } | % { 
                
                    If ( $_ -notin $X ) 
                    { 
                        $X             += $_ 
                    } 
                } 
            }

            If ( $IP[$I] -ne $IPV4 ) 
            { 
                NBTSTAT -A $IP[$I]      | ? { $_ -like "*Registered*" } | % { 
                
                    If ( $_ -notin $X ) 
                    { 
                        $X             += $_ 
                    } 
                } 
            }

            ForEach ( $y in 0..( $X.Count - 1 ) ) 
            { 
                If ( $X[$Y] -like "*__MSBROWSE__*" ) 
                { 
                    $X[$Y]              = "    MSBROWSE       <01>  GROUP       Registered " 
                } 
            }

            $X                          | % { 

                $Z                      = @( $_[0..18] , $_[19..23] , $_[24..32] | % { ( $_ -ne " " ) -join '' } )

                $List                   | ? { $Z[1] -eq $_.ID -and $Z[2] -eq $_.Type } | % { 
                
                    $SVC                = $_.Service 
                }

                $Return                += [ PSCustomObject ]@{ 
                
                    IP                  = $IP[$I]
                    Host                = $DNS
                    Name                = $Z[0]
                    ID                  = $Z[1]
                    Type                = $Z[2]
                    Service             = $SVC 
                }
            }
        }

        If ( !$Table ) 
        { 
            Return $Return 
        } 

        If ( $Table ) 
        { 
            Return $Return              | FT -AutoSize 
        }
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-TelemetryData # Accesses Internet API's to recover Settings ____________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
            Test-Connection 1.1.1.1 -Count 1 | ? { $_ -eq $Null } | % { 
    
                Write-Theme -Action "Exception [!]" "Not connected to the internet" 12 4 15
                Break
            }

            "SecurityProtocol"           | % { IEX "[ Net.ServicePointManager ]::$_ = [ Net.$_`Type ]::TLS12" }

            $X                           = IRM -URI "http://ipinfo.io/$( ( IWR -URI 'http://ifconfig.me/ip' | % { $_.Content } ) )"

            $Info                        = [ PSCustomObject ]@{

                ExternalIP               = $X.IP
                State                    = $X.Region
                Organization             = "Default"
                CommonName               = "Default"
                Location                 = $X.City
                Country                  = $X.Country
                ZipCode                  = $X.Postal
                TimeZone                 = "Default" 
                SiteLink                 = "Default-First-Site-Name" 
            }

            Write-Theme -Action "Collecting [+]" "Telemetry Data / Certificate Information"
        
            $Key                         = "tZqSUOHxpjLy9kyOLKspvyZmjciB0nWpxz6PMl3KQNQBNEnW5sCbTKkKBPalSOBk"

            $Y                           = IRM -URI "https://www.zipcodeapi.com/rest/$Key/info.json/$( $X.Postal )/degrees" -Method Get 

            $Info                        | % { 
            
                $_.Location              = $Y.City 
                $_.TimeZone              = $Y.TimeZone.TimeZone_Identifier
                $_.SiteLink              = "$( ( $Y.City.Split( ' ' ) | % { $_[0] } ) -join '' )-$( $X.Postal )" 
            }

            $MSG  = "Company" , "Domain" | % { "[ System.Windows.MessageBox ]::Show( 'You must enter a $_' , '$_ Error' )" }

            $GUI = Get-XAML -Certificate | % { Convert-XAMLtoWindow -Xaml $_ -NE ( Find-XAMLNamedElements $_ ) -PassThru }

            $GUI.Cancel.Add_Click({ $GUI.DialogResult = $False })

            $GUI.Ok.Add_Click({

                If     ( $GUI.Company.Text -eq $Null )                 
                { 
                    IEX $MSG[0] 
                }

                ElseIf ( $GUI.Domain.Text  -eq $Null )
                { 
                    IEX $MSG[1] 
                }

                Else 
                { 
                    $GUI.DialogResult     = $True 
                }

            })

            $GUI.Domain                  | % { 
            
                $_.Text                  = Get-NetworkInfo -LocalHost | % { $_.DNS } | % { 
                
                    If ( $_ -ne $Null ) 
                    { 
                        $_ 
                    } 
                    
                    Else 
                    { 
                        "" 
                    } 
                } 
            }

            $Null                        = $GUI.Company.Focus()

            $OP                          = Show-WPFWindow -GUI $GUI
        
            If ( $OP -eq $True )
            { 
                Write-Theme -Action "Complete [+]" "Generating Certificate Information"

                $Info                    | % { 
                
                    $_.Organization      = $GUI.Company.Text 
                    $_.CommonName        = $GUI.Domain.Text 
                }

                Return $Info
            }

            Else 
            { 
                Write-Theme -Action "Cancelled [!]" "Abandoned Certificate Generation, using defaults" 11 12 15

                Return $Info
            }                                                                        #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Start-NetworkInfo # Collects all needed interface data _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( ParameterSetName =     "Local" ) ] [ Switch ]     $Local ,
            [ Parameter ( ParameterSetName =       "Map" ) ] [ Switch ]       $Map ,
            [ Parameter ( ParameterSetName =   "NetBIOS" ) ] [ Switch ]   $NetBIOS , 
            [ Parameter ( ParameterSetName = "Telemetry" ) ] [ Switch ] $Telemetry ,
            [ Parameter ( ParameterSetName =       "All" ) ] [ Switch ]       $All )

        If ( $All )
        {
            $Section                     = "Network Adapter" , "Network Host IP/MAC" ,  "NetBIOS / Domain" , "Certificate / Location" | % { "$_ Information" }
            $Subtable                    = 0..3

            $Splat                       = @{ 
            
                Items                    = ""
                Values                   = "" 
            }

            <# Network Information #>

            $Network                     = Get-NetworkInfo -LocalHost

            If ( $Network -ne $Null )
            {
                $Splat.Items             = ( $Network | GM | ? MemberType -like *Note* | % { $_.Name } )[5,1,8,7,0,6,2,10,9,4,3]
                $Splat.Values            = $Splat.Items | % { $Network.$_ }

                $Subtable[0]             = New-SubTable @Splat
            }

            If ( $Network -eq $Null )
            {
                Write-Theme -Action "Exception [!]" "Network Adapter information not found" 12 4 15
                Break
            }

            <# Network Host Map #>

            $HostList                    = Get-NetworkHosts | ? { $_.IPV4Class -like "*Class*" }

            If ( $HostList -ne $Null )
            {
                $Splat.Items             = $HostList | % { $_.IPV4Address }
                $Splat.Values            = $HostList | % { $_.MACAddress  }
                 
                $Subtable[1]             = New-Subtable @Splat
            }

            If ( $HostList -eq $Null )
            {
                Write-Theme -Action "Exception [!]" "Network Adapter information not found" 12 4 15
                Break
            }

            <# NetBIOS / NBTScan #>
            
            $NBT                         = Get-NBTSCAN

            $X                           = $NBT | ? { $_.ID -eq "<1C>" }
            
            $Control = If ( $X.Count -gt 1 )
            {
                $X[0]
            }

            If ( $X.Count -eq 1 )
            {
                $X
            }

            If ( $X.Count -eq 0 )
            {
                $NBT | ? { $_.IP -eq $Network.IPV4 -and $_.ID -like "*00*" -and $_.Type -eq "GROUP" }
            }

            If ( $Control -ne $Null )
            {
                $Splat.Items             = "IP" , "Host" , "Name" , "ID" , "Type" , "Service"
                $Splat.Values            = $Splat.Items | % { $Control.$_ }
                 
                $Subtable[2]             = New-Subtable @Splat
            }

            <# Telemetry Data #>

            $TD                          = Get-TelemetryData

            If ( $TD -ne $Null )
            {
                $Splat.Items             = ( $TD | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } )[2,6,4,0,3,1,7,8,5]
                $Splat.Values            = $Splat.Items | % { $TD.$_ }

                $Subtable[3]             = New-Subtable @Splat
            }

            If ( $TD -eq $Null )
            {
                Write-Theme -Action "Exception [!]" "Certificate information not loaded" 12 4 15
                Break
            }

            <# Generate Table #>
            
            $Panel                       = @{ 
            
                Title                    = "Domain Controller Bootstrap"
                Depth                    = 4 
                ID                       = 0..3 | % { $Section[$_]  | % { "( $_ )" } }
                Table                    = 0..3 | % { $Subtable[$_] }  
            }
        
            $Table                       = New-Table @Panel

            <# Display Table #>

            Write-Theme -Table $Table -Prompt "Press Enter to Continue"

            [ PSCustomObject ]@{ 
        
                LocalHost                = $Network
                NetworkHost              = $HostList
                NetBIOS                  = $Control
                Certificate              = $TD
            }
        }

        If ( $Local ) 
        { 
            Get-NetworkInfo -LocalHost
        }

        If ( $Map  )
        {
            Get-NetworkHosts      | ? { $_.IPV4Class -like "*Class*" }
        }

        If ( $NetBIOS )
        {
            Get-NBTSCAN 
        }

        If ( $Telemetry )
        {
            $TD
        }
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-NetworkStatistics # Like if netstat by itself wasn't so lame ___________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        $OP                              = netstat -ant | ? { $_ -like "*TCP*" -or $_ -like "*UDP*" }

        $OP                              | ? { $_ -notmatch '\*' } | % { 
        
            $X                           = $_.Split( ' ' ) | ? { $_.Length -gt 0 }
            
            [ PSCustomObject ]@{ 
            
                Protocol                 = $X[0]
                Local                    = $X[1]
                Foreign                  = $X[2]
                LinkState                = $X[3]
                Stream                   = $X[4] 
            }
        }

        $OP                              | ? { $_    -match '\*' } | % { 
        
            $X                           = $_.Split( ' ' ) | ? { $_.Length -gt 0 }

            [ PSCustomObject ]@{ 
            
                Protocol                 = $X[0]
                Local                    = $X[1]
                Foreign                  = "*:*"
                LinkState                = "*:*" 
                Stream                   = "*:*" 
            }
        }
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-Server # This commandlet does stuff _____________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

        $Info                            = Get-NetworkInfo -LocalHost
        $Report                          = Start-PingSweep
        $IPAddress                       = $Report.Failure | Select -First 1

        $Adapter                         = Get-NetRoute -AddressFamily IPV4 | ? { $_.DestinationPrefix -like "*$( $Info.IPV4 )/*" } | % { $_.InterfaceIndex }
        $Gateway                         = Get-NetRoute -AddressFamily IPv4 -InterfaceIndex $Adapter | ? { $_.DestinationPrefix -eq "0.0.0.0/0" } | % { $_.NextHop }
        
        $Splat                           = @{    
        
            InterfaceIndex               = $Adapter
            IPAddress                    = $IPAddress
            PrefixLength                 = $Info.CIDR
            DefaultGateway               = $Gateway
            ValidLifeTime                = [ TimeSpan ]::MaxValue
            PreferredLifeTime            = [ TimeSpan ]::MaxValue 
        }

        New-NetIpAddress @IPAddress
    
        $Splat                           = @{    
        
            InterfaceIndex               = $Adapter
            ServerAddresses              = "1.1.1.1" , "1.0.0.1" 
        }

        Set-DNSClientServerAddress @Splat
    
        0..10 | ? { ( Test-Connection -ComputerName "DSC$_" -Count 1 -EA 0 ) -eq $Null } | % { Rename-Computer "DSC$_" ; Restart-Computer }

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-PortScan # This will scan every port you tell it to _____________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( 
    
            [ ValidateNotNullOrEmpty () ] [ Parameter ( Position = 0 ) ][    Int ] $Port = 80 ,
            [ ValidateNotNullOrEmpty () ] [ Parameter ( Position = 1 ) ][ Switch ] $Return    )

        $Collection                     = Start-PingSweep
        $S                              = $Collection.Success
        $C                              = $S.Count
        $Report                         = 0..( $C - 1 )

        ForEach ( $A in 0..( $C - 1 ) )
        {
            Write-Progress -Activity "Scanning Network $( $S[$A] )" -PercentComplete ( ( $A / $C ) * 100 )

            If ( ( Test-Connection –BufferSize 32 –Count 1 –Quiet –ComputerName $S[$A] -EA 0 ) -ne $Null )
            {
                Try 
                { 
                    New-Object System.Net.Sockets.TcpClient -Args ( $S[$A] , $Port ) -EA 0 | % { 
                        
                        $Report[$A]     = [ PSCustomObject ]@{
                    
                            ID          = $A
                            IPAddress   = $S[$A]
                            Client      = $_.Client
                            Connected   = $_.Connected
                        } 
                    }
                }
                
                Catch 
                {
                    [ Void ]$_.Exception.Message
                    
                    $Report[$A]         = [ PSCustomObject ]@{ 
                    
                        ID              = $A
                        IPAddress       = $S[$A]
                        Connected       = "False" 
                    }
                }
            }
        }

        If ( $Return ) 
        { 
            Return $Report.Client       | FT -AutoSize 
        }
        
        Else 
        { 
            Return $Report 
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-XAML # XAML Glossary and Generation Engine _____________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ][ OutputType ( "String" ) ] Param ( 
        
            [ Parameter ( ParameterSetName =     "Certificate" ) ][ Switch ] $Certificate    ,
            [ Parameter ( ParameterSetName =           "Login" ) ][ Switch ] $Login          ,
            [ Parameter ( ParameterSetName =     "New Account" ) ][ Switch ] $NewAccount     ,
            [ Parameter ( ParameterSetName =  "HybridDSCPromo" ) ][ Switch ] $HybridDSCPromo ,
            [ Parameter ( ParameterSetName =         "DCFound" ) ][ Switch ] $DCFound        ,
            [ Parameter ( ParameterSetName =         "DSCRoot" ) ][ Switch ] $DSCRoot        ,
            [ Parameter ( ParameterSetName =    "ProvisionDSC" ) ][ Switch ] $ProvisionDSC   ,
            [ Parameter ( ParameterSetName =         "Service" ) ][ Switch ] $Service        ,       
            [ Parameter ( ) ]                                     [ Switch ] $Testing        )

            $XML                        = @{ }
            $Schema                     = "http://schemas.microsoft.com/winfx/2006/xaml"
            $Author                     = "Secure Digits Plus LLC"

            $CS                         = GCIM Win32_OperatingSystem | % { $_.Caption }
            $B                          = $False , $True 
            $YZ                         = "[X]" , "[_]"

            $M                          = 0..3 | % { IEX "`$M$_ = 0..120 | % { @( '¯' , '_' , ' ' , '-' )[$_] * `$_ }" }

            $Glossary                   = 
            "   `$W = 'Width'             " , "   `$H = 'Height'            " , "  `$MA = 'Margin'          " , 
            "  `$MN = 'Menu'              " , " `$MNI = 'MenuItem'          " , "  `$HD = 'Header'          " , 
            "  `$GB = 'GroupBox'          " , " `$GBI = 'GroupBoxItem'      " , "  `$CB = 'ComboBox'        " , 
            " `$CBI = 'ComboBoxItem'      " , " `$CHK = 'CheckBox'          " , "  `$TB = 'TextBox'         " , 
            " `$TBL = 'TextBlock'         " , "   `$G = 'Grid'              " , "  `$RD = 'RowDefinition'   " , 
            "  `$CD = 'ColumnDefinition'  " , "  `$GC = 'Grid.Column'       " , " `$GCS = 'Grid.ColumnSpan' " , 
            "  `$GR = 'Grid.Row'          " , " `$GRS = 'Grid.RowSpan'      " , "  `$SI = 'SelectedIndex'   " , 
            "  `$LA = 'Label'             " , "  `$BU = 'Button'            " , "  `$CO = 'Content'         " , 
            "   `$Q = 'Name'              " , "  `$SE = 'Setter'            " , "  `$PR = 'Property'        " , 
            "  `$BG = 'Background'        " , "  `$RB = 'RadioButton'       " , "  `$TW = 'TextWrapping'    " , 
            "  `$BO = 'Border'            "
            
            $Glossary                   | % { IEX $_ }

            $GRD , $GCD                 = $RD , $CD | % { "$G.$_`s" }

            $Glossary                  += " `$GRD = '$GRD'" , " `$GCD = '$GCD'" 

            $HAL                        = "Left" ,   "Center" ,  "Right" | % { "HorizontalAlignment = '$_'" }
            
            $HCAL                       = $HAL | % { $_.Replace( 'lA' , 'lContentA' ) }

            $VAL                        =   "Top" ,   "Center" , "Bottom" | % { "VerticalAlignment = '$_'" }
            
            $VCAL                       =  $VAL | % { $_.Replace( 'lA' , 'lContentA' ) } 

            $SP                         = 0..20 | % { "    " * $_ }

            $VC , $VV                   = "Collapsed" , "Visible" | % { "Visibility = '$_'" }

            $CF ,  $OK ,  $CA           = "Confirm" , "Start" , "Cancel"
                    
            $PW , $PWB , $PWC           = "Password" | % { "$_" , "$_`Box" , "$_`Char" }

            $GFX                        = Resolve-HybridDSC -Graphics

            $Z                          = 0

        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $Certificate ) # Certificate/Domain XAML                                [
        {#___________________________________________________________________________/

            $Title                      = "Certificate Info"       
                
             # ____   _________________________
             #//¯¯\\__[_______ Header ________] 
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 7 ; 10 , 9 ) | % { $SP[$_] }

                $Y      = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , "  Title = '$Author | Hybrid @ $Title'" ,  
                             "  $W = '350'" , " $H = '200'" , "Topmost = 'True' " , "   Icon = '$( $GFX.Icon )'" , "$( $HAL[1] )" , 
                             "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 3 , 9 , 9 , 9 , 6 , 4 , 5 , 6 , 6 , 5 , 5 , 6 , 7 , 7 , 6 , 6 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "<$GB" , " $HD = 'Company Information / Certificate Generation'" , "  $W = '330'" , " $H = '160'" , "  $( $VAL[0] ) >" , 
                             "<$G>" , "<$GRD>" ; 2 , "" | % { "<$RD $H = '$_*' />" } ; "</$GRD>" , "<$G $GR = '0' >" , "<$GCD>" ; 
                             "" , "2.5" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ; 0..1 | % { "<$RD $H = '*' />" } ; "</$GRD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[      User Input       ]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( @( 6 ) * 4 ) | % { $SP[$_] }

                $Y      = @( ( 0 , "Company" ) , ( 1 , "Domain" ) | % { 

                            "<$TBL $GR = '$( $_[0] )' $GC = '0' $MA = '10' TextAlignment = 'Right' >$( $_[1] ):</$TBL>" ,
                            "<$TB $Q = '$( $_[1] )' $GR = '$( $_[0] )' $GC = '1' $H = '24' $MA = '5' />" } )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[        Framing        ]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5 ; 5..7 ; 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "</$G>" , "<$G $GR = '1' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" )

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Controls ______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 6 , 6 ) | % { $SP[$_] }

                $Y      = @( ( 0 , "Ok" ) , ( 1 , "Cancel" ) | % { "<$BU $Q =  '$( $_[1] )' $CO = '$( $_[1] )' $GC = '$( $_[0] )' $MA = '10' />" } )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Header ________]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5..2 ) | % { $SP[$_] }

                $Y      = @( "</$G>" , "</$G>" , "</$GB>" , "</Window>" )

                $XML[5] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
        }

        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $Login -or $NewAccount ) # Login / New Account                          [
        {#___________________________________________________________________________/

            If ( $Login )
            { 
                $Title  = "AD Login"
                $Header = "Enter Directory Services Admin Account"
                $VX     = ""
            }
            
            If ( $NewAccount )
            {
                $Title  = "Account Designation"
                $Header = "Enter Username and Password"
                $VX     = $VC
            }

            $X          = @( 2 ; @( 13 ) * 7 ; 10 , 9 ) | % { $SP[$_] }

            $Y          = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , 
                             "  Title = '$Author | Hybrid @ $Title'" , "  $W = '480'" , " $H = '280'" , "Topmost = 'True' " , 
                             "   Icon = '$( $GFX.Icon )'" , "$( $HAL[1] )" , "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
                $X      = @( 3 , 9 , 9 , 9 , 6 , 4 , 5 , 6 , 6 , 5 , 5 , 6 , 7 , 7 , 6 , 6 , 7 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "<$GB" , " $HD = '$Header'" , "  $W = '450'" , " $H = '240' $MA = '5'" , "  $( $VAL[1] )>" ,
                             "<$G>" , "<$GRD>" ; "2" , "1.25" | % { "<$RD $H = '$_*' />" } ; "</$GRD>" , "<$G $GR = '0' >" ,
                             "<$GCD>" ; "" , "3" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" ; "<$GRD>" ;
                             0..2 | % { "<$RD $H = '*' />" } ; "</$GRD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_____ User Input ______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( @( 6 , 7 ) * 6 ) | % { $SP[$_] }

                $Y      = @( "<$TBL $GC = '0' $GR = '0' $MA = '10' TextAlignment = 'Right' >" , "Username:</$TBL>" ,
                             "<$TB $Q = 'Username' $GC = '1' $GR = '0' $H = '24' $MA = '5' >" , "</$TB>" ,
                             "<$TBL $GC = '0' $GR = '1' $MA = '10' TextAlignment = 'Right' >" , "Password:</$TBL>" ,
                             "<$PWB $Q = 'Password' $GC = '1' $GR = '1' $H = '24' $MA = '5' $PWC = '*' >" , "</$PWB>" ,
                             "<$TBL $GC = '0' $GR = '2' $MA = '10' TextAlignment = 'Right' >" , "Confirm:</$TBL>" ,
                             "<$PWB $Q =  'Confirm' $GC = '1' $GR = '2' $H = '24' $MA = '5' $PWC = '*' >" , "</$PWB>" )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5 ; 5..7 ; 7 , 6 , 6 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "</$G>" , "<$G $GR = '1' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" , "<$GRD>" ;
                             0..1 | % { "<$RD $H = '*'/>" } ; "</$GRD>" )

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Controls ______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 6 ; @( 6 , 7 ) * 3 ; 6..3 ) | % { $SP[$_] }

                $Y      = @( "<RadioButton $Q = 'Switch' $GR = '0' $GC = '0' $CO = 'Change' $($VAL[1]) $($HAL[1]) $VX/>" ,
                              "<$TB $Q = 'Port' $GR = '0' $GC = '1' $($VAL[1]) $($HAL[1]) $W = '120' IsEnabled = 'False' $VX>" ,
                              "389</TextBox>" , "<$BU $Q = 'Ok' $CO = 'Ok' $GC = '0' $GR = '1' $MA = '5' >" , "</$BU>" ,
                              "<$BU $Q = 'Cancel' $CO = 'Cancel' $GC = '1' $GR = '1' $MA = '5' >" , "</$BU>" , "</$G>" ,
                              "</$G>" , "</$GB>" , "</Window>" )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
        }

        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $HybridDSCPromo ) # Domain Controller Promotion Configuration           [
        {#___________________________________________________________________________/
             
             $Title     = "Desired State Controller Promotion"
             # ____   _________________________
             #//¯¯\\__[_______ Header ________]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 7 ; 10 , 9 ) | % { $SP[$_] }

                $Y      = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , 
                             "  Title = '$Author | Hybrid @ $Title'" , "  $W = '800'" , " $H = '800'" , "Topmost = 'True' " ,
                             "   Icon = '$( $GFX.Icon )'" , "$( $HAL[1] )" , "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Framing _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2..4 ; 4 , 3 ) | % { $SP[$_] } 

                $Y      = @( "<$G>" , "<$GRD>" ; '20' , '*' | % { "<$RD $H = '$_' />" } ; "</$GRD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[________ Menu _________]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $Menu   = 'Forest' , 'Tree' , 'Child' , 'Clone'

                $Action = "Domain" | % { "Forest" , "$_ Tree" , "$_ Child" , "$_`Controller" } | % { "Install-ADDS$_" }

                $X      = @( 3..5 ; 5 , 5 ; 5..3 ) | % { $SP[$_] }

                $Y      = @( "<$MN $GR = '0' $H = '20' >" , "<$MNI $HD = 'New' >" ;
                          0..3 | % { "<$MNI $Q = '$($Menu[$_])' $HD = '$($Action[$_])' IsCheckable = 'True' />" } ;
                          "</$MNI>" , "</$MN>" )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[______ Open Body ______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = 3 , 12 , 13 , 10 , 10 , 13 , 13 | % { $SP[$_] }

                $Y      = "<$GB" , "   $GR = '1'" , " $HD = '[ Hybrid-DSC Domain Service Configuration ]'" ,
                          "$( $HAL[1] )" , "  $( $VAL[1] )" , "  $W = '760'" , " $H = '740' >"

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Framing _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 4..7 ; 7 , 6 ; 6..8 ; 8 , 7 ) | % { $SP[$_] }

                $Y      = @( "<$G>" , "<$G $GR = '1' $MA = '10' >" , "<$GRD>" ; '' , '10' | % { "<$RD $H = '$_*' />" } ;
                          "</$GRD>" , "<$G $GR = '0' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_____ Domain Mode _____]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $LI     = @( ) ; $ED = @( "00" , "03" ; "08" , 12 | % { $_ , "$_ R2" } ; 16 , 19 )

                $R2     = $( If ( $CS -like "*R2*" ) { 1 } Else { 0 } )

                0..7    | % { $I  = $ED[$_] ; $J  = "False"
                        If ( $CS -like "*$I*" ) { If ( $R2 -eq 1 -and $_ -in    3 , 5 ) { $J = "True" }
                                                  If ( $R2 -eq 0 -and $_ -notin 3 , 5 ) { $J = "True" } }

                $LI    += "<$CBI $CO = 'Windows Server 20$I' IsSelected = '$J' />" }

                $LI[0]  = $LI[0].Replace( "2000" ,"2000 ( Default )" )

                0..1 | % {

                    $J  = ( "ForestMode" , "DomainMode" )[$_]

                    $X  = @( 7 , 8 ; @( 9 ) * 8 ; 8 , 7 ) | % { $SP[$_] }

                    $Y  = @( "<$GB $Q = '$J`Box' $HD = '$J' $GC = '$_' $MA = '5' $VC >" ,
                          "<$CB $Q = '$J' $H = '24' $SI = '0' >" ; @( $LI ) ; "</$CB>" , "</$GB>" )

                    $Z  = 0..11 | % { $X[$_] + $Y[$_] }

                    If ( $_ -eq 0 ) { $ForID = $Z } Else { $DomID = $Z } 
                }

                $ParID  = "ParentDomainName" | % {

                $X  = @( 6 , 7 , 6 ) | % { $SP[$_] } ;

                $Y  = "<$GB $Q = '$_`Box' $HD = '$($_.Replace('D',' D').Replace('N',' N'))' $GC = '0' $MA = '5' $VC >" ,
                      "<$TB $Q = '$_' Text = '&lt;Domain Name&gt;' $H = '20' $MA = '5' />" , "</$GB>"

                Return 0..2 | % { $X[$_] + $Y[$_] } }

                    $XML[5] = @( $ForID ; $DomID ; $ParID )

                    $X  = @( 6 , 6 , 7 , 8 , 8 , 7 , 7 , 8 , 8 , 7 ) | % { $SP[$_] }

                    $Y  = @( "</$G>" , "<$G $GR = '1' >" , "<$GCD>" ; '' , '2.5' | % { "<$CD $W = '$_*' />" } ;"</$GCD>" ,
                             "<$GRD>" ; '3.5' , '' | % { "<$RD $H = '$_*' />" } ; "</$GRD>" )

                    $XML[6] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[__ Services Selection _]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $FT = Get-DSCFeatureList ; $FTL = Get-DSCFeatureList -Underscore

                    $SVC = 0..16 | % { "<$TBL $GC = '0' $GR = '$_' $MA = '5' TextAlignment = 'Right' >$( $FT[$_] ):</$TBL>" ,
                      "<$CHK $GC = '1' $GR = '$_' $MA = '5' $Q = '$( $FTL[$_] )' IsEnabled = 'True' IsChecked = 'False' />" }

                    $X  = @( 6..9 ; 9 , 8 , 8 ; @( 9 ) * 17 ; @( 8 ) * 35 ; 7 , 6 ) | % { $SP[$_] }

                    $Y  = @( "<$GB $HD = 'Service Options' $GR = '0' $GC = '0' $MA = '5' >" , "<$G $GR = '0' $GC = '0' >" ,
                             "<$GCD>" ; '5' , '' | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ;
                             0..16 | % { "<$RD $H =  '*' />" } ; "</$GRD>" ; @( $SVC ) ; "</$G>" , "</$GB>" )

                    $XML[7] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_ Domain Name Options _]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $VA = '10 , 0 , 10 , 0' ; $BB = "BorderBrush = '{x:Null}'"

                    $VX = @( "Database" , "Sysvol" , "Log" | % { "$_`Path" } ; "Credential" ;
                          @( "Domain" | % { $_ , "New$_" } | % { $_ , "$_`NetBIOS" } ; "Site" ) | % { "$_`Name" } ;
                          "ReplicationSourceDC" )

                    $DomID  = ForEach ( $k in 0..9 )
                    {
                        $WX = $VX[$K]

                        If ( $K -eq 3 )
                        {
                            "<$GB $GR = '3' $HD = '$WX' Name = '$WX`Box' $VV $BB >" , "<$G>" , "<$GCD>" ;
                            "" , "3" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" ,
                            "<$BU $CO = '$WX' $Q = '$WX`Button' $GC = '0' />" ,
                            "<$TB $H = '20' $MA = '$VA' Name = '$WX' $GC = '1' />" , "</$G>" , "</$GB>"
                        }

                        Else
                        {
                            "<$GB $GR = '$K' $HD = '$WX`' $Q = '$WX`Box' $VV $BB >" ,
                            "<$TB $H = '20' $MA = '$VA' $Q = '$WX' />" , "</$GB>"
                        }
                    }

                    $X  = @( 6 , 7 ; @( 8 ) * 10 ; 7 ; @( 7 , 8 , 7 ) * 3 ; 7..10 ; 10 , 9 , 9 , 9 , 8 , 7 ; @( 7 , 8 , 7 ) * 6 ; 6 ) | % { $SP[$_] }

                    $Y  = @( "<$G $GR = '0' $GC = '1' $MA = '$VA' >" , "<$GRD>" ; 0..9 | % { "<$RD $H = '*' />" } ;
                             "</$GRD>" ; @( $DomID ) ; "</$G>" )

                    $XML[8] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[__ Role Designations __]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                   $RCN = "Install DNS" , "Create DNS Delegation" , "No Global Catalog" , "Critical Replication Only"
                   $RID = $RCN | % { $_.Replace( " " , "" ) }

                    $Roles = 0..3 | % { "<$TBL $GR = '$_' TextAlignment = 'Right' $MA = '5' IsEnabled = 'True' >$( $RCN[$_] ):</$TBL>" ,
                                        "<$CHK $Q = '$( $RID[$_] )' $GR = '$_' $GC = '1' $MA = '5' IsEnabled = 'True' IsChecked = 'False' />" }

                    $X  = @( 6..9 ; 9 , 9 , 9 , 8 , 8 , 9 , 9 ; @( 8 ) * 9 ; 7 , 6 ) | % { $SP[$_] }

                    $Y  = @( "<$GB $GR = '1' $HD = 'Roles' $MA = '5' >" , "<$G>" , "<$GRD>" ; 0..3 | % { "<$RD $H = '*' />" } ; 
                             "</$GRD>" , "<$GCD>" ; '5' , '' | % { "<$CD $W = '$_*' />" } ; "</$GCD>" ; @( $Roles ) ; "</$G>" , "</$GB>" ) 

                    $XML[9] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_ DSRM/Initialization _]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $CF ,  $OK ,  $CA = "Confirm" , "Start" , "Cancel"
                    $PW , $PWB , $PWC = "Password" | % { "SafeModeAdministrator$_" , "$_`Box" , "$_`Char" }

                    $X  = @( 6..9 ; 9 , 8 , 8 , 9 , 9 , 8 , 8 , 9 , 8 , 8 , 9 , 8 , 8 ; 8..6 ) | % { $SP[$_] }

                    $Y  = @( "<$GB $GR = '1' $GC = '1' $HD = 'Initialization' $MA = '5' >" , "<$G>" , "<$GRD>" ;
                          0..1 | % { "<$RD $H = '*' />" } ; "</$GRD>" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ;
                          "</$GCD>" )

                    $C  = 0
                    $Y += $PW , $CF | % { "<$GB $GR = '0' $GC = '$C' $HD = '$_' >" , "<$PWB $Q = '$_' $H = '20' $MA = '5' $PWC = '*' />" , "</$GB>"
                        
                        [ Void ]$C ++ 
                    }

                    $C  = 0
                    $Y += $OK , $CA | % { "<$BU $Q = '$_' $GR = '1' $GC = '$C' $CO = '$_' $MA = '5' $W = '100' $H = '20' />"
                        [ Void ]$C ++ 
                    }

                    $Y += "</$G>" , "</$GB>"

                    $XML[10] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Framing _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
                    $X  = @( 5..0 ) | % { $SP[$_] }

                    $Y  = "</$G>" , "</$G>" , "</$G>" , "</$GB>" , "</$G>" , "</Window>"

                    $XML[11] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
        }

        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $DCFound ) # Domain Controller Found                                    [
        {#___________________________________________________________________________/

             #  ____   _________________________
             # //¯¯\\__[________ Header _______]
             # ¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 4 ; 10 , 13 , 13 , 9 ) | % { $SP[$_] }

                $Y      = "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , "  $W = '350'" ,
                          "  $H = '200'" , "$( $HAL[1] )" , "Topmost = 'True' " , "   Icon = '$( $GFX.Icon )'" ,
                          "  WindowStartupLocation = 'CenterScreen' >"

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #  ____   _________________________
             # //¯¯\\__[_______ Framing _______]
             # ¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 4 , 5 , 6 , 6 , 5 , 5 , 6 , 7 , 7 , 6 , 6 , 7 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "<$G>" , "<$GRD>" ; "3" , "" | % { "<$RD $H = '$_*' />" } ; "</$GRD>" , "<$G $GR = '0' >" ,
                          "<$GCD>" ; "" , "2" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ;
                          0..2 | % { "<$RD $H = '*' />" } ; "</$GRD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #  ____   _________________________
             # //¯¯\\__[      User Input       ]
             # ¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = 0..2 | % { 6 , 7 , 6 } | % { $SP[$_] }

                $Y      = ( 0 , "Controller" , "DC" ) , ( 1 , "DNS" , "Domain" ) , ( 2 , "NetBIOS" , "NetBIOS" ) | % {
                        "<$TBL $GC = '0' $GR = '$($_[0])' $MA = '10' $($VAL[1]) $($HAL[2]) >" , "$($_[1]) Name:</$TBL>" ,
                        "<$LA $Q = '$($_[2])' $GC = '1' $GR = '$($_[0])' $($VAL[1]) $H = '24' $MA = '10' />" }

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5 , 5 , 6 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "</$G>" , "<$G $GR = '1' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" )

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Controls ______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 6 ; 6..3 ) | % { $SP[$_] }

                $Y      = @( ( 0 , "Ok" ) , ( 1 , "Cancel" ) | % { "<$BU $Q = '$( $_[1] )' $CO = '$( $_[1] )' $GC = '$( $_[0] )' $GR = '1' $MA = '10' />" } ; 
                          "</$G>" , "</$G>" , "</Window>" )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] } 
            }
        
        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $DSCRoot ) # Desired State Controller Root Install                      [
        {#___________________________________________________________________________/

             $Title = "DSC Root Installation"

             # ____   _________________________
             #//¯¯\\__[_______ Header ________]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 7 ; 10 , 9 ) | % { $SP[$_] }

                $Y      = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , "  Title = '$Author | Hybrid @ $Title'" , 
                             "  $W = '640'" , " $H = '450'" , "Topmost = 'True' " , 
                             "   Icon = '$( $GFX.Icon )'" , "$( $HAL[1] )" ,  "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 , 4 , 5 , 4 , 4 ; @( 5 ) * 5 ; 4 , 4 ; @( 5 ) * 4 ; 4 ) | % { $SP[$_] }

                $Y      = @( "<$G>" , "<$G.Background>" , "<ImageBrush Stretch = 'UniformToFill' ImageSource = '$( $GFX.Background )' />" ,
                          "</$G.Background>" , "<$GRD>" ; 250 , "*" , "*" , 40 , 20 | % { "<$RD $H = '$_' />" } ; "</$GRD>" , "<$GCD>" ;
                          "" , 2 , 2 , "" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Framing _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 4 , 4 , 5 , 4 , 4 , 6 , 5 , 4 , 4 , 4 , 3 , 3 , 2 ) | % { $SP[$_] }

                $Y      = @( "<Image $GR = '0' $GC`Span = '4' $( $HAL[1] ) $W = '640' $H = '250' Source = '$( $GFX.Banner )' />" ,
                       "<$TBL $GR = '1' $GC = '1' $GC`Span = '2' $( $HAL[1] ) Padding = '5' Foreground = '#00FF00' FontWeight = 'Bold' $( $VAL[1] )>" , 
                       "Hybrid - Desired State Controller - Dependency Installation Path" , "</$TBL>" , 
                       "<$TB $GR = '2' $GC = '1' $GC`Span = '2' $H = '22' TextWrapping = 'Wrap' $MA = '10' $( $HCAL[1] ) $Q = 'Install' >" ,
                       "<$TB.Effect>" , "<DropShadowEffect/>" , "</$TB.Effect>" , "</$TB>" ; 
                    
                       ( 1 , "Start" ) , ( 2 , "Cancel" ) | % { "<$BU $GR = '3' $GC = '$( $_[0] )' $Q = '$( $_[1] )' $CO = '$( $_[1] )' $MA = '10' />" } ; 
                    
                       "</$G>" , "</Window>" )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
            }


        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $ProvisionDSC ) # Provision Desired State Controller Server             [
        {#___________________________________________________________________________/

            $Title = "DSC Deployment Share"

             # ____   _________________________
             #//¯¯\\__[_______ Header ________]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 7 ; 12 , 10 , 9 ) | % { $SP[$_] }

                $Y      = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , "  Title = '$Author | Hybrid @ $Title'" , 
                             "  $W = '640'" , " $H = '960'" , "Topmost = 'True' " , "   Icon = '$( $GFX.Icon )'" , " ResizeMode = 'NoResize'" , "$( $HAL[1] )" ,  
                             "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[__ Window Resources ___]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                 $X = @(1..3;@(3)*4;3..6;8,8,8,7,11,11;6..2;2,3,3,3,2,2,3,3,3,3,3,2,1) | % { $SP[$_] }

                 $Y = @( "<Window.Resources>" , "<Style TargetType    = 'Label' x:Key = 'HeadLabel' >" ; 
    
                      ( "$TBL.TextAlignment" , "Center" ) , ( "FontWeight" , "Heavy" ) , ( "FontSize" , 18 ) , ( $MA , 5 ) , 
                      ( "Foreground" , "White" ) | % { "<$SE $PR = '$( $_[0] )' Value = '$( $_[1] )' />" } ;

                        "<$SE $PR = 'Template' >" , "<$SE.Value>" , "<ControlTemplate TargetType = 'Label' >" , "<$BO CornerRadius = '2,2,2,2' " ,
                        "$BG = '#FF0080FF' ", "$BO`Brush = 'Black'"  , "$BO`Thickness = '3'>" , "<ContentPresenter x:Name = 'contentPresenter'" , 
                        "  ContentTemplate = '{ TemplateBinding ContentTemplate }'" , "  $MA = '5' /> " , "</$BO>" , "</ControlTemplate>" , 
                        "</$SE.Value>" , "</$SE>" , "</Style>" , "<Style TargetType = 'RadioButton' x:Key = 'RadButton' >" ;

                      ( "HorizontalAlignment" , "Center" ) , ( "VerticalAlignment" , "Center" ) , ( "Foreground" , "Black" ) | % { 
                        
                        "<$SE $PR = '$( $_[0] )' Value = '$( $_[1] )' />" } ; "</Style>" , "<Style TargetType = '$TB' x:Key = 'TextBro'>" ; 

                      ( "VerticalContentAlignment" , "Center" ) , ( "Margin" , 2 ) , ( "TextWrapping" , "Wrap" ) , ( "Height" , 24 ) | % { 

                        "<$SE $PR = '$( $_[0] )' Value = '$( $_[1] )' />" } ; "</Style>" , "</Window.Resources>" )
        
                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

                $X = @(1,2,3,3,3,2,2,3,6,2,2,3,2,5,5,5,5,3,5,5,4,5,4) | % { $SP[$_] }

                $Y = @( "<$G>" , "<$GRD>" ; 250, "*" , 40 | % { "<$RD $H = '$_' />" } ; "</$GRD>" , "<$G.$BG>" ; 
                        "<ImageBrush Stretch = 'UniformToFill'" , "ImageSource = '$( $GFX.Background )' />" , "</$G.$BG>" , 
                        "<Image $GR = '0'" , "   Source = '$( $GFX.Banner )'/>" , "<TabControl $GR = '1'" ; 
            
                        "{x:Null}" | % { "$BG = '$_'" , "$BO`Brush = '$_'" , "Foreground = '$_'" } ; "$( $HAL[1] )>" ;
                        "<TabItem $HD = 'Stage Deployment Server'" , "$BO`Brush = '{x:Null}'" , "$W = '280' >" , 
                        "<TabItem.Effect>" , "<DropShadowEffect/>" , "</TabItem.Effect>" )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[_______ Staging _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

                $X = @( 4,5,6,6,5,5;@(8)*4;6,7;@(8)*6;7,7;@(10)*3;7,8,9,9,8,8,8,7;@(7,8,7)*3;7,8,9,9,8;@(8,9,8)*2;7,6,5 ) | % { $SP[$_] }

                $Y = @( "<$G>" , "<$GRD>" ; 6 , 5 | % { "<$RD $H = '$_*' />" } ; "</$GRD>" , "<$GB $GR = '0'" , "$MA = '10'" , 
                        "Padding = '5'" , "Foreground = 'Black'" , "$BG = 'White'>" , "<$G $GR = '0'>" , "<$GRD>" ;
            
                        "50,30,*,*,*,*".Split(',') | % { "<$RD $H = '$_'/>" } ; "</$GRD>" , 
                        "<$LA $CO = 'Deployment Share Settings'" , "Style = '{ StaticResource HeadLabel }'" , "Foreground = 'White'" , 
                        "$GR = '0'/>" , "<$G $GR = '1'>" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" ; 
            
                        ( 0 , "Legacy MDT" , "Legacy" ) , ( 1 , "PSD-Remaster" , "Remaster" ) | % { 
            
                        "<RadioButton $GC = '$( $_[0] )' $CO = '$( $_[1] )' $Q = '$( $_[2] )' Style = '{ StaticResource RadButton }' />" } ; "</$G>" ; 

                        ( 2 , "Drive Label" , "Drive" ) , ( 3 , "Directory Path" , "Directory" ) , ( 4 , "Samba Share" , "Samba" ) | % { 
                        
                            "<$GB $GR = '$( $_[0] )' $HD = '$( $_[1] )'>" , 
                            "<$( If ( $_[0] -eq 2 ) { "$CB $H = '24' $MA = '2'" } Else { "$TB Style = '{ StaticResource TextBro }'" }) $Q = '$( $_[2] )' />" , "</$GB>"
                        
                        } ; "<$G $GR = '5'>" , "<$GCD>" ; "" , 2 | % { "<$CD $W = '$_*' />" } ; "</$GCD>"

                        ( 0 , "PS Drive" , "DSDrive" ) , ( 1 , "Description" , "Description" ) | % { 
                        
                            "<$GB $GC = '$( $_[0] )' $HD = '$( $_[1] )'>" , "<$TB Style = '{ StaticResource TextBro }' $Q = '$( $_[2] )' />" , "</$GB>" } ; 
                            
                        "</$G>" , "</$G>" , "</$GB>" )

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[__ BITS / IIS Setup ___]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

                $X = @(5;@(7)*4;6..8;@(8)*4;7,7,7,8,9,9,8,8,8,7;@(7,8,7)*3;6..3) | % { $SP[$_] }
            
                $Y = @( "<$GB $GR = '1' " , "  $MA = '10'" , "  Padding = '5' " , "  Foreground = 'Black'" , "  $BG = 'White'>" , 
                        "<$G>" , "<$GRD>" ; "50,30,*,*,*".Split(',') | % { "<$RD $H = '$_' />" } ; "</$GRD>" , 
                        "<$LA $CO = 'BITS / IIS Settings' Style = '{ StaticResource HeadLabel }' Foreground = 'White' $GR = '0'/>" , 
                        "<$G $GR = '1'>" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" ;

                        ( 0 , "Install" , "Install / Configure IIS" ) , ( 1 , "Skip" , "Skip IIS Setup" ) | % { 

                            "<RadioButton $GC = '$( $_[0] )' $Q = 'IIS_$( $_[1] )' $CO = '$( $_[2] )' Style = '{ StaticResource RadButton }'/>"

                        } ; "</$G>" ;

                        ( 2 , "Name" , "Name" ) , ( 3 , "App Pool" , "AppPool" ) , ( 4 , "Virtual Host" , "Proxy" ) | % { 
                        
                            "<$GB $GR = '$( $_[0] )' Header = '$( $_[1] )'>" , "<$TB Style = '{ StaticResource TextBro }' $Q = 'IIS_$( $_[2] )' />" , "</$GB>"
                    
                        } ; "</$G>" , "</$GB>" , "</$G>" , "</TabItem>" )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[____ Company Info _____]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            $X = @(3..5;4;4..6;6,5,5;@(7)*4;6,7;@(8)*6;7,7;@(7,8,7)*2;7,8,9,9,8;@(8,9,8)*2;7,7;@(8,9,9,8)*2;@(8,9,8,8)*2;7..5 ) | % { $SP[$_] }

            $Y = @( "<TabItem $HD = 'Image Info' $( $HAL[1] ) $W = '280' BorderBrush = '{x:Null}' >" , "<TabItem.Effect>" , "<DropShadowEffect/>" , "</TabItem.Effect>" , 
            
            "<$G>" , "<$GRD>" ; 7 , 5 | % { "<$RD $H = '$_*'/>" } ; "</$GRD>" , "<$GB $GR = '0'" , "  $MA = '10'" , "  Padding = '5' " , "  Foreground = 'Black'" , "  $BG = 'White'>" , 
            
            "<$G>" , "<$GRD>" ; "50,*,*,*,*,*".Split(',') | % { "<$RD $H = '$_' />" } ; "</$GRD>" , 
            
            "<$LA $GR = '0' Style = '{ StaticResource HeadLabel }' $CO = 'Image Branding Settings' />" ;
            "<$GB $GR = '1' $HD = 'Company $Q'>"       , "<$TB Style = '{ StaticResource TextBro }' $Q = 'Company' />" , "</$GB>" , 
            "<$GB $GR = '2' $HD = 'Support Website' >" , "<$TB Style = '{ StaticResource TextBro }' $Q = 'WWW' />" , "</$GB>" ; 
             "<$G $GR = '3'>" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" ; 
            
            ( 0 , "Phone" ) , ( 1 , "Hours" ) | % {
            
                "<$GB $GC = '$( $_[0] )' $HD = 'Support $( $_[1] )'>" , "<$TB Style = '{ StaticResource TextBro }' $Q = '$( $_[1] )' />" , "</$GB>" 
                
            } ; "</$G>" , "<$G $GR = '4' $GR`Span = '2' >" , "<$GCD>" ;
            
            "*" , 100 | % { "<$CD $W = '$_'/>" } ; "</$GCD>" , "<$GRD>" ; 0..1 | % { "<$RD $H = '*' />" } ; "</$GRD>" ; 
            
            ( "Logo [ 120x120 ]" , 0 , "Logo" ) , ( "Background" , 1 , "Background" ) | % {
            
                "<$GB $HD = '$( $_[0] )' $GR = '$( $_[1] )' $GC = '0'>" , 
                "<$TB Style = '{ StaticResource TextBro }' $W = '400' $GC = '1' $Q = '$( $_[2] )' />" , 
                "</$GB>" , "<$BU $MA = '5,15,5,5' $H = '20' $GR = '$( $_[1] )' $GC = '1' $CO = '$( $_[2] )' $Q = '$( $_[2] )Browse' />" 
                
            } ; "</$G>" , "</$G>" , "</$GB>" )

            $XML[5] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[_ Network Credentials _]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        
            $X = @(5;@(7)*4;6,7;@(8)*4;7,7;@(7,8,7)*2;7,8,9,9,8;@(8,9,8)*2;7..2) | % { $SP[$_] }
            
            $Y = @( "<$GB $GR = '1'" , "  $MA = '10'" , "  Padding = '5'" , "  Foreground = 'Black'" , "  $BG = 'White'>" , "<$G>" , "<$GRD>" ; 
            "50,*,*,*".Split(',') | % { "<$RD $H = '$_' />" } ; "</$GRD>" ,
                    
            "<$LA $GR = '0' Style = '{ StaticResource HeadLabel }' $CO = 'Domain / Network Credentials' />" ;
                    
                    ( 1 , "Branch Name" , "Branch" ) , ( 2 , "NetBIOS Domain" , "NetBIOS" ) | % { 

                        "<$GB $GR = '$( $_[0] )' $HD = '$( $_[1] )' >" , "<$TB Style = '{ StaticResource TextBro }' $Q = '$( $_[2] )' />" , "</$GB>" 
                        
                    } ; "<$G $GR = '3'>" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" ; 
                    
                    ( 0 , "Account" , "$TB Style = '{ StaticResource TextBro }'" , "User" ) , ( 1 , "Password" , "$PWB $MA = '5'" , "Pass' PasswordChar = '*" ) | % { 

                        "<$GB $GC = '$( $_[0] )' $HD = 'Administrator $( $_[1] )'>" , "<$( $_[2] ) $Q = 'LMCred_$( $_[3] )' />" , "</$GB>" 
                    
                    } ; "</$G>" , "</$G>" , "</$GB>" , "</$G>" , "</TabItem>" , "</TabControl>" )

            $XML[6] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            $X = @( 2,3,4,4,3,3;3..0 )|% { $SP[$_] }
        
            $Y = @( "<$G $GR = '2' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" ; 

            ( 0 , "Start" ) , ( 1 , "Cancel" ) | % { 
            
                "<$BU $GC = '$( $_[0] )' $Q = '$( $_[1] )' $CO = '$( $_[1] )' $W = '100' $H = '24' />" 
            
            } ; "</$G>" , "</$G>" , "</Window>" )

            $XML[7] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
        }

        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $Service ) # ViperBomb Service Configuration Utility                    [
        {#___________________________________________________________________________/

            $Title                      = "ViperBomb Service Configuration Utility"

             # ____   _________________________
             #//¯¯\\__[_______ Header ________] 
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            $X = @( 2 ; @( 11 ) * 4 ; 10 , 11 , 11 , 12 ,10 , 10 , 8 , 7 ) | % { $SP[$_] }
                
            $Y = "<Window " , "   xmlns = '$Schema/presentation'" , " xmlns:x = '$Schema'" , "   Title = '$Author | Hybrid @ $Title'" , 
            "  $H = '600'" , "   Min$H = '600'" , "   $W = '800'" , "Min$W = '800'" , "Icon = '$( $GFX.Icon )'" , " BorderBrush = 'Black'" , "  ResizeMode = 'CanResize'" , 
            " $( $HAL[1] )" , "   WindowStartupLocation = 'CenterScreen'>"

            $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[__ Window Resources ___] 
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            
            $X = @( 3 , 4 , 5 , 5 , 7 , 5 , 7 , 5 , 6 , 7 , 8 ; @( 10 ) * 5 ; 7 , 6 , 5 , 4 , 4 , 5 , 7 , 4 , 3 , 3 , 4 , 3 ) | % { $SP[$_] }
            $Y = @( "<Window.Resources> " , "<Style x:Key         = 'SeparatorStyle1' " , "   TargetType    = '{x:Type Separator}'>" , 
                    "<$SE $PR = 'SnapsToDevicePixels' " , "Value    = 'True'/>" , "<$SE $PR = '$MA'" , "Value    = '0,0,0,0'/>" , "<$SE $PR = 'Template'>" , 
                    "<$SE.Value>" , "<ControlTemplate TargetType     = '{x:Type Separator}'>" , "<Border $H        = '24' " , "SnapsToDevicePixels = 'True' " , 
                    "$BG          = '#FF4D4D4D'" , "$BO`Brush         = 'Azure'" , "$BO`Thickness     = '1,1,1,1'" , "CornerRadius        = '5,5,5,5'/>" , 
                    "</ControlTemplate>" , "</$SE.Value>" , "</Setter>" , "</Style>" , "<Style  TargetType    = '{x:Type ToolTip}'>" , "<$SE $PR = '$BG'" , 
                    "Value    = '#000000'/>" , "</Style>" , "</Window.Resources>" , "<Window.Effect>" , "<DropShadowEffect/>" , "</Window.Effect>" )

            $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
            
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

             $X = @( 3 , 4 , 5 , 5 , 5 , 4 ) | % { $SP[$_] }
             $Y = @( "<$G>" , "<$GRD>" ; 20 , "*" , 60 | % { "<$RD $H        = '$_'/>" } ; "</$GRD>" )

             $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[____ Menu Controls ____]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

             $X = @( 4,7,5,6,7,9,7,9,6,6,7,9,7,9,6,6,7,9,7,9,7,9,7,9,6,6,7,9,7,9,6,5,5,6,8,6,8,6,8,6,8,6,7,9,7,9,6,6,9,6,9,5,4 ) | % { $SP[$_] }

             $Y = @( "<$MN $GR                   = '0'" , "  IsMainMenu         = 'True'>" , "<$MNI     $HD         = 'Configuration'>" ) ;

             $Slot = [ PSCustomObject ]@{ Home = "Default" ; Pro = "Default" ; Desktop = "Safe" , "Tweaked" ; Laptop  = "Safe" }

             $Y += "Home" , "Pro" , "Desktop" , "Laptop" | % { 

                "<$MNI $HD         = '$_'>" ;

                    ForEach ( $J in $Slot.$_ )
                    {
                        ForEach ( $K in "Max" , "Min" )
                        {
                            "<$MNI $Q       = 'MenuConfig$_$J$K'" ,
                            "  $HD     = '$J $K`imum'/>"
                        }
                    }
                    "</$MNI>" ;
                }

            $Y += @( "</$MNI>" , "<$MNI     $HD         = 'Info'>" ; "Feedback" , "FAQ" , "About" , "Copyright" | % { "<$MNI $Q           = 'MenuInfo$_'" , "  $HD         = '$_'/>" } ; 
            
                     "<$MNI $HD         = 'MadBomb122'>" ; ( "Donate" , "Donate to MadBomb122" ) , ( "GitHub" , "Original GUI/Script Source -> GitHub" ) | % { 
                     
                     "<$MNI $Q       = 'MenuInfoMadBomb$( $_[0] )'" , "  $HD     = '$( $_[1] )'/>" } ; "</$MNI>" ; 

                     ( "BlackViper" , "BlackViper Service Configuration Website" ) , ( "SecureDigitsPlus" , "Secure Digits Plus: Fighting Entropy" ) | % {

                        "<$MNI     $Q       = 'MenuInfo$( $_[0] )'" , "  $HD     = '$( $_[1] )'/>" } ; "</$MNI>" , "</$MN>" )

            $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

             $X = @( 4,5,8,8,6,7,8,9,10,11,13,13,13,13,12,16,16,16,16,11,11,12,14,13,15,15,12,12,14,13,15,15,12,11,10,9,8,7,6 ) | % { $SP[$_] } 

             $Y = @( "<$G $GR                   = '1'>" , "<TabControl $BO`Brush      = 'Gainsboro' " , "$GR         = '1'" , "$Q             = 'TabControl'>" , 
                     "<TabControl.Resources>" , "<Style TargetType    = 'TabItem'>" , "<$SE $PR = 'Template'>" , "<$SE.Value>" , 
                     "<ControlTemplate TargetType                   = 'TabItem'>" , "<$BO $Q                              = '$BO'" , 
                     "$BO`Thickness                   = '1,1,1,0'" , "$BO`Brush                       = 'Gainsboro'" , "CornerRadius                      = '4,4,0,0'" ,
                     "$MA                            = '2,0'>" , "<ContentPresenter x:Name              = 'ContentSite'" , "  $( $VAL[1] )", "  $( $HAL[1] )" , 
                     "  ContentSource       = '$HD'" , "  $MA              = '10,2'/>" , "</$BO>" , "<ControlTemplate.Triggers>" , "<Trigger $PR      = 'IsSelected'" , 
                     " Value         = 'True'>" , "<$SE TargetName = 'Border'" , "$PR   = '$BG'" , "Value      = 'LightSkyBlue'/>" , "</Trigger>" , 
                     "<Trigger $PR      = 'IsSelected'" , " Value         = 'False'>" , "<$SE TargetName = '$BO'" , "$PR   = '$BG'" , "Value      = 'GhostWhite'/>" , 
                     "</Trigger>" , "</ControlTemplate.Triggers>" , "</ControlTemplate>" , "</$SE.Value>" , "</$SE>" , "</Style>" , "</TabControl.Resources>" )

             $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[___ Service Dialog ____]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

             $X = @(9,7,8,9,9,9,8,8,9;@(10)*4;@(9,9,11,11,10,12,12,9,9,11,11,10,12,12)*2;9,8,8,9;@(10)*4;@(9)*4;@(10)*4;9,9,11,11,11,10,11,10,11,10,11,9,8,8;@(10)*11;
                    9,10,11,12,14,13,14,15;@(17)*4;14,13,13,15,12,12,16,13,16,12,12,16,13,16,12,12,16,13,16,12,11,10,9,9;
                    
                    @(10;@(15)*4)*2;
                    @(7;@(15)*3;10..13;20,20,13,20;12..10);
                    @(10;@(15)*4)*7;
                    
                    9,8,8,7,6) | % { $SP[$_] }

             $Y = @( " <TabItem Header = 'Service Dialog'>" , 
             "<$G>" , 
             "<$GRD>" ; 
             60 , 35 , "*" | % { "<$RD $H = '$_'/>" } ; 
             "</$GRD>" , 
             "<$G $GR = '0' >" , 
             "<$GCD>" ; 
             1.25 , 1.75 , 0.75 , 0.75 | % { "<$CD $W = '$_*' />" } ; 
             "</$GCD>" , 
             "<$GB $GC         = '0'" , 
             "  $HD              = 'Selected Profile' " , 
             "  $MA              = '5'>" , 
             "<$TBL $Q           = 'CurrentProfile'" , 
             "   TextAlignment  = 'Center'" , 
             "   $MA         = '5'/>" , 
             "</$GB>" , 
             "<$GB $GC         = '1' " , 
             "  $HD              = 'Operating System' " , 
             "  $MA              = '5' >" , 
             "<$TBL $Q           = 'CurrentOS'" , 
             "   TextAlignment  = 'Center'" , 
             "   $MA         = '5'/>" , 
             "</$GB>" , 
             "<$GB $GC         = '2' " , 
             "  $HD              = 'Current Build' " , 
             "  $MA              = '5' >" , 
             "<$TBL $Q           = 'CurrentBuild'" , 
             "   TextAlignment  = 'Center'" , 
             "   $MA         = '5'/>" , 
             "</$GB>" , 
             "<$GB $GC         = '3' " , 
             "  $HD              = 'Chassis' " , 
             "  $MA              = '5' >" , 
             "<$TBL $Q           = 'CurrentChassis'" , 
             "   TextAlignment  = 'Center'" , "   $MA         = '5'/>" , 
             "</$GB>" , 
             "</$G>" , 
             "<$G $GR                  = '1'>" , 
             "<$GCD>" ; 
             50 , "*" , 150 , 200 | % { "<$CD $W = '$_'/>" } ; 
             "</$GCD>" , 
             "<$TBL $GC = '0' $MA = '5' $( $VAL[1] ) FontSize = '12' >Search:</$TBL>" ; 
             ( "$TB " , 1 , "Search' TextWrapping = 'Wrap' /" ) , ( "$CB" , 2 , "Select' $( $VAL[1] )" ) | % { "<$( $_[0] )  $GC = '$( $_[1] )' $MA = '5' $H = '22' $Q = 'ServiceDialog$( $_[2] )>" } ; 
                     "$Q' IsSelected = 'True" , "Display$Q" , "Path$Q" , "Description" | % { "<$CBI $CO = '$_'/>" } ; 
                     "</$CB>" , "<$TBL $GC       = '3' " , "   $MA            = '5' " , "   TextAlignment     = 'Center'" , "   $( $VAL[1] )>" ;
                     ( "66FF66" , "Scoped" ) , ( "FFFF66" , "Unspecified" ) , ( "FF6666" , "Non Scoped" ) | % {
                     "<Run   $BG        = '#$( $_[0] )'" , "   Text              = '$( $_[1] )'/>" } ; 
                     "</$TBL>" , "</$G>" , "<Data$G $GR                   = '2'" , "  $GC                = '0'" , "  $Q                       = 'ServiceDialogGrid'" , 
                     "  FrozenColumnCount          = '2' " , "  AutoGenerateColumns        = 'False' " , "  AlternationCount           = '2' " , 
                     "  HeadersVisibility          = 'Column' " , "  CanUserResizeRows          = 'False' " , "  CanUserAddRows             = 'False' " , 
                     "  IsTabStop                  = 'True'" , "  IsTextSearchEnabled        = 'True'" , "  SelectionMode              = 'Extended'>" , 
                     "<Data$GR`Style>" , "<Style TargetType            = '{x:Type DataGridRow}'>" , "<Style.Triggers>" , "<Trigger Property    = 'IsMouseOver'" , 
                     " Value       = 'True'>" , "<$SE $PR = 'ToolTip'>" , "<$SE.Value>" , "<$TBL Text         = '{Binding Description}'" , "   TextWrapping = 'Wrap'" , 
                     "   $W        = '400'" , "   $BG   = '#000000'" , "   Foreground   = '#FFFFFF'/>" , "</$SE.Value>" , "</$SE>" , 
                     "<$SE $PR                = 'ToolTipService.ShowDuration'" , "Value                   = '360000000'/>" , "</Trigger>" ; 
                     ( "@" , "66FF66" ) , ( "+" , "FFFF66" ) , ( "-" , "FF6666" ) | % { "<DataTrigger      Binding           = '{Binding Scoped}'" , 
                     "  Value             = '$( $_[0] )'>" ,  "<$SE       $PR          = '$BG'" , "  Value             = '#$( $_[1] )'/>" , "</DataTrigger>" } ;
                     "</Style.Triggers>" , "</Style>" , "</Data$GR`Style>" , "<Data$GC`s>" ; 

                        ( "Index" , 40 ) , ( "Scoped" , 20 ) , ( "Profile" , 75 ) , ( $Q , 150 ) , ( "Status" , 75 ) , ( "StartType" , 75 ) , ( "Delay" , 50 ) , ( "Display$Q" , 150 ) , 
                        ( "Path$Q" , 150 ) , ( "Description" , 150 ) | % { 
                     
                        $Z = $( If ( $_[0] -eq "Scoped" ) { "@" } If ( $_[0] -eq "Delay" ) { "DelayedAutoStart" } Else { $_[0] } )
                        
                        If ( $_[0] -ne "Profile" ) 
                        { 
                            "<Data$G`TextColumn $HD                  = '$Z'" , "$W                   = '$( $_[1] )'" , 
                                "Binding                 = '{Binding $( $_[0] )}'" , 
                                "CanUserSort             = 'True'" , 
                                "IsReadOnly              = 'True'/>"
                        }
                        
                        Else 
                        {   
                            "<DataGridTemplateColumn     Header                  = '$( $_[0] )' " ,
                                                        "Width                   = '$( $_[1] )' " ,
                                                        "SortMemberPath          = '$( $_[0] )' " ,
                                                        "CanUserSort             = 'True'>" ,
                                        "<DataGridTemplateColumn.CellTemplate>" ,
                                            "<DataTemplate>" ,
                                                 "<ComboBox ItemsSource = '{ Binding $( $_[0] )}' " ,
                                                            "Text       = '{ Binding Path                = $( $_[0] ), " ,
                                                                                    "Mode                = TwoWay, " ,
                                                                                    "UpdateSourceTrigger = PropertyChanged }' " ,
                                                           "IsEnabled   = '{ Binding ElementName         = $( $_[0] )Output, " ,
                                                                                 "   Path                = IsChecked }'/>" ,
                                                 "</DataTemplate>" ,
                                             "</DataGridTemplateColumn.CellTemplate>" ,
                                         "</DataGridTemplateColumn>" 
                        }
                    } ; "</Data$GC`s>" , "</Data$G>" , "<$TBL $GR = '2' $Q = 'ServiceDialogEmpty' $MA = '20' $( $VAL[1] ) $( $HAL[1] ) FontSize = '20'/>" , "</$G>" , "</TabItem>" )

            $XML[5] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[____ Preferences ______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            $X = @(6..9;9,8,8,9;@(10)*3;9;9..11;11,10,10,11;@(12,13,13,13,12)*2;12,12,11,10;10..12;@(13)*3;@(@(12)*4;11..9;9..11;11,10;10..12;12..10;10..12;
            @(13)*4;12)*2;@(12)*4;11..8;8..10;10;@(9;9..12;12,12,11,11,12,12;@(11)*7;10)*2;9..6) | % { $SP[$_] }

            $Y = @( "<TabItem $HD = 'Preferences'>" , "<$G>" , "<$GRD>" ; 

            1.25 , "" | % { "<$RD $H = '$_*'/>" } ; "</$GRD>" , "<$G $GR = '0'>" , "<$GCD>" ; 
            0..2      | % { "<$CD $W = '*'/>"   } ; "</$GCD>" , "<$G $GC = '2'>" , "<$GRD>" ; 
            0..1      | % { "<$RD $H = '*'/>"   } ; "</$GRD>" , "<$GB $GR = '0' $HD = 'Bypass / Checks [ Risky Options ]' $MA = '5'>" , "<$G>" , "<$GRD>" ; 
            0..2      | % { "<$RD $H = '*'/>"   } ; "</$GRD>" , "<$CB   $GR = '0' $($VAL[1]) $H = '24' $Q = 'BypassEdition'>" ; 

            @( "Override Edition Check' IsSelected = 'True" ; "Home" , "Pro" | % { "Windows 10 $_" } ) | % { "<$CBI $CO = '$_'/>" } ; "</$CB>" ; 

            ( 1 , "Build" , "Skip Build/Version Check" ) , ( 2 , "Laptop" , "Enable Laptop Tweaks" ) | % { 

                "<$CHK   $GR = '$($_[0])' $MA = '5' $Q = 'Bypass$($_[1])' $CO = '$($_[2])'/>" } ; 
    
            "</$G>" , "</$GB>" , "<$GB $GR = '1' $HD = 'Display' $MA = '5' >" , "<$G>" , "<$GRD>" ; 

            0..2      | % { "<$RD $H = '30'/>" } ; "</$GRD>" ; 

            ( 0 , "Active" ) , ( 1 , "Inactive" ) , ( 2 , "Skipped" ) | % { 
            
                "<$CHK  $GR = '$($_[0])' $MA = '5' $Q = 'Display$($_[1])' $CO = 'Show $($_[1]) Services' />" } ; 

            "</$G>" , "</$GB>" , "</$G>" , "<$G $GC = '0'>" , "<$GRD>" ;

            1.5 , 2   | % { "<$RD $H = '*'/>" } ; "</$GRD>" ; 
            "<$GB $GR = '0' $HD = 'Service Configuration' $MA = '5'>" , 
            "<$CB  $GR = '1' $Q = 'ServiceProfile' $H ='24'>" ; 
            "Black Viper (Sparks v1.0)' IsSelected = 'True" , "DevOPS (MC/SDP v1.0)' IsEnabled = 'False" | % { "<$CBI $CO = '$_'/>" } ; 
            "</$CB>" , "</$GB>" , "<$GB $GR = '1' $HD = 'Miscellaneous' $MA = '5'>" , "<$G>" , "<$GRD>" ; 
            0..3      | % { "<$RD $H = '30'/>" } ; "</$GRD>" ;

            ( 0 , "Simulate" , "Simulate Changes [ Dry Run ]" ) , ( 1 , "Xbox" , "Skip All Xbox Services" ) , ( 2 , "Change" , "Allow Change of Service State" ) , 
            ( 3 , "StopDisabled" , "Stop Disabled Services" ) | % { "<$CHK  $GR = '$( $_[0] )' $MA = '5' $Q = 'Misc$( $_[1] )'     $CO = '$( $_[2] )'   />" } ; 

            "</$G>" , "</$GB>" , "</$G>" , "<$G $GC = '1'>" , "<$GRD>" ; 
            
            1.5 , 2   | % { "<$RD $H = '*'/>" } ; 
            
            "</$GRD>" , "<$GB $GR = '0' $HD = 'User Interface' $MA = '5'>" , 
            
            "<$CB  $GR = '1' $Q = 'ScriptProfile' $H = '24' >" ;
            "DevOPS (MC/SDP v1.0)' IsSelected =  'True" , "MadBomb (MadBomb122 v1.0)' IsEnabled  = 'False" | % { 
            "<$CBI $CO = '$_'/>" } ; "</$CB>" , "</$GB>" , "<$GB $GR = '1' $HD = 'Development' $MA = '5'>" , "<$G>" , "<$GRD>" ; 
            
            0..3 | % { "<$RD $H = '30'/>" } ; "</$GRD>" ; 
            
            ( 0 , "DiagErrors" , "Diagnostic Output [ On Error ]" ) , ( 1 , "Log" , "Enable Development Logging" ) , ( 2 , "Console" , "Enable Console" ) , 
            ( 3 , "DiagReport" , "Enable Diagnostic" ) | % { "<$CHK  $GR = '$( $_[0] )' $MA = '5' $Q = 'Devel$( $_[1] )'  $CO = '$( $_[2] )' />" } ; "</$G>" , "</$GB>" , 
            "</$G>" , "</$G>" , "<$G $GR = '1'>" , "<$GRD>" ; 0..1 | % { "<$RD $H = '*'/>" } ; "</$GRD>" , 
            "<$GB $GR = '0' $HD = 'Logging: Create logs for all changes made via this utility' $MA = '5'>" , "<$G>" , "<$GCD>" ; 
            
            75 , "*" , "6*" | % { "<$CD $W = '$_'/>" } ; "</$GCD>" , "<$GRD>" ; 0..1 | % { "<$RD $H = '*' />" } ; "</$GRD>" ; 
            
            ( 0 , "Service" ) , ( 1 , "Script" ) | % { 

                "<$LA    $GR = '$( $_[0] )' $GC = '0' $CO = '$( $_[1] ):' $( $VAL[1] ) $( $HAL[2] )/>" , 
                "<$BU   $GR = '$( $_[0] )' $GC = '1' $MA  = '5' $Q = 'Logging$( $_[1] )Browse' $CO = 'Browse'  />" , 
                "<$TB  $GR = '$( $_[0] )' $GC = '2' $MA  = '5' $Q = 'Logging$( $_[1] )File' IsEnabled = 'False' />" } ; 
                
            "</$G>" , "</$GB>" , "<$GB $GR = '1' $HD = 'Backup: Save your current Service Configuration' $MA = '5'>" , "<$G>" , "<$GCD>" ; 

            75 , "*" , "6*" | % { "<$CD $W = '$_'/>" } ; "</$GCD>" , "<$GRD>" ; 0..1 | % { "<$RD $H = '*' />" } ; "</$GRD>" ; 
            
            ( 0 , "Registry" ) , ( 1 , "Template" ) | % {

                "<$LA    $GR = '$( $_[0] )' $GC = '0' $CO = '$( $_[1] ):' $( $VAL[1] ) $( $HAL[2] )/>" , 
                "<$BU   $GR = '$( $_[0] )' $GC = '1' $MA  = '5' $Q = 'Backup$( $_[1] )Browse' $CO   = 'Browse'  />" , 
                "<$TB  $GR = '$( $_[0] )' $GC = '2' $MA  = '5' $Q = 'Backup$( $_[1] )File'   IsEnabled = 'False'   />" } ;

            "</$G>" , "</$GB>" , "</$G>" , "</$G>" , "</TabItem>" )

            $XML[6] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[__ Integrated Console _]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

             $X = @( 6..8;8,9,8;8..6 ) | % { $SP[$_] } 

             $Y = @( "<TabItem $HD = 'Console'>" , "<$G $MA = '5'>" , "<$GB $HD = 'Embedded Console'>" , "<ScrollViewer VerticalScrollBarVisibility = 'Visible' $MA = '5'>" , 
             "<$TBL $Q = 'ConsoleOutput' TextTrimming = 'CharacterEllipsis' Foreground = 'White' $BG = 'DarkBlue' FontFamily = 'Lucida Console'/>" , "</ScrollViewer>" , 
             "</$GB>" , "</$G>" , "</TabItem>" ) 

            $XML[7] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[__ Diagnostics Panel __]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

             $X = @( 6..8 ; 9..4 ) | % { $SP[$_] }

             $Y = @( "<TabItem Header = 'Diagnostics'>" , "<$G $BG = '#FFE5E5E5'>" , "<ScrollViewer VerticalScrollBarVisibility = 'Visible'>" , 
             "<TextBlock Name = 'DiagnosticOutput' TextTrimming = 'CharacterEllipsis' Background = 'White' FontFamily = 'Lucida Console'/>" , "</ScrollViewer>" , 
             "</$G>" , "</TabItem>" , "</TabControl>" , "</$G>" )

             $XML[8] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }

             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

             $X = @( 4..6;6,6,6,5,5,6;@(5)*4;6..2) | % { $SP[$_] }

             $Y = @( "<$G $GR = '2'>" , "<$GCD>" ; "" , 0.5 , 0.5 , "" | % { "<$CD $W = '$_*'/>" } ; "</$GCD>" , "<$GB $HD = 'Service Config' $MA = '5' $GC = '0'>" ; 
             "<$TBL $Q ='ServiceLabel' TextAlignment = 'Center' $MA = '5'/>" , "</$GB>" ; ( 1 , "Start" ) , ( 2 , "Cancel" ) | % { 
             "<$BU    $GC = '$( $_[0] )' $Q =  '$( $_[1] )' $CO  = '$( $_[1] )'  $H = '20' $MA = '5'/>" } ; "<$GB $HD = 'Script/Module' Margin = '5' $GC = '3'>" , 
             "<$TBL $Q = 'ScriptLabel' TextAlignment = 'Center' $MA = '5' />" , "</$GB>" , "</$G>" , "</$G>" , "</Window>" )

             $XML[9] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
        }
        
        If ( $Testing )
        {
            $XML
        }

        Else 
        {
            $Item   = ForEach ( $i in 0..( $XML.Count - 1 ) ) { 0..( $XML[$I].Count - 1 ) | % { $XML[$I][$_] } } 
            $Return = ""
            0..( $Item.Count - 1 ) | % { $Return += "$( $Item[$_] )`n" }

            If ( $Certificate    ) { Write-Theme -Action "Loaded [+]" "Certificate Panel" }
            If ( $Login          ) { Write-Theme -Action "Loaded [+]" "Login Panel" }
            If ( $NewAccount     ) { Write-Theme -Action "Loaded [+]" "New Account Panel" }
            If ( $HybridDSCPromo ) { Write-Theme -Action "Loaded [+]" "Hybrid-DSC Promo Panel" }
            If ( $DSCRoot        ) { Write-Theme -Action "Loaded [+]" "Desired State Controller Root Install" }
            If ( $DCFound        ) { Write-Theme -Action "Loaded [+]" "Domain Controller Found" }
            If ( $ProvisionDSC   ) { Write-Theme -Action "Loaded [+]" "Provision Desired State Controller Server" }
            If ( $Service        ) { Write-Theme -Action "Loaded [+]" "ViperBomb Service Configuration Tool" }
        
            $Return 
        
        }                                                          
                                                                                      #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯       ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Show-Message # Returns a messagebox ________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position  = 0 )                    ] [ String ] $Title   ,
            [ Parameter ( Mandatory = $True , Position = 1 ) ] [ String ] $Message )

        [ System.Windows.MessageBox ]::Show( $Message , $Title )                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Invoke-Login # Allows entry / use of an AD service account _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ] [ String ] $DC      ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ] [ String ] $Domain  ,
            [ Parameter ( Position = 2 , ValueFromPipeline = $True ) ]                     [ String ] $NetBIOS )

        IEX "Using Namespace System.DirectoryServices"

        $MSG          = ( 0 , "Username" ) , ( 1 , "Password" ) , ( 2 , "Confirmation" ) , ( 3 , "Authentication" ) | % {
            
            $w , $X   = $_[0..1]

            If ( $W -lt 2 ) 
            { 
                "Show-Message '$X Failure' 'You must enter a $X' " 
            }
            
            If ( $W -eq 2 ) 
            { 
                "Show-Message 'Password Failure' '$_ must match the $X'" 
            }
            
            If ( $W -eq 3 ) 
            { 
                "Show-Message '$X Failure' 'Submitted information is invalid/incorrect'" 
            }
        }

        $GUIX         = Get-XAML -Login | % { Convert-XAMLtoWindow -Xaml $_ -NE ( Find-XAMLNamedElements -XAML $_ ) -PassThru }

        $GUIX.Switch.Add_Click(  { $GUIX.Port.IsEnabled    =  $True } )
        $GUIX.Cancel.Add_Click(  { $GUIX.DialogResult      = $False } )
        $GUIX.Ok.Add_Click({ 
        
            $Port     = $GUIX.Port | % { 
            
                If ( $_.IsEnabled ) 
                { 
                    $_.Text 
                } 
                
                Else 
                { 
                    389 
                } 
            }

            $DomX     = $Domain.Split( '.' ) -join ',DC='

            $DX       = [ DirectoryEntry ]::New( "LDAP://$DC`:$Port/DC=$DomX" , $GUIX.Username.Text , $GUIX.Password.Password )

            If ( $GUIX.Username | ? { $_.Text     -eq $Null } )             
            { 
                IEX $MSG[0] 
            }

            ElseIf ( $GUIX.Password | ? { $_.Password -eq $Null } )
            { 
                IEX $MSG[1] 
            }
            
            ElseIf ( $GUIX.Confirm  | ? { $_.Password -eq $Null } )
            { 
                IEX $MSG[2] 
            }
            
            ElseIf ( $GUIX.Password.Password -notmatch $GUIX.Confirm.Password ) 
            { 
                IEX $MSG[2] 
            }
                ElseIf ( $DX.Name -eq $Null )                                       { IEX $MSG[3] }
                Else   { $GUIX.DialogResult = $True }
        })

        $Null = $GUIX.Username.Focus()

        $OPX  = Show-WPFWindow -GUI $GUIX

        If ( $OPX -eq $True )
        {
            Write-Theme -Action "Login [+]" "Successful"
            Return [ PSCredential ]::New( $GUIX.Username.Text , $GUIX.Password.SecurePassword )
        }

        Else
        {
            Write-Theme -Action "Login [!]" "Aborted" 12 4 15
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Export-INI # Originally based on Outfile-INI by Oliver Lipkau _____________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Mandatory , ValueFromPipeline ) ][ ValidateScript ({ Test-Path $_ -PathType Container })][ String ] $Path ,
            [ Parameter ( Mandatory , ValueFromPipeline ) ][ ValidateScript ({ $_.Split( '.' )[-1] -ne ".ini"   })][ String ] $Name ,
            [ Parameter ( Mandatory , ValueFromPipeline ) ][ ValidateScript ({ $_ -ne $Null })][ Hashtable ] $Table ,
            [ Parameter ( ) ][ ValidateScript ({ $_ -in @( 'Unicode' ; 7,8,32 | % { "UTF$_" } ;'ASCII','BigEndianUnicode','Default','OEM')})][ String ] $Encoding = "Unicode" ,
            [ Parameter ( ) ][ Switch ] $Force     ,
            [ Parameter ( ) ][ Switch ] $Append    ,
            [ Parameter ( ) ][ Switch ] $UTF8NoBOM ,
            [ Parameter ( ) ][ Switch ] $Compare   )

        Begin
        {
            "$Path\$Name"                                      | % { 

                If ( Test-Path $_ )
                {
                    If ( ! ( $Force -or $Append ) ) 
                    {
                        Write-Theme -Action "Exception [!]" "File exists, must use 'Force' or 'Append' to modify" 12 4 15
                        Break
                    }

                    If ( $Append )
                    {
                        $Output                                = GC $_

                        Write-Theme -Action "Imported [+]" "$_" 11 11 15
                    }

                    If ( $Force )
                    {
                        $Output                                = @( )

                        Write-Theme -Action "Force Replaced [+]" "$_" 11 11 15
                    }
                }

                Else
                {
                    $Output                                    = @( )
                }
            }
        }

        Process 
        {
            $Output += Convert-HashToArray -Table $Table
        }

        End
        {
            "$Path\$Name"                                      | % { 
        
                $Splat                                         = @{

                    Path                                       = $_
                    Value                                      = $Output
                    Encoding                                   = $Encoding
                }

                SC @Splat
        
                GI $_

                If ( $UTF8NoBOM )
                {
                    [ System.IO.File ]::WriteAllLines( $_ , ( GC $_ ) , ( New-Object System.Text.UTF8Encoding $False ) )
                }
            }
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Add-ACL # Changes permissions of application pool/VHost ____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
       [ CmdletBinding () ] Param ( [ String ] $Path , [ System.Security.AccessControl.FileSystemAccessRule ] $ACL ) 

            Get-ACL -Path $Path | % { $_.AddAccessRule( $ACL )
            Set-ACL -Path $Path -ACLObject $_ }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function New-ACLObject # Generates an ACL and edits its permissions ________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdletBinding () ] Param ( [ String ] $SAM , 

            [ System.Security.AccessControl.FileSystemRights  ] $Rights              , 
            [ System.Security.AccessControl.AccessControlType ] $Access    = 'Allow' , 
            [ System.Security.AccessControl.InheritanceFlags  ] $Inherit   =  'None' , 
            [ System.Security.AccessControl.PropagationFlags  ] $Propagate =  'None' )

            [ System.Security.AccessControl.FileSystemAccessRule ]::New( $SAM , $Rights , $Inherit , $Propagate , $Access )

                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-UninstallList # Collects installed applications from the registry__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        GP ( "" ,"\WOW6432Node" | % { "HKLM:\SOFTWARE$_\Microsoft\Windows\CurrentVersion\Uninstall\*" } )[ 
        
        @{  x86   = 0 ; 
            AMD64 = 0..1 }[ $Env:Processor_Architecture ]]                          #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Install-DSCRoot # Provisioned installation of Hybrid-DSC __________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

        $GUI = Get-XAML -DSCRoot | % { Convert-XAMLToWindow -XAML $_ -NE ( Find-XAMLNamedElements -Xaml $_ ) -PassThru }

        $GUI.Cancel.Add_Click({ $GUI.DialogResult = $False })

        $GUI.Start.Add_Click({ 

            If ( $GUI.Install.Text -eq "" ) 
            { 
                "Installation Location" | % { 
                
                    Show-Message -Title "$_ Missing" -Message "You must enter a $_" 
                }
            }   
            
            Else
            { 
                $GUI.DialogResult = $True 
            }
        })

        $OP                       = Show-WPFWindow -GUI $GUI

        $Null                     = $GUI.Install.Focus()

        If ( $OP -eq $True )
        {
            $Root                 = @{ 
            
                Base              = $GUI.Install.Text
                Registry          = "HKLM:\SOFTWARE\Policies"
                Vendor            = "Secure Digits Plus LLC" 
                Date              = Get-Date 
            }
            
            If ( ! ( Test-Path $Root.Base ) )
            {
                NI $Root.Base -ItemType Directory

                Write-Theme -Action "Created [+]" "Installation Directory"
            }

            If ( Test-Path $Root.Base )
            {
                Write-Theme -Action "Detected [+]" "Installation Directory"
            }

            Start $Root.Base

            Sleep -M 100
            
            $Base = $Root | % { $_.Registry , $_.Vendor -join '\' } 
            
            $Base | % { If ( Test-Path $_ ) { RI $_ } }

            Write-Theme -Action "Creating [~]" "Registry Entry for Installation Path"

            $Root | % { NI -Path $_.Registry -Name $_.Vendor }

            NI -Path $Root.Registry -Name $Root.Vendor 

            $Splat = @{ Path  = $Base
                        Name  = "Hybrid-DSC"
                        Value = $Root.Base      }

            SP @Splat
                
            Write-Theme -Action "Created [+]" $Splat.Name

            $Splat = @{ Path  = $Base
                        Name  = "Installation Date"
                        Value = $Root.Date      }    
            
            SP @Splat

            Write-Theme -Action "Created [+]" $Splat.Name

            Write-Theme -Action "Installing [~]" "Hybrid-DSC Root Structure"

            $DSCR = "Hybrid" , "Images" , "Install" , "Libraries" , "Scripts" , "Templates" , "Tools" | % { $Root.Base , $_ -join '\' } | % {
                
                If ( ( Test-Path $_ ) -ne $True ) 
                {
                    NI $_ -ItemType Directory 
                }
                    
                Else { GI $_ }
            }

            $Registry     = Resolve-UninstallList

            $Base         = $DSCR | ? { $_.Name -like "*Tools*" } | % { $_.FullName }

            $MDTFile      = @{ x86 = 86 ; AMD64 = 64 }[ $env:PROCESSOR_ARCHITECTURE ] | % { "MicrosoftDeploymentToolkit_x$_.msi" }

            $Pull         = 0..2

            # [ Windows ADK ] - The Awesome Deployment Kit. That's what ADK means. Really.

            $Pull[0] =                                                           "Deployment Kit - Windows 10" ,
                                                                                                "10.1.17763.1" ,
                                                                                                      "WinADK" ,
                                                                       "Windows Assessment and Deployment Kit" ,
                                                                                                "$Base\WinADK" ,
                                                                                              "winadk1903.exe" ,
                                                             "https://go.microsoft.com/fwlink/?linkid=2086042" ,
                                                    "/quiet /norestart /log $env:temp\win_adk.log /features +" # ~ 2m

            # [ Windows PE ] - The Pain-in-the-ass Environment... It is pretty cool, but also challenging.

            $Pull[1] =                                                                       "Preinstallation" ,
                                                                                                "10.1.17763.1" ,
                                                                                                       "WinPE" ,
                                                                     "Windows ADK Preinstallation Environment" ,
                                                                                                 "$Base\WinPE" ,
                                                                                               "winpe1903.exe" ,
                                                             "https://go.microsoft.com/fwlink/?linkid=2087112" ,
                                                    "/quiet /norestart /log $env:temp\win_adk.log /features +" # ~ 10m

            # Microsoft Deployment Toolkit - One day, a bunch of wizards said "Lets make this awesome thing." And then they did.

            $Pull[2] =                                                                       "Deployment Tool" ,
                                                                                               "6.3.8450.0000" ,
                                                                                                         "MDT" ,
                                                                                "Microsoft Deployment Toolkit" ,
                                                                                                   "$Base\MDT" ,
                                                                                                    "$MDTFile" ,
                 "https://download.microsoft.com/download/3/3/9/339BE62D-B4B8-4956-B58D-73C4685FC492/$MDTFile" ,
                                                                                           "/quiet /norestart" # ~  4s

            $ETA = "2m" , "10m" , "4s" | % { "Estimated Time [~] $_" }
        
            Write-Theme -Action "Querying [~]" "Registry for installed applications"

            0..2      | % {

                $X    = $Pull[$_]

                $T    = $ETA[$_]
            
                $Item = $Registry | ? { $_.DisplayName -like "*$( $X[0] )*" }

                If ( ( $Item -ne $Null ) -and ( $Item.DisplayVersion -ge $X[1] ) )
                {
                    Write-Theme -Action "Confirmed [+]" "$( $X[3] ) meets minimum requirements"
                }

                ElseIf ( ( $Item -eq $Null ) -or ( $Item.DisplayVersion -lt $X[1] ) )
                {
                    Write-Theme -Action "Collecting [~]" $X[3]
                
                    If ( ! ( Test-Path $X[4] ) )
                    {
                        NI $X[4] -ItemType Directory
                    
                        Write-Theme -Action "Created [+]" $X[4]
                    }

                    IPMO BitsTransfer
                
                    [ Net.ServicePointManager ]::SecurityProtocol = 3072

                    $Splat = @{  Source           = $X[6]
                                 Destination      = $X[4,5] -join "\"
                                 Description      = $X[3] 
                    }

                    Start-BitsTransfer @Splat

                    $Splat = @{  FilePath         = $X[5]
                                 Args             = $X[7] 
                                 WorkingDirectory = $X[4]
                                 Passthru         = $True
                    }

                    Write-Theme -Action "Installing [+]" $X[3]
                    
                    Write-Theme -Function "ETA $T"

                    $Time = [ System.Diagnostics.Stopwatch ]::StartNew()

                    SAPS @Splat | % {
                    
                        For ( $j = 0 ; $j -le 100 ; ( $j ++ ) % 100 ) 
                        {
                            $Progress = @{  Activity        = "[ Installing ]" , $X[3] -join " "
                                            PercentComplete = "$J"
                                            Status          = "$J% Complete" }

                            Write-Progress @Progress
                
                            Sleep -M 250 

                            If ( $_.HasExited ) 
                            { 
                                Write-Progress -Activity "[ Installed ]" -Completed
                                Return 
                            }
                        }
                    }

                    $Time.Stop()

                    Write-Theme -Action "Installed [+]" $X[3]

                    Write-Theme -Function $Time.Elapsed

                }
            }

            Write-Theme -Action "Verified [+]" "PSD/MDT Dependencies"

            IPMO BitsTransfer
             
            [ Net.ServicePointManager ]::SecurityProtocol = 3072
                    
            $Splat = @{ Source      = "https://github.com/FriendsOfMDT/PSD/archive/master.zip"
                        Destination = "$( $Root.Base )\Tools\PSD_Master.zip" 
                        Description = "PowerShell Deployment" }
            
            Start-BitsTransfer @Splat

        }

        Else
        {
            Write-Theme -Action "Exception [!]" "The exited or the dialogue failed" 12 4 15
        }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Import-MDTModule # Loads the module for MDT _______________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
      
        GP "HKLM:\Software\Microsoft\Deployment 4" | % { GCI $_.Install_Dir "*Toolkit.psd1" -Recurse } | % { IPMO $_.FullName }

        "[ Module ] Microsoft Deployment Toolkit"  | % { 

            If ( $? ) { Write-Theme -Action "Successful [+]" "$_ / Imported"    11 11 15 }
            Else      { Write-Theme -Action "Exception [!]" "$_ / Not Imported" 12  4 15 }

        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Install-HybridDSC # Provisions/Installs a Legacy or PSD Deployment Share __//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Import-MDTModule
        
        $CS    = GCIM Win32_ComputerSystem

        $Code = [ PSCustomObject ]@{ 
        
        # MDT Drive Info
        Drive       = "" ; Directory   = "" ; Samba       = "" ; DSDrive     = "" ; 
        Description = "" ; 

        # MDT Installation Type Switch
        Legacy      = "" ; Remaster    = "" ; 

        # IIS Info
        IIS_Name    = "" ; IIS_AppPool = "" ; IIS_Proxy   = "" ; 
            
        # IIS Installation Type Switch
        IIS_Install = "" ; IIS_Skip    = "" ;

        # Deployment Share Information
        Company     = "" ; WWW         = "" ; Phone       = "" ; Hours       = "" ; 
        Logo        = "" ; Background  = "" ; Branch      = "" ; NetBIOS     = "" ;

        # Target Machine Information
        LMCred_User = "" ; LMCred_Pass = "" }

        $MSG  = @( "File System/Drive" ,       "Root Directory" ,    "Network Share Name" ,      "PSDrive Name" , 
                   "Share Description" ,   "BITS-DSC Site Name" , "Application Pool Name" , "Virtual Host Name" , 
                        "Company Name" ;    "Website" , "Phone" , "Hours" | % { "Support $_" } ;         "Logo" ;
                          "Background" ;               "Branch" ;          "NetBIOS Name" ; 
                "Target/LM Admin User" ; "Target/LM Admin Pass" ) | % { "Show-Message -Title '$_ Missing' -Message 'You must enter a $_'" }

        $GUI = Get-XAML -ProvisionDSC              | % { 
            Convert-XAMLtoWindow -Xaml $_ -NE ( Find-XAMLNamedElements -XAML $_ ) -PassThru 
        }

        $GUI.Legacy.Add_Click({
            "Remaster"                   | % { $GUI.$_.IsChecked = $False ; $Code.$_ =        "-" }
            "Legacy"                     | % { $GUI.$_.IsChecked =  $True ; $Code.$_ = "Selected" }
        })

        $GUI.Remaster.Add_Click({
            "Remaster"                   | % { $GUI.$_.IsChecked =  $True ; $Code.$_ = "Selected" }
            "Legacy"                     | % { $GUI.$_.IsChecked = $False ; $Code.$_ =        "-" }
        })

        $GUI.IIS_Install.Add_Click(
        { 
             $GUI.IIS_Install.IsChecked = $True  ; $Code.IIS_Install = "Selected" 
             $GUI.IIS_Skip.IsChecked    = $False ; $Code.IIS_Skip    = "-" 

            "Name" , "AppPool" , "Proxy" | % { "IIS_$_" } | % { 
            
                $GUI.$_.IsEnabled        = $True
                $GUI.$_.Text             = ""
                $Code.$_                 = "" 
            }
        })

        $GUI.IIS_Skip.Add_Click(
        {
             $GUI.IIS_Install.IsChecked = $False ; $Code.IIS_Install = "-"
             $GUI.IIS_Skip.IsChecked    =  $True ; $Code.IIS_Skip    = "Selected" 

            "Name" , "AppPool" , "Proxy" | % { "IIS_$_" } | % { 
            
                $GUI.$_.IsEnabled        = $False
                $GUI.$_.Text             = ""
                $Code.$_                 = "" 
            }
        })

        $GUI.LogoBrowse.Add_Click(
        {
            $Dialog                                 = New-Object System.Windows.Forms.OpenFileDialog
                    
            $Dialog                                 | % {

                $_.Title                            = "Select Logo"
                $_.InitialDirectory                 = $ENV:UserProfile
                $_.Filter                           = "bmp (*.bmp) | *.bmp"
            }

            $X                                      = $Dialog.ShowDialog()

            $GUI.Logo.Text = @{ $True = $Dialog.FileName ; $False = "" }[ $X -eq "OK" ]

            $Dialog.Dispose()
        
        })

        $GUI.BackgroundBrowse.Add_Click(
        {
            $Dialog                                 = New-Object System.Windows.Forms.OpenFileDialog
                    
            $Dialog                                 | % {

                $_.Title                            = "Select Background"
                $_.InitialDirectory                 = $ENV:UserProfile
                $_.Filter                           = "Image Files(*.bmp;*.jpg;*.gif)|*.bmp;*.gif;*.jpg;*.png;*.tif;*.dib;*.jfif;*.jpe;*.jpeg;*.wdp"
            }

            $X                                      = $Dialog.ShowDialog()

            $GUI.Background.Text = @{ $True = $Dialog.FileName ; $False = "" }[ $X -eq "OK" ]

            $Dialog.Dispose()
        
        })

        $GUI.Cancel.Add_Click({ $GUI.DialogResult = $False })

        $GUI.Start.Add_Click({

            $Stage = 0

                If ( $GUI.Drive           | % { $_.Text           -eq "" } ) { IEX $MSG[ 0] }
            ElseIf ( $GUI.Directory       | % { $_.Text           -eq "" } ) { IEX $MSG[ 1] }
            ElseIf ( $GUI.Samba           | % { $_.Text           -eq "" } ) { IEX $MSG[ 2] }
            ElseIf ( $GUI.DSDrive         | % { $_.Text           -eq "" } ) { IEX $MSG[ 3] }
            ElseIf ( $GUI.Description     | % { $_.Text           -eq "" } ) { IEX $MSG[ 4] }
            ElseIf ( $GUI.IIS_Install     | % { $_.IsChecked } )
            {
                    If ( $GUI.IIS_Name    | % { $_.Text           -eq "" } ) { IEX $MSG[ 5] }
                ElseIf ( $GUI.IIS_AppPool | % { $_.Text           -eq "" } ) { IEX $MSG[ 6] }
                ElseIf ( $GUI.IIS_Proxy   | % { $_.Text           -eq "" } ) { IEX $MSG[ 7] }
            }
            ElseIf ( $GUI.Company         | % { $_.Text           -eq "" } ) { IEX $MSG[ 8] }
            ElseIf ( $GUI.WWW             | % { $_.Text           -eq "" } ) { IEX $MSG[ 9] }
            ElseIf ( $GUI.Phone           | % { $_.Text           -eq "" } ) { IEX $MSG[10] }
            ElseIf ( $GUI.Hours           | % { $_.Text           -eq "" } ) { IEX $MSG[11] }
            ElseIf ( $GUI.Logo            | % { $_.Text           -eq "" } ) { IEX $MSG[12] }
            ElseIf ( $GUI.Background      | % { $_.Text           -eq "" } ) { IEX $MSG[13] }
            ElseIf ( $GUI.Branch          | % { $_.Text           -eq "" } ) { IEX $MSG[14] }
            ElseIf ( $GUI.NetBIOS         | % { $_.Text           -eq "" } ) { IEX $MSG[15] }
            ElseIf ( $GUI.LMCred_User     | % { $_.Text           -eq "" } ) { IEX $MSG[16] }
            ElseIf ( $GUI.LMCred_Pass     | % { $_.Password       -eq "" } ) { IEX $MSG[17] }

            $CHK    = 0..7
            $CHK[0] = $GUI.Drive.Text.Replace( '\' , '' )
            $CHK[1] = Get-ACL $CHK[0] | % { $_.Access } | ? { $_.IdentityReference -match $Env:Username } | % { $_.FileSystemRights }
            $CHK[2] = $GUI.Directory.Text.Replace( $CHK[0] , '' ).Replace( '\' , '' ).Replace( '/' , '' )
            $CHK[3] = $CHK[0,2] -join '\'
            $CHK[4] = $GUI.Samba.Text.Replace( '$' , '' )
            $CHK[5] = $GUI.DSDrive.Text.Replace( ':' , '' )
            $CHK[6] = $GUI.Logo.Text
            $CHK[7] = $GUI.Background.Text

            $MSG = @( "Invalid Drive" , "Insufficient priviledges over specified folder" ; "Directory" , "Share" | % { "$_ already exists, cannot proceed" } ;
            "name" , "path" | % { "MDT-PersistentDrive with that $_ already exists" } ; "not found" , "is not in bitmap form" | % { "Logo $_" } ; 
            "width" , "height" | % { "Logo $_ exceeds 120px" } ; "found" , "in an acceptable format" | % { "Background not $_" } ) | % { "Show-Message -Message '$_'" }

            If ( ! ( Test-Path $CHK[0] ) )                                                                         { IEX $MSG[ 0] }
            ElseIf ( ( "268435456" , "FullControl" , "Modify, Synchronize" | ? { $_ -in $CHK[1] } ).Count -eq 0 )  { IEX $MSG[ 1] }
            ElseIf ( Test-Path $CHK[3] )                                                                           { IEX $MSG[ 2] }
            ElseIf ( GSMBS | ? { $_.Name -like "*$( $CHK[4] )*" } )                                                { IEX $MSG[ 3] }
            ElseIf ( Get-MDTPersistentDrive | ? { $_.Name -eq $CHK[5] } )                                          { IEX $MSG[ 4] }
            ElseIf ( Get-MDTPersistentDrive | ? { $_.Path -eq $CHK[3] } )                                          { IEX $MSG[ 5] }
            ElseIf ( ! ( Test-Path $CHK[6] ) )                                                                     { IEX $MSG[ 6] }
            ElseIf ( $CHK[6].Split( '.' )[-1] -ne "bmp" )                                                          { IEX $MSG[ 7] }
            ElseIf ( [ System.Drawing.Bitmap ]::FromFile( $CHK[6] ).Width  -gt 120 )                               { IEX $MSG[ 8] }
            ElseIf ( [ System.Drawing.Bitmap ]::FromFile( $CHK[6] ).Height -gt 120 )                               { IEX $MSG[ 9] }
            ElseIf ( ! ( Test-Path $CHK[7] ) )                                                                     { IEX $MSG[10] }
            ElseIf ( !$CHK[7].Split( '.' )[-1] -in "BMP,GIF,JPG,PNG,TIF,DIB,JFIF,JPE,JPEG,WDP".Split( ',' ) )      { IEX $MSG[11] }

            If ( $GUI.Legacy.IsChecked )
            {
                $Code.Legacy      =    "Selected" 
                $Code.Remaster    =           "-"
            }

            If ( $GUI.Remaster.IsChecked )
            {
                $Code.Legacy      =           "-" 
                $Code.Remaster    =    "Selected"
            }

            If ( $GUI.IIS_Install.IsChecked )
            {
                $Code.IIS_Install =    "Selected" 
                $Code.IIS_Skip    =           "-"
                $Code.IIS_Name    = $GUI.IIS_Name.Text
                $Code.IIS_AppPool = $GUI.IIS_AppPool.Text
                $Code.IIS_Proxy   = $GUI.IIS_Proxy.Text
            }

            If ( $GUI.IIS_Skip.IsChecked )
            {
                $Code.IIS_Install =           "-"
                $Code.IIS_Skip    =    "Selected" 
                $Code.IIS_Name    =           "-"
                $Code.IIS_AppPool =           "-" 
                $Code.IIS_Proxy   =           "-"
            }

                $Code.Drive       = $CHK[0]
                $Code.Directory   = $CHK[3]
                $Code.Samba       = "$( $CHK[4] )$"
                $Code.DSDrive     = "$( $CHK[5] ):"
                $Code.Description = $GUI.Description.Text
                $Code.Company     = $GUI.Company.Text
                $Code.WWW         = $GUI.WWW.Text
                $Code.Phone       = $GUI.Phone.Text
                $Code.Hours       = $GUI.Hours.Text
                $Code.Logo        = $GUI.Logo.Text
                $Code.Background  = $GUI.Background.Text
                $Code.Branch      = $GUI.Branch.Text
                $Code.NetBIOS     = $GUI.NetBIOS.Text
                $Code.LMCred_User = $GUI.LMCred_User.Text
                $Code.LMCred_Pass = $GUI.LMCred_Pass.Password

                $GUI.DialogResult = $True
        })


        Resolve-HybridDSC -Domain | % { 
        
            $GUI.NetBIOS.Text = $_.NetBIOS
            $GUI.Branch.Text  = $_.Branch 
        }

        $HDList = GCIM Win32_LogicalDisk | ? { $_.DriveType -eq 3 } | % { $_.DeviceID } | Sort

        If ( $HDList.Count -gt 1 )
        {
            $C  = 0

            0..( $HDList.Count - 1 ) | % { 
            
                $GUI.Drive.AddChild( $C , $HDList[$_] )
                $C ++
            }

            $GUI.Drive.SelectedItem = $HDList[0]
        }

        If ( $HDList.Count -eq 1 )
        {
            $GUI.Drive.AddChild( $HDList )
            $GUI.Drive.SelectedItem = $HDList
        }

        $GUI.Legacy      | % { $_.IsChecked = $True }
        $GUI.IIS_Install | % { $_.IsChecked = $True }

        If ( $Test )
        {
            $GFX = Resolve-HybridDSC -Graphics
            
            $GUI | % {
            
                $_.Drive       | % { $_.Text     = "C:\"                              }
                $_.Directory   | % { $_.Text     = "Test1"                            }
                $_.Samba       | % { $_.Text     = "Samba$"                           }
                $_.DSDrive     | % { $_.Text     = "PSDrive:"                         }
                $_.Description | % { $_.Text     = "Info"                             }
                $_.Company     | % { $_.Text     = "Secure Digits Plus LLC"           }
                $_.IIS_Name    | % { $_.Text     = "SiteName"                         }
                $_.IIS_AppPool | % { $_.Text     = "MDT_AppPool"                      }
                $_.IIS_Proxy   | % { $_.Text     = "Hybrid"                           }
                $_.WWW         | % { $_.Text     = "https://www.securedigitsplus.com" }
                $_.Phone       | % { $_.Text     = "(518) 406-8569"                   }
                $_.Hours       | % { $_.Text     = "24h/d; 7d/w; 365.25d/y;"          }
                $_.Logo        | % { $_.Text     = $GFX.Logo                          }
                $_.Background  | % { $_.Text     = $GFX.Brand                         }
                $_.LMCred_User | % { $_.Text     = "Administrator"                    }
                $_.LMCred_Pass | % { $_.Password = "password"                         }
            }
        }

        $OP = Show-WPFWindow -GUI $GUI

        If ( $OP -eq $True ) 
        {   
            If ( Test-Path $Code.Directory )
            {
                Write-Theme -Action "Exception [!]" "Directory must not exist, breaking" 12 4 15
                
                Read-Host "Press Enter to Return"
                
                Break
            }

            Else
            {
                NI -Path $Code.Directory -ItemType Directory

                If ( $? -eq $True )
                {
                    Write-Theme -Action "Successful [+]" "Directory Created" 11 11 15
                }

                Else
                {
                    Write-Theme -Action "Exception [!]" "Directory Creation Failed" 12 4 15
                    Read-Host "Press Enter to Exit"
                    Break
                }
            }
            
            # Create the Samba Share

            $Splat = @{ Name        = $Code.Samba 
                        Path        = $Code.Directory 
                        FullAccess  = "Administrators" 
                        Description = $Code.Description }
    
            NSMBS @Splat

            If ( $? -eq $True )
            {
                Write-Theme -Action "Successful [+]" "Samba Share Created" 11 11 15
            }

            Else
            {
                Write-Theme -Action "Exception [!]" "Samba Share Creation Failed" 12 4 15
                Read-Host "Press Enter to Exit"
                Break
            }

            # Create the PSDrive/MDTPersistent Drive
            
            $Splat = @{ Name            = $Code.DSDrive.Replace( ':' , '' )
                        PSProvider      = "MDTProvider"
                        Root            = $Code.Directory
                        Description     = $Code.Description
                        NetworkPath     = "\\$ENV:ComputerName\$( $Code.Samba )"
                        Verbose         = $True }

            NDR @Splat                  | Add-MDTPersistentDrive -VB

            # Scaffold Hybrid-DSC Deployment Share Root Settings, Copy Designated/Default Background & Logo
            
            $DSC                        = $Code | % { $_.Directory , $_.Company -join '\' } | % { NI $_ -ItemType Directory } 

            "0,Resources;1,Tools;2,Images;3,Profiles;4,Certificates;5,Applications".Split(';') | % { NI "$DSC\({0}){1}" -f $_.Split(',') -ItemType Directory }

            $Res                        = GCI $DSC "*0*" | % { $_.FullName }

            $Code                       | % { 
            
                $_.Background , $_.Logo | % { CP $_ $Res }

                $_.Background           = "$Res\$( $_.Background.Split('\')[-1] )"
                
                $_.Logo                 = "$Res\$( $_.Logo.Split('\')[-1] )"
            }

            If ( $? -eq $True )
            {
                Write-Theme -Action "Successful [+]" "PSDrive/MDTPersistent Drive Created" 11 11 15
            }

            Else
            {
                Write-Theme -Action "Exception [!]" "PSDrive/MDTPersistent Drive Creation Failed" 12 4 15

                Read-Host "Press Enter to Exit"
                
                Break
            }
    
            # Plant Tree For Deployment Share Root Settings

            $Root                       = Resolve-HybridDSC -Root | % { $_.Root }

            $Tree                       = "Hybrid-DSC\$( $Code.Company )\$( $Code.DSDrive.Replace( ':' , '' ) )"

            $Rec                        = $Tree.Split( '\' )

            $Path                       = $Root

            ForEach ( $i in 0..2 ) 
            {
                "$Path\$( $Rec[$I] )"   | % {

                    If ( ! ( Test-Path $_ ) )
                    {
                        NI $Path -Name $Rec[$I]
                    }

                    $Path               = $_
                }
            }

            # Place Deployment Share Root Settings in the registry

            $PSDefaults                 = "ChildName,Drive,ParentPath,Path,Provider".Split(',') | % { "PS$_" }
            $Names                      = $Code  | GM | ? { $_.MemberType -eq "NoteProperty" } | ? { $_.Name -notin $PSDefaults } | % { $_.Name }
            $Values                     = $Names | % { $Code.$_ } 
            
            0..( $Names.Count - 1 )     | % { 
            
                $Splat                  = @{
                
                    Path                = $Path 
                    Name                = $Names[$_] 
                    Value               = $Values[$_] 
                    Force               = $True 
                }

                SP @Splat

                SP -Path $Path -Name "Server" -Value $ENV:ComputerName
                
                $Share                  = Resolve-HybridDSC -Share 
                $Share                  | % { SC -Path "$( $_.Directory )\DSC.txt" -Value ( $_ | ConvertTo-JSON ) -Force }


            If ( $Code.Remaster -eq "Selected" )
            {
                Write-Theme -Action "Creating" "[+] PowerShell [ Deployment / Development ] Share"
                    
                $Source                 = Resolve-HybridDSC -Root      | % { $_."Hybrid-DSC" }
                $Remaster               = GCI $Source "*PSD*" -Recurse | % { $_.FullName     }

                If ( $Remaster -eq $Null )
                {
                    Write-Theme -Action "Exception [!]" "The Remastered package was not detected" 12 4 15
                    Break
                }

                $Manifest               = [ PSCustomObject ]@{ 

                        Scripts         = "Scripts" ; Templates = "Templates" ; Modules   = "Tools\Modules"
                        Folders         = "Gather,DeploymentShare,Utility,Wizard".Split(',') | % { "PSD$_" }
                        XSD             = ( "Groups,Medias,OperatingSystems,Packages,SelectionProfiles,TaskSequences," + 
                                          "Applications,Drivers,LinkedDeploymentShares" ).Split(',') | % { "$_.xsd" } ;
                        PSSnapIn        = @( "dll,dll.config,dll-help.xml,Format.ps1xml,Types.ps1xml".Split(',') | % { "PSSnapIn.$_" } ;
                                          "Core.dll" , "Core.dll.config" , "ConfigManager.dll" )
                        Paths           = "Logs,Logs\Dyn,DriverSources,DriverPackages".Split(',')
                }
                
                Expand-Archive $Remaster -DestinationPath "$Source\Tools"

                $Items                  = "Scripts" , "Templates" | % { GCI "$Source\Tools\PSD-Master\$_" | % { $_.FullName } }
                
                0..( $Items.Count - 1 ) | % { 
                
                    $X                  = $Items[$_] 
                    $Y                  = "$( $Code.Directory )\$( If ( $X -like "*Scripts*" ) { "Scripts" } If ( $X -like "*Templates*" ) { "Templates" } )"
                    MI $X $Y
                }
            }
                
            RI "$Source\Tools\PSD-master" -Recurse -Force

            $M                          = $Manifest
            $W                          = $Code.Directory
            $X                          = $W , $M.Modules -join '\'

            $M.Folders                  | % { "$X\$_" } | ? { 
            
                ! ( Test-Path $_ ) }    | % { 
                
                    NI $_ -ItemType Directory -VB 
                }

            
                GCI "$W\Scripts" "*.psm1*" -Recurse | % { 
            
                    CP $_.FullName "$W\Tools\Modules\{0}\{1}" -f $_.BaseName , $_.Name -VB 
                }

                $Snap                   = "$W\Tools\Modules\Microsoft.BDD.PSSnapin" 
                
                $Snap                   | ? { ! ( Test-Path $_ ) } | % { 
                
                    NI $_ -ItemType Directory -VB 
                }

                $MDTDir                 = GP "HKLM:\Software\Microsoft\Deployment 4" | % { $_.Install_Dir }
                
                $M.PSSnapIn             | % { GCI "$MDTDir\Bin" *$_* -Recurse } | % { 
                
                    CP $_.FullName "$Snap\$( $_.Name )" -VB 
                }

                GCI $MDTDir "*Gather.xml*" -Recurse | % { CP $_.FullName "$W\Tools\Modules\PSDGather" -VB }

                $M.XSD                  | % { GCI $MDTDir "*$_*" -Recurse } | % {
                
                    CP $_.FullName "$W\Templates" -VB
                }
                
                $M.Paths                | % { "$W\$_" } | ? { ! ( Test-Path $_ ) } | % { 
                
                    NI $_ -ItemType Directory -Verbose 
                }
            }

            Write-Theme -Action "Reducing [~]" "Permissions Hardening on $( $Code.Samba )"

            "Users" , "Administrators" , "SYSTEM" | % { ICACLS $Code.Directory /Grant "$_`:(OI)(CI)(RX)" }

            $Code.Samba | % { 
                
                GRSMBA -Name $_ -AccountName "EVERYONE" -AccessRight Change -Force
                RKSMBA -Name $_ -AccountName "CREATOR OWNER" -Force 
            }

            $Control = @{ Path        = Resolve-HybridDSC -Module | % { GCI $_ "*Control*" } | % { $_.FullName }
                          Destination = $Share | % { gci $_.Directory "*(2)Images*" -Recurse } | % { $_.FullName }
                          Recurse     = $True 
                          Force       = $True }

            CP @Control

            If ( $Code.Legacy      -eq "Selected" ) { Write-Theme -Action "Complete [+]" "Legacy MDT Installed" }
            If ( $Code.Remaster    -eq "Selected" ) { Write-Theme -Action "Complete [+]" "Hybrid-DSC/PSD Installed" }
            If ( $Code.IIS_Install -eq "Selected" )
            {
                Initialize-HybridIIS -Features | % { 

                    If ( $_.Reboot -eq $True )
                    {
                        $Content       = [ PSCustomObject ]@{ 

                            Root       = Resolve-HybridDSC -Module
                            File       = "Reboot.ps1"
                            Path       = ""
                            Script     = ""
                        }

                        $Content       | % { 
                        
                            $_.Path    = $_.Root , $_.File -join '\' 
                            $_.Script += "RI $( $_.Path )" , "IPMO Hybrid-DSC -Force" , "Initialize-HybridIIS -Install"
                        
                            SC -Path $_.Path -Value $_.Script

                            New-ScheduledTaskTrigger -AtStartup

                            $Splat = @{ Execute  = "PowerShell.exe"
                                        Argument = "-ExecutionPolicy Bypass -Scope Process -Force -File {0}" -f $_.Path }

                            New-ScheduledTaskAction @Splat
                        }

                        Restart-Computer
                    }

                    Else
                    {
                        Initialize-HybridIIS -Install
                    }
                }
            }

            If ( $Code.IIS_Skip -eq "Selected" )
            {
                Write-Theme -Action "Bypass [~]" "MDT/IIS Server Setup"
            }
        }

        Else
        {
            Write-Theme -Action "Exception [!]" "Either the user cancelled, or the dialog failed" 12 4 15
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-HybridIIS # Populates Tools and Items for subfolders ___________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯       
        [ CmdLetBinding () ] Param (

            [ Parameter ( ParameterSetName = "Features" ) ] [ Switch ] $Features ,
            [ Parameter ( ParameterSetName = "Install"  ) ] [ Switch ] $Install  )

        If ( $Features )
        {
            # ____   _________________________
            #//¯¯\\__[__ Get Web Services ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            $Reboot = [ PSCustomObject ]@{ Reboot = $False }

            $Web    = @( "Web-Server" , "DSC-Service" , "FS-SMBBW" , "ManagementOData" , "WindowsPowerShellWebAccess" , "WebDAV-Redirector" ;
            "BITS"  | % { "$_" , "$_-IIS-Ext" , "RSAT-$_-Server" } ; "Net" | % { "$_-Framework-45-ASP$_" , "$_-WCF-HTTP-Activation45" } ;
            "WAS"   | % { "$_" , "$_-Process-Model" , "$_-Config-APIs" } ; @( ( "App-Dev,AppInit,Asp-Net45,Basic-Auth,Common-Http,Custom-Logging," +
            "DAV-Publishing,Default-Doc,Digest-Auth,Dir-Browsing,Filtering,Health,Includes,Log-Libraries,Metabase,Mgmt-Console,Net-Ext45,Performance," + 
            "Request-Monitor,Security,Stat-Compression,Static-Content,Url-Auth,WebServer,Windows-Auth" -join '' ).Split(',') + 
            "Errors,Logging,Redirect,Tracing".Split(',') | % { "HTTP-$_" } ;"Ext,Filter".Split(',') | % { "ISAPI-$_" } ) | % { "Web-$_" } ) | Sort

            Write-Theme -Action "Checking [~]" "IIS / Windows Features"

            Get-WindowsFeature | ? { $_.Name -in $Web -and $_.InstallState -ne "Installed" } | % {

                Write-Theme -Action "Installing [~]" "Installing $( $_.Name )"

                If ( $_.Name -in "DSC-Service" , "WebDAV-Redirector" , "WindowsPowerShellWebAccess" , "WAS" , "WAS-Process-Model" , "WAS-Config-APIs" ) 
                {
                    Write-Theme -Action "Reboot [~]" "Required / $( $_.Name )"

                    If ( $Reboot -ne $True )
                    {
                        $Reboot.Reboot = $True
                    }
                }
    
                Install-WindowsFeature -Name $_.Name -IncludeAllSubFeature -IncludeManagementTools
        
            }

            $Reboot
        }

        If ( $Install )
        {
            # ____   _________________________
            #//¯¯\\__[__ Table Definition ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Resolve-HybridDSC -Share | % { 

                    $Site         = [ PSCustomObject ]@{

                        Name      = $_.IIS_Name
                        Pool      = $_.IIS_AppPool
                        Host      = $_.IIS_Proxy
                        Directory = $_.Directory

                        System    = "$ENV:SystemDrive"
                        System32  = "$ENV:SystemRoot\System32"
                        Server    = "$ENV:ComputerName"

                        AppHost   = "Machine/Webroot/AppHost"
                        WebServer = "system.webServer"
                        SecAuth   = "security/authentication"
                        AutoStart = "ServerAutoStart"
                        Static    = "StaticContent"

                        Date      = Get-Date -UFormat "%m-%d-%Y"
                        Log       = "$Home\Desktop\ACL"

                        Root      = ""
                        Site      = ""
                        VHost     = ""
                        AppData   = ""
                        URL       = ""
                    }
                }

                $Site             | % { 
            
                    $_.Root       = $_.System , "inetpub" , $_.Name -join '\'
                    $_.Site       = "IIS:\Sites" , $_.Name -join '\'
                    $_.VHost       = $_.Site , $_.Host -join '\'
                    $_.URL        = "$( $_.Name ).$env:USERDNSDOMAIN"
                    $_.AppData    = $_.Root , "AppData" -join '\'
                }

                $Site | % { $_.Root , $_.AppData } | % { 
            
                    If ( ! ( Test-Path $_ ) )
                    { 
                        NI $_ -ItemType Directory 
                    }

                    Else
                    {
                        Write-Theme -Action "Detected [+]" $_
                    }
                }
            # ____   _________________________
            #//¯¯\\__[__ Set Web Services ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                "WebAdministration" | % { 

                    IPMO $_
                    If (  $? ) { Write-Theme -Action "Loaded [~]" "$_ Module Loaded"     11 11 15 }
                    If ( !$? ) { Write-Theme -Action "Failed [!]" "$_ Module Not Loaded" 12  4 15 }
                }

                Get-Website | ? { $_.Name -eq "Default Web Site" } | Stop-Website | SP "IIS:/Sites/$( $_.Name )" ServerAutoStart False

                Write-Theme -Action "Stopped [+]" "Default Web Site"

                ForEach ( $i in "MRxDAV" , "WebClient" , "WAS" , "W3SVC" )
                {
                    Get-Service -Name $I | % { 
                
                        If ( $_.Status -ne "Running" ) 
                        { 

                            $Splat = @{ StartupType = "Automatic"
                                        Status      =   "Running"
                                        Name        =    $_.Name }
                
                            Set-Service @Splat

                            Write-Theme -Action "Service [+]" "[ $( $_.Name ) ] Activated"
                        }
            
                        Else 
                        {
                            Write-Theme -Action "Service [+]" "[ $( $_.Name ) ] Already Active"
                        }
                    }
                }
            # ____   _________________________
            #//¯¯\\__[__ Generate AppPool ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                If ( ( Get-IISAppPool -Name $Site.Pool ) -ne $Null )
                { 
                    Write-Theme -Action "Removing [!]" "Prior Application Pool"
            
                    Remove-WebAppPool -Name $Site.Pool
                }

                New-WebAppPool -Name $Site.Pool -Force

                Write-Theme -Action "Configuring" "[~] Application Pool Settings"

                ( "Enable32BitAppOnWin64" , "True" ) , ( "ManagedRuntimeVersion" , "v4.0" ) , ( "ManagedPipelineMode" , "Integrated" ) | % { 
            
                    SP -Path "IIS:\AppPools\$( $Site.Pool )" -Name $_[0] -Value $_[1] -VB

                }

                Restart-WebAppPool -Name $Site.Pool
            # ____   _________________________
            #//¯¯\\__[__ Generate Website ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                If ( ( Get-WebSite -Name $Site.Name ) -ne $Null )
                { 
                    Write-Theme -Action "Removing [!]" "Prior Website"

                    Remove-Website -Name $Site.Name
                }
            
                $Splat = @{ Name             = $Site.Name
                            ApplicationPool  = $Site.Pool
                            PhysicalPath     = $Site.Root 
                            Force            = $True }

                New-Website @Splat

                Write-Theme -Action "Generated [+]" "IIS Web Site $( $Site.Name )"

                Start-Website -Name $Site.Name

                Write-Theme -Action "Started [+]" "IIS Web Site $( $Site.Name )"
            # ____   _________________________
            #//¯¯\\__[___ Set Web Binding ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Write-Theme -Action "Binding [+]" "IIS Web Site $( $Site.Name )"

                $Splat = @{ Name             = $Site.Name
                            HostHeader       = ""
                            PropertyName     = "HostHeader"
                            Value            = $Site.URL }

                Set-WebBinding @Splat

                Write-Theme -Action "Configured [+]" $Site.URL

                $Splat = @{ Site             = $Site.Name
                            Name             = $Site.Host
                            PhysicalPath     = $Site.Directory
                            Force            = $True }

                New-WebVirtualDirectory @Splat
                
                Write-Theme -Action "Complete [+]" "http://$( $Site.URL )"
            # ____   _________________________
            #//¯¯\\__[__ WebDAV Authoring ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Write-Theme -Action "Configuring [~]" "WebDAV Authoring"
            
                $Splat = @{ PSPath           = $Site.AppHost
                            Location         = $Site.Name
                            Filter           = "$( $Site.WebServer )/webdav/authoring"
                            Name             = "Enabled"
                            Value            = "True" }

                Set-WebConfigurationProperty @Splat

                Write-Theme -Action "Complete [~]" "WebDAV Authoring"
            # ____   _________________________
            #//¯¯\\__[____ WebDAV Rules _____]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Write-Theme -Action "Generating [~]" "WebDAV Authoring Rules"
            
                $Config = $Site | % { $_.Name , $_.Host , $_.WebServer }

                $Splat = @{ FilePath         = GCI "$( $Site.System32 )\inetsrv" "*appcmd.exe" | % { $_.FullName }
                            ArgumentList     = "Set Config '{0}/{1}' /Section:{2}/webdav/authoringRules /+[Users='*',Path='*',Access='Read,Source'] /Commit:AppHost" -f $Config
                            NoNewWindow      = $True
                            PassThru         = $True }
                    
                SAPS @Splat | Out-Null
            # ____   _________________________
            #//¯¯\\__[____ Add Mime Type ____]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Write-Theme -Action "Generating [~]" "WebDAV Authoring Rules"

                $Site | % { 

                    $Splat = @{ PSPath = $_.Site
                                Filter = $_.WebServer , $_.Static -join '/'
                                Name   = "." }
                }
                
                If ( ".*" -notin ( Get-WebConfigurationProperty @Splat | % { $_.Collection } | % { $_.fileExtension } ) )
                {
                    $Splat.Add( "Value" , @{ fileExtension = '.*' ; mimeType = 'Text/Plain' } )

                    Add-WebConfigurationProperty @Splat

                    Write-Theme -Action "Configured [+]" "[ fileExtension: '.*' ] / [ mimeType: 'Text/Plain' ]"
                }
            # ____   _________________________
            #//¯¯\\__[__ Directory Browse ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Write-Theme -Action "Enabling [+]" "Directory Browsing"

                $Splat     = @{ Filter = "/$( $Site.WebServer )/DirectoryBrowse"
                                Name   = "Enabled"
                                PSPath = $Site.Site
                                Value  = $True }

                Set-WebConfigurationProperty @Splat -vb

            # ____   _________________________
            #//¯¯\\__[____ Security/Auth ____]

                $Location = ( $Site | % { $_.Name ; $_.Name , $_.Host -join '/' } )[1,1,0,1,0,1,0,1,0]

                $Filter   = @( @( "anonymous" , "windows" | % { "Authentication/$_`Authentication" } ; 
                            "FileExtensions"  , "Verbs"   | % { "RequestFiltering/$_" } ) | % { "Security/$_" } ; 
                            "/Properties"     , "Rules"   | % { "WebDAV/Authoring$_" } )[0,1,5,4,4,2,2,3,3] | % { $Site.WebServer , $_ -join '/' }
    
                $Name     = "Enabled,DefaultMimeType,AllowInfinitePropfindDepth,ApplyToWebDAV".Split(',')[0,0,1,2,2,3,3,3,3]

                $Value    = "False,True,Text/XML".Split(',')[0,1,2,1,1,0,0,0,0]

                ForEach ( $I in 0..8 )
                { 
                    $Splat = @{ PSPath   = "MACHINE/WEBROOT/APPHOST"
                                Location = $Location[$i]
                                Filter   = $Filter[$i]
                                Name     = $Name[$i]
                                Value    = $Value[$i] }
                    
                    $Names    = "Location" , "Filter" , "Name" , "Value"
                    $Values   = $Names | % { $Splat.$_ }
                    $Section  = "Setting WebConfiguration #$( $I + 1 )/9"

                    $Subtable = New-SubTable -Items $Names -Values $Values

                    $Panel    = @{ Title = "WebConfiguration"
                                   Depth = 1
                                   ID    = $Section  | % { "( $_ )" }
                                   Table = $Subtable | % { $_ } }
        
                    $Table    = New-Table @Panel

                    Write-Theme -Table $Table

                    Set-WebConfigurationProperty @Splat
                }
            # ____   _________________________
            #//¯¯\\__[___ Hidden Segments ___] # Disabled for now, recurring error "disk changes" ( This is a security issue )
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

                # Write-Theme -Action "Restarting [~]" "IIS Service" 11 12 15
                    
                # IISRESET /Stop

                # $Filter    = "system.webServer/security/requestFiltering"
                # $Attribute = "applytoWebDav"

                # Get-IISConfigSection | ? { $_.SectionPath -like "*$Filter*" } | % { $_.GetChildElement( "hiddenSegments" ).Attributes } | % { 

                #     $_.Value = $False
                # }

                # IISRESET /Start
            
            # ____   _________________________
            #//¯¯\\__[_____ File System _____]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Write-Theme -Action "Access Control [~]" "Configuring SAM / Access Control Permissions"

                'IIS_IUSRS', 'IUSR', "IIS APPPOOL\$( $Site.Pool )" | % { 

                    $Splat = @{ SAM     = $_
                                Rights  = 'ReadAndExecute'
                                Inherit = 'ContainerInherit' , 'ObjectInherit' }

                    New-ACLObject @Splat | % { Add-ACL -Path $Site.Root -ACL $_ }

                }

                'IIS_IUSRS', "IIS APPPOOL\$( $Site.Pool )"         | % {

                    $Splat = @{ SAM     = $_
                                Rights  = 'Modify'
                                Inherit = 'ContainerInherit' , 'ObjectInherit' }

                    New-AclObject @Splat | % { Add-Acl -Path "$( $Site.Root )\AppData" -ACL $_ }
                }
            # ____   _________________________
            #//¯¯\\__[__ Strictly TLS 1.2 ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Write-Theme -Action "Configuring [~]" "SCHANNEL [ SSL 2.0 - 3.0 ] & [ TLS 1.0 - 1.2 ]"

                $SSLTLS    = "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols"

                @( 2..3 | % { "SSL $_.0" } ; 0..2 | % { "TLS 1.$_" } ) | % { 
                
                    If ( ! ( Test-Path "$SSLTLS\$_" ) )
                    { 
                        NI -Path $SSLTLS -Name $_
                    }
                    
                    ForEach ( $i in "Client" , "Server" )
                    {
                        If ( ! ( Test-Path "$SSLTLS\$_\$I" ) )
                        {
                            NI -Path "$SSLTLS\$_" -Name $I
                        }

                        ForEach ( $j in "DisabledByDefault" , "Enabled" )
                        {
                            SP -Path "$SSLTLS\$_\$I" -Name $J -Value 0
                        }

                        If ( $_ -eq "TLS 1.2" )
                        {
                            SP -Path "$SSLTLS\TLS 1.2\$I" -Name "Enabled" 1
                        }
                    }
                }
            # ____   _________________________
            #//¯¯\\__[___ .Net FW TLS 1.2 ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Write-Theme -Action "Configuring [~]" ".Net Framework [ v2.0.50727 ] & [ v4.0.30319 ]"

                "" , "\WOW6432NODE" | % { "HKLM:\SOFTWARE$_\Microsoft\.NETFramework" } | % {
                    
                    ForEach ( $i in "v2.0.50727" , "v4.0.30319" )
                    {
                        If ( ! ( Test-Path "$_\$i" ) )
                        { 
                            NI -Path $_ -Name $I
                        }
                        
                        SP -Path "$_\$I" -Name "SystemDefaultTlsVersions" -Type DWORD -Value 1
                    }
                }
            # ____   _________________________
            #//¯¯\\__[_ Website / DNS Setup _]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    
            Write-Theme -Action "Pausing [~]" "Website to modify DNS record"

            Stop-Website $Site.Name

            $Resolve = Resolve-HybridDSC -Domain | % { $_.Branch }

            $Splat = @{ ZoneName = $Resolve
                        RRType   = "CNAME" }
                    
            Get-DNSServerResourceRecord @Splat | ? { $_.HostName -eq $Site.Name } | % {

                $Splat.Add(  "Name" , $_.HostName )
                $Splat.Add( "Force" , $True )

                Remove-DNSServerResourceRecord @Splat
            }

            $Splat = @{ HostNameAlias = Resolve-DnsName 127.0.0.1 | % { $_.NameHost }
                        Name          = $Site.Name
                        ZoneName      = $Resolve }

            Add-DNSServerResourceRecordCName @Splat

            $Site | % {
            
                Write-Theme -Action "Resuming [+]" "Website $( $_.Name )"
                Start-Website $_.Name

                Write-Theme -Action "Complete [+]" "Your Web Server should now be available to the internet"
                Start "http://$( $_.URL , $_.Host -join '/' )"

                Write-Theme -Action "Recommendation" "[!] You may want to configure SSL Certificates manually"

            }
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-HybridDSC # Populates Tools and Items for subfolders ___________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯       
        [ CmdLetBinding () ] Param (

            [ Parameter ( ParameterSetName =     "Images" ) ] [ Switch ] $Images     ,
            [ Parameter ( ParameterSetName = "Slipstream" ) ] [ Switch ] $Slipstream )

        $DS      = Resolve-HybridDSC -Share | % { GCI ( $_.Directory , $_.Company -join '\' ) } | % { $_.FullName }

        $Tag     = @( "DC2016" ; "E" , "H" , "P" | % { "10$_`64" , "10$_`86" } )

        If ( $Images )
        {
            # ____   _________________________
            #//¯¯\\__[___ Images Scaffold ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            
            Write-Theme -Action "Collecting [~]" "Windows Client/Server Images"

            $WimImages  = $DS | ? { $_ -like "*Images*" }

            0..6 | % { "$WimImages\($_)$( $Tag[$_] )" | ? { ! ( Test-Path $_ ) } | % { NI $_ -ItemType Directory ; NI "$_\_" -ItemType Directory } } 
            
            Write-Theme -Action "Forward Image [+]" "Scaffold Generated"

            # ____   _________________________
            #//¯¯\\__[____ ISO Scaffold _____]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            
            ForEach ( $i in @( "1607" ; 64 , 32 | % { "1909_x$_" } ) ) { "$WimImages\ISO\$I" | ? { ! ( Test-Path $_ ) } | % { NI $_ -ItemType Directory } } 
                    
            Write-Theme -Action "Windows Media [+]" "Scaffold Generated"
            
            # ____   _________________________
            #//¯¯\\__[___ Clean Source ISO __] [ Server 2016 Eval / 1909 x86 / x64 ]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            
            Write-Theme -Action "Initializing [+]" "Retrieving Images Directly from Microsoft"

            [ Net.ServicePointManager ]::SecurityProtocol = 3072

            IPMO BitsTransfer 

            $ISO    = ( GCI "$WimImages\ISO" | % { $_.FullName } )[0,2,1]

            $Client = 64 , 32 | % { "https://software-download.microsoft.com/db/Win10_1909_English_x$_.iso?t=b56fde02-8f2e-4c09-9a2d-e93a99596203" }

            $Splat  = 0..2

            # ____   _________________________
            #//¯¯\\__[_____ Server 2016 _____]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            $Splat[0]  = @{    Source = "https://software-download.microsoft.com/download/pr/Windows_Server_2016_Datacenter_EVAL_en-us_14393_refresh.ISO"
                          Destination = "$( $ISO[0] )\1607.ISO"    
                          Description = "Windows Server ( 1607.ISO ) [ Evaluation Copy ]" }

            # ____   _________________________
            #//¯¯\\__[___ Client x64 1909 ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            
            $Splat[1]  = @{    Source = "$( $Client[0] )&e=1574831548&h=0898529f30d00f99cd6fdd9b889a43f7"
                          Destination = "$( $ISO[1] )\1909x64.iso" 
                          Description = "Windows Client ( 1909_x64.ISO )" }

            # ____   _________________________
            #//¯¯\\__[___ Client x32 1909 ___]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            $Splat[2]  = @{    Source = "$( $Client[1] )&e=1574831549&h=f44e9f4e43ccd7bc7fdd3ee618073bfa"
                          Destination = "$( $ISO[2] )\1909x32.iso"
                          Description = "Windows Client ( 1909_x32.ISO )" }

            # ____   _________________________
            #//¯¯\\__[___ Clean Source ISO __]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            0..2 | % { $X = $Splat[$_] ; If ( ! ( Test-Path $X.Destination ) ) { Write-Theme -Action "Downloading [+]" $X.Description ; Start-BitsTransfer @X } }

            # ____   _________________________
            #//¯¯\\__[___ Clean Source ISO __]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            
            Write-Theme -Action "Processing [+]" "ISO -> WIM File Conversion"

            $ISO      = Resolve-HybridDSC -Root | % { GCI ( $_.Tree , "Images" -join '\' ) "*.iso*" -Recurse } | % { $_.FullName }
                    
            $Dest     = ( GCI $WimImages | % { $_.FullName } )[0..6]
                    
            $DN       = @( "Server 2016 Datacenter x64" ; "Education" , "Home" , "Pro" | % { "10 $_" } | % { "$_ x64" , "$_ x86" } ) | % { "Windows $_" }
                    
            $IP       = $ISO[ 0 , 2 , 1 , 2 , 1 , 2 , 1 ]
                    
            $SI       = 4 , 4 , 4 , 1 , 1 , 6 , 6
                    
            $SIP      = "$( 67..90 | % { [ Char ]$_ } | ? { $_ -notin ( Get-Volume | % { $_.DriveLetter } | Sort ) } | Select -First 1 ):\Sources\Install.WIM"

            $DIP      = 0..6 | % { "$( $Dest[$_] )\$( $Tag[$_] ).wim" }

            $List     = 0..6
            
            $Subtable = 0..6

            $FX       = @( "ImageName" , "Architecture" , "Version" , "InstallationType" ; "Created" , "Modified" | % { "$_`Time" } )

            ForEach ( $i in 0..6 )
            {
                Write-Theme -Action "Extracting [~]" $DN[$i]

                Mount-DiskImage -ImagePath $IP[$i]

                $Splat = @{ SourceIndex          = $SI[$i]
                            SourceImagePath      = $SIP
                            DestinationImagePath = $DIP[$i]
                            DestinationName      = $DN[$i] }
                        
                Export-WindowsImage @Splat

                Dismount-DiskImage -ImagePath $IP[$i]
                    
                Get-WindowsImage -ImagePath $DIP[$I] -Index 1 | % { 
                        
                    $List[$I] = [ PSCustomObject ]@{ 
                            
                        ImageName        = $_.ImageName
                        Architecture     = If ( $_.Architecture -eq 0 ) { "x86" } Else { "x64" }
                        Version          = $_.Version
                        InstallationType = $_.InstallationType
                        CreatedTime      = "$( $_.CreatedTime )"
                        ModifiedTime     = "$( $_.ModifiedTime )"
                    }
                }

                $Splat = @{ Items        = $FX
                            Values       = $FX | % { $List[$I].$_ } }

                $Subtable[$i] = New-SubTable @Splat
            }

            $Splat = @{ Title = "Clean Windows Image ( WIM ) Storage List"
                        Depth = 7
                        ID    = 0..6 | % { "( [ Image # $_ ] )" }
                        Table = 0..6 | % { $Subtable[$_]   } }

            $Table = New-Table @Splat

            Write-Theme -Table $Table

        }

        If ( $Slipstream )
        {
            # ____   _________________________
            #//¯¯\\__[___ Updates Scaffold __]
            #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            
            $Updates = "$( $DS[2] )\Updates" | % { If ( ! ( Test-Path $_ ) ) { NI $_ -ItemType Directory } Else { GI $_ } } | % { $_.FullName }

            ForEach ( $i in "Server" , "Client" )
            { 
                "$Updates\$I" | ? { ! ( Test-Path $_ ) } | % { 
                        
                    NI $_ -ItemType Directory 

                    Write-Theme -Action "Created [+]" "( $I ) Update Directory"
                }

                ForEach ( $j in 86 , 64 )
                {
                    "$Updates\$I\x$J" | ? { ! ( Test-Path $_ ) } | % { 
                            
                        NI $_ -ItemType Directory 
                            
                        Write-Theme -Action "Created [+]" "( $I\x$J ) Update Directory"
                    }
                }
            }

            Write-Theme -Action "Windows Update [+]" "Scaffold Generated"

            $Path = GCI $DS[2] *.wim* -Recurse | % { $_.FullName }

            $List = $Path | % { Get-WindowsImage -ImagePath $_ -Index 1 }
                    
            $Type = [ PSCustomObject ]@{ Server = @{ x64 = @( ) ; x86 = @( ) } ; Client  = @{ x64 = @( ) ; x86 = @( ) } }

            0..( $List.Count - 1 ) | % {

                $X = $List[$_]

                    $InstallType = $X.InstallationType
                    $InstallArch = $X.Architecture | % { If ( $_ -eq 9 ) { "x64" } Else { "x86" } }

                        $Type.$InstallType.$InstallArch += [ PSCustomObject ]@{ 
                        
                            WIMFile     = $Path[$_]
                            MountDir    = $Path[$_] | % { $_.Replace( $_.Split('\')[-1] , "_" ) }
                            PackagePath = "$Updates\$InstallType\$InstallArch"
                            Name        = $List[$_].ImageName
                            Version     = $List[$_].Version
                        }
                    }

                    $Process = $Type | % { $_.Server , $_.Client | % { $_.x64 , $_.x86 } }

                    ForEach ( $I in 0..( $Process.Count - 1 ) )
                    {
                        $Process[$I] | % { 
                        
                            If ( ( $_ -ne $Null ) -and ( ( GCI $_.PackagePath *.msu* ) -ne $Null ) ) 
                            {
                                Write-Theme -Action "Detected [+]" "Update Image Catalog"

                                $Splat = @{ ImagePath = $_.WimFile 
                                            Index     = 1
                                            Path      = $_.MountDir }

                                Write-Theme -Action "Mounting [~]" "$( $_.Name )"

                                Mount-WindowsImage @Splat

                                $Splat = @{ PackagePath = $_.PackagePath
                                            LogPath     = "AddPackage.log" 
                                            IgnoreCheck = $True }
                            
                                Write-Theme -Action "Processing [~]" "Update Packages"
                                    
                                Add-WindowsPackage @Splat

                                Write-Theme -Action "Cleaning [~]" "Component Store Cleanup"

                                DISM /Image:$( $_.MountPath ) /Cleanup-Image /StartComponentCleanup /ResetBase
                            
                                Write-Theme -Action "Dismounting [~]" "$( $_.Name )"

                                DISM /Unmount-WIM /MountDir:$( $_.MountDir ) /Commit

                                Write-Theme -Action "Complete [+]" "$( $_.Name )"
                            }
                        }
                    }
                
                    Write-Theme -Action "Updated [+]" "Imaging Catalog"
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____   
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Update-Branding # Updates the branding ( TEH WEI KING ) ___________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯       
        [ CmdLetBinding () ] Param (

            [ Parameter ( Mandatory = $True ) ] [ String ] $Logo ,
            [ Parameter ( Mandatory = $True ) ] [ String ] $Background ,
            [ Parameter ( Mandatory = $True ) ] [ String ] $Network    )

        $SD , $SR , $SYS , $PGD = @( $env:SystemDrive ; $env:SystemRoot | % { $_ , "$_\System32" } ; $env:ProgramData )

        If ( $Network )
        {
            $Root = Resolve-HybridDSC -DeploymentServer
        }
    
        Else
        {
            $Root = Resolve-HybridDSC -Share
        }

        # File Links

        $File = @( $SR | % { "$_\System32" | % { $_ ; "$_\OOBE\Info" | % { $_ ; "$_\Backgrounds" } } ; 
                "$_\Web" | % { "$_\Screen" , "$_\Wallpaper\Windows" } } ; "$PGD\Microsoft\User Account Pictures" )

        # New Items

        $File[0..2]   | % { 
        
            If ( ! ( Test-Path $_ ) )
            { 
                NI -Path $_ -ItemType Directory
                Write-Theme -Action "Created [+]" "OEM Background Directory" 
            }
        }

        # Registry Links

        $Registry  = 0..3 | % { 
        
            ( "CU" , "LM" , "LM" , "LM"  | % { "HK$_`:\Software" } )[$_] , ( "" , "" , "" , "Policies\" | % { "$_`Microsoft\Windows" } )[$_] ,
            @( "Policies\System" , "OEMInformation" , "Authentication\LogonUI\Background" | % { "CurrentVersion\$_" } ; "Personalization" )[$_] -join '\' 
        }

        $Registry[0..3] | % { 
        
            $X = Split-Path -Parent $_
            $Y = Split-Path -Leaf $_

            If ( ! ( Test-Path "$X\$Y" ) )
            {
                NI -Path $X -Name $Y -Force
                Write-Theme -Action "Created [+]" "Registry Key / $Y"
            }
        }

        # Copy Items

        $File[ 0 , 1 , 5 ] | % { CP $Root.Logo       $_ }
        $File[ 2..4 ]      | % { CP $Root.Background $_ }

        # Set Properties

        0..8 | % { 

            $I = @{ 

                Path   = $Registry[0,0,1,1,1,1,1,3,2][$_]
                Name   = @( "" , "Style" | % { "Wallpaper$_" } ; "Logo" , "Manufacturer" ; "Phone" , "Hours" , "URL" | % { "Support$_" } ; 
                            "LockScreenImage" , "OEMBackground" )[$_]
                Value  = ( $Root | % { "$( $File[4] )\$( $_.Background )" , 2 , "$SYS\$( $_.Logo )" , $_.Company , $_.Phone , $_.Hours , $_.WWW , 
                         "$( $File[3] )\$( $_.Background )" , 1 } )[$_]
            }

            SP @I -VB
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-LocalMachine # Turns local machine information into an object _____//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ PSCustomObject ]@{ 
            
            ComputerName  = $Env:ComputerName
            Architecture  = $Env:Processor_Architecture
            SystemDrive   = $Env:SystemDrive
            SystemRoot    = $Env:SystemRoot
            System32      = "$Env:SystemRoot\System32"
            ProgramData   = $Env:ProgramData
            ProgramFiles  = $Env:ProgramFiles
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Unlock-Script # Allows for elevation ( Not Finished ) _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ ValidateScript ({ Test-Path $_ })] 

            [ Parameter ( Mandatory ) ] [ String ] $FilePath     ,
            [ Parameter ( Mandatory ) ] [ String ] $ArgumentList )

        
        $CS = GCIM Win32_OperatingSystem

        "Security.Principal.Windows" | % { IEX "( [ $_`Principal ] [ $_`Identity ]::GetCurrent() ).IsInRole( 'Administrator' )" }

        !$? | % { 
        
            GCIM Win32_OperatingSystem | % { 
        
                If ( [ Int ]$_.BuildNumber -gt 6000 )
                {
                    Set-ExecutionPolicy ByPass -Scope Process -Force
                }

                Else
                {
                    Read-Host "[!] Access Failed. Press Enter to Exit"
                    Break
                }
            }
        }

        $? | % { 
            
            $Process                          = New-Object System.Diagnostics.Process
            $Process                          | % { 

                $_.StartInfo                  = New-Object System.Diagnostics.ProcessStartInfo( $FilePath , $ArgumentList )
                $_.StartInfo                  | % { 
    
                    $_.RedirectStandardOutput = $True
                    $_.UseShellExecute        = $False
                    $_.WindowStyle            = [ System.Diagnostics.ProcessWindowStyle ]::Hidden
                }
    
                $_.Start()                    | Out-Null
                $_.BeginOutputReadLine()
                $_.WaitForExit()
                $exitCode                     = $_.ExitCode
                $_.Dispose()
            }
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Export-BridgeScript # Exports the bridge script ___________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

        $FullDom        = Resolve-HybridDSC -Domain 
        $FullDom        | % {
    
            $NetBIOS    = $_.NetBIOS
            $DNS        = $_.Branch
            $Domain     = $_.Domain 
        }

        $Root           = Resolve-HybridDSC -Share
        $Root           | % { 

            $Company    = $_.Company 
            $Server     = $_.Server
            $Drive      = $_.DSDrive.Replace( ":" , "" )
            $DeployRoot = "\\$Server\$( $_.Samba )"
            $HybridRoot = "$DeployRoot\$( $_.Company )"
        }

        If ( $Domain )
        {
            Write-Theme -Action "Detected [+]" "Domain Environment, loading ADDS Login"

            $DCCred = Invoke-Login -DC ( $Root.Server ) -Domain $DNS
        }

        If ( ! $Domain )
        {
            Write-Theme -Action "Detected [+]" "Workgroup Environment, loading Local User Login"
            
            Do
            {
                Add-Type -AssemblyName System.DirectoryServices.AccountManagement

                $DCCred = Get-Credential
        
                $X      = $DCCred | % { Get-LocalUser -Name $_.UserName -EA 0 }
        
                $Y      = [ System.DirectoryServices.AccountManagement.PrincipalContext ]::New( "Machine" , $ENV:ComputerName ) | % { 
        
                    $_.ValidateCredentials( $DCCred.UserName , $DCCred.GetNetworkCredential().Password ) | ? { $True }
                
                }

                If ( ( $X -eq $Null ) -or ( $X.Enabled -ne $True ) -or ( $Y -eq $False ) )
                {
                    Switch( $Host.UI.PromptForChoice( "Invalid Credential" , "Attempt login again?" , 
                    [ System.Management.Automation.Host.ChoiceDescription [] ]@( "&Yes" , "&No" ) , [ Int ] 0 ) )
                    {
                        0 
                        { 
                            $DCCred = $Null 
                        } 
                        
                        1 
                        { 
                            $Exit = 1 
                        }
                    }
                }
        
                Else
                {
                    $DCCred
                }
            }

            Until ( ( $DCCred -ne $Null ) -or ( $Exit -eq 1 ) )
        }

        $RootVar         = [ PSCustomObject ]@{

            Company      = $Company
            NetworkShare = $DeployRoot
            DSDrive      = $Drive
            Description  = $Root.Description
            Server       = $Server
            DomainUser   = $DCCred.UserName
            DomainPass   = $DCCred.GetNetworkCredential().Password
            Website      = $Root.WWW
            Phone        = $Root.Phone
            Hours        = $Root.Hours
            Logo         = GCI $HybridRoot "*$( $Root.Logo.Split('\')[-1] )*" -Recurse | % { $_.FullName }
            Background   = GCI $HybridRoot "*$( $Root.Background.Split('\')[-1] )*" -Recurse | % { $_.FullName }
            Certificate  = ""
            Domain       = $DNS
            LocalUser    = $Root.LMCred_User
            LocalPass    = $Root.LMCred_Pass
            Proxy        = $Root.IIS_Proxy
            NetBIOS      = $NetBIOS
            Directory    = $Root.Directory
        }

        SC "$DeployRoot\root.txt" -Value ( $RootVar | ConvertTo-JSON )
        SC "$Env:AppData\root.txt" -Value ( $RootVar | ConvertTo-JSON )

        <# Variables #> # $DeployRoot\root.txt
        <#    Script #> # $DeployRoot\Scripts\Initialize-Hybrid.ps1
        <#     Timer #> # $DeployRoot\Scripts\New-RunScheduledTask.ps1

        $Return = @"
       
        `$DeployRoot   = "$( $Rootvar.NetworkShare )"
        `$Root         = '$( GC "$DeployRoot\root.txt" )' | ConvertFrom-JSON
        `$Company      = "$( $Root.Company )"
        `$Timer , `$Hybrid = "New-RunScheduledTask" , "Initialize-Hybrid" | % {

            "`$DeployRoot\Scripts\`$_.ps1"
        }
        
        CP "`$DeployRoot\root.txt" "`$Env:AppData\root.txt"

        SAPS PowerShell -Verb RunAs -ArgumentList "-File `$Timer -Args -Path `$Hybrid"
"@

        SC "$DeployRoot\Scripts\Import-BridgeScript.ps1" $Return -Force -VB
        
        [ PSCustomObject ]@{ 

            DCCred  = $DCCred
        }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Update-HybridDSC # Recycles *all* Deployment Share Content ________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
            Write-Theme -Action "Provision Root [~]" "MDT Imaging/Task Sequence Recycler"
        # ____   _________________________
        #//¯¯\\__[___ Provisional Root __]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            
        $Provision                      = [ PSCustomObject ]@{ 
        
            Return                      = @( )

            Output                      = @( )

            Titles                      = 'Desired State Controller @ Source' , 
                                       'Current Machine @ Variables' ,
                                       'Provision Index @ Target Folder Structure'

            Names                       = 'Name,Controller,PSDrive,SMBShare,NetworkPath,HybridRoot' , 
                                          'ComputerName,Architecture,SystemDrive,SystemRoot,System32,ProgramData,ProgramFiles' ,
                                          'Resources,Tools,Images,Profiles,Certificates,Applications'
            
            Root                        = ""

            Path                        = ""
        }

            Resolve-HybridDSC -Share    | % { 

                $Provision.Root         = $_

                $Provision.Path         = $Env:SystemDrive , $_.Company -join '\'

                $Provision.Return      += [ PSCustomObject ]@{ 
            
                    Name                = $_.Company
                    Controller          = $_.Server
                    PSDrive             = $_.DSDrive.Replace( ':' , '' )
                    SMBShare            = $_.Samba
                    NetworkPath         = "\" , $_.Server , $_.Samba -join '\'
                    HybridRoot          = "\" , $_.Server , $_.Samba , $_.Company -join '\'
                }
            }

            Resolve-LocalMachine        | % { 

                $Provision.Return      += $_ 
            }

            $X                          = $Provision.Names[2].Split(',')

            $Provision.Return          += [ PSCustomObject ]@{ 

                Resources               = $Provision.Path , "\(0)" , $X[0] -join ''
                Tools                   = $Provision.Path , "\(1)" , $X[1] -join ''
                Images                  = $Provision.Path , "\(2)" , $X[2] -join ''
                Profiles                = $Provision.Path , "\(3)" , $X[3] -join ''
                Certificates            = $Provision.Path , "\(4)" , $X[4] -join ''
                Applications            = $Provision.Path , "\(5)" , $X[5] -join ''
            }

            0..2                        | % {

                $Provision.Output      += New-Subtable -Items $Provision.Names[$_] -Values $Provision.Return[$_]
            }

            $Subtable[0]                = New-Subtable -Items $Names -Values $Values
            $Subtable[1]                = New-Subtable -Items $Names -Values $Values
            $Subtable[2]                = New-Subtable -Items $Names -Values $Values

        # ____   _________________________
        #//¯¯\\__[____ Display Panel ____]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $Panel                      = @{ 
            
                Title                   = "Provisional Root Index"
                Depth                   = 3
                ID                      = $Section | % { "( $_ )" }
                Table                   = $Subtable }

            $Table                      = New-Table @Panel

            Write-Theme -Table $Table -Prompt "Press Enter to Continue, or CTRL+C to Exit"
        # ____   _________________________
        #//¯¯\\__[__ Get Deploy/Share  __]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            Write-Theme -Action "Loading [+]" "MDT Drive Content"

            Import-MDTModule

            $X                          = GDR -PSProvider MDTProvider

            If ( $X -ne $Null )
            {
                $X                      = $X | ? { $_.Name -like "*$( $Root.DSDrive.Split(':')[0] )*" -and $_.Root -eq $Root.Directory }
            }
                    
            If ( $X -eq $Null )
            {
                $X                      = Get-MDTPersistentDrive
                        
                If ( $X -eq $Null )
                {
                    $Root               | % { 

                        $Splat          = @{ 
                            
                            Name        = $_.DSDrive.Split(':')[0]
                            PSProvider  = "MDTProvider"
                            Root        = $_.Directory
                            Description = $_.Description
                            NetworkPath = $Provision.NetworkPath }
                    }

                    NDR @Splat -VB      | Add-MDTPersistentDrive
                }

                If ( $X -ne $Null )
                {
                    GSMBS               | ? { $_.Path -eq $X.Path } | % {
                            
                        $Splat          = @{ 
                        
                            Name        = $X.Name
                            PSProvider  = "MDTProvider"
                            Root        = $_.Path
                            Description = $X.Description 
                            NetworkPath = "\\$ENV:ComputerName\$( $_.Path )" }
                    }
                            
                    NDR @Splat -VB
                }
            }
        # ____   _________________________
        #//¯¯\\__[_ Shape Variable Tree _]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $DeployRoot                 = Resolve-HybridDSC -Share | % { GCI $_.Directory } | % { $_.FullName }
                    
            $HybridRoot                 = $DeployRoot | ? { $_ -like "*$( $Root.Company )*" } | % { gci $_ } | % { $_.FullName }

            $Tag                        = @( "DC2016" ; "E" , "H" , "P" | % { "10$_`64" , "10$_`86" } )

            $Names                      = @( 'ImageName' , 'Architecture' , 'Version' , 'InstallationType' ; 'Created' , 'Modified' | % { "$_`Time" } )
        # ____   _________________________
        #//¯¯\\__[__ Get Stored Images __]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $Catalog                    = @{ 
                    
                Hybrid                  = @{ 
                
                    Title               = "Hybrid-DSC Client/Server Windows Image Recycler Panel"
                
                    Images              = $HybridRoot | ? { $_ -like "*Images*" } | % { GCI $_ "*.wim*" -Recurse } | % { $_.FullName } 
                
                }

                Deploy                  = @{ 
                
                    Title               = "MDT Boot Image Client/Server Windows Image Panel"
                    Images              = $DeployRoot | ? { $_ -like "*Operating System*" } | % { GCI $_ "*.wim*" -Recurse } | % { $_.FullName } 
                
                }
            }

            $Catalog                    | % { $_.Deploy , $_.Hybrid } | % { 

                $Title                  = $_.Title 
                $Images                 = $_.Images
                        
                If ( $Images -eq $Null )
                {
                    Write-Theme -Action "Not Detected [!]" "$Title"
                }

                Else
                {                    
                    If ( $Images.Count -eq 1 )
                    {
                        Write-Theme -Action "Detected [+]" "( 1 ) Image, obtaining details"
                        
                        $Count          = 0

                        $List           = Get-WindowsImage -ImagePath $Images -Index 1
                    }

                    If ( $Images.Count -gt 1 )
                    { 
                        Write-Theme -Action "Detected [+]" "( $( $Images.Count ) ) Images, obtaining details"
                        
                        $Count          = 0..( $Images.Count - 1 )

                        $List           = $Count | % { Get-WindowsImage -ImagePath $Images[$_] -Index 1 }
                    }

                    $Store              = $List  | % { 
                        
                        [ PSCustomObject ]@{ 
                            
                            ImageName        = $_.ImageName
                            Architecture     = @( "x86" ; 1..8 | % { "" } ; "x64" )[ $_.Architecture ]
                            Version          = $_.Version
                            InstallationType = $_.InstallationType
                            CreatedTime      = $_.CreatedTime
                            ModifiedTime     = $_.ModifiedTime 
                        }
                    }
                    
                    $Panel              = @{ 
                    
                        Title           = $Title
                        Depth           = "" 
                        ID              = ""
                        Table           = "" 
                    }

                    If ( $Images.Count -eq 1 )
                    {
                        $Values         = $Names | % { "$( $Store.$_ )" }
                      
                        $Section        = $Store.ImageName

                        $Subtable       = New-SubTable -Items $Names -Values $Values

                        $Panel          | % { 

                            $_.Depth    = 1
                            $_.ID       = "( $( $Section ) )"
                            $_.Table    = $Subtable 

                        }
                    }

                    If ( $Images.Count -gt 1 )
                    {
                        $Count          = 0..( $Store.Count - 1 )

                        $Section        = $Count | % { $_ }
                        $Subtable       = $Count | % { $_ }

                        ForEach ( $I in $Count )
                        { 
                            $X              = $Store[$I] 

                            $Values         = $Names | % { "$( $X.$_ )" }
                      
                            $Section[$I]    = $X.ImageName
                            
                            $Subtable[$I]   = New-SubTable -Items $Names -Values $Values
                        }

                        $Panel              | % { 
                                        
                            $_.Depth       = $Store.Count
                            $_.ID          = $Count | % { "( $( $Section[$_] ) )" }
                            $_.Table       = $Count | % { $Subtable[$_] }
                        }
                    }

                    $Table                 = New-Table @Panel

                    Write-Theme -Table $Table

                    Read-Host "$( "¯" * 116 )`nCarefully review these details. `nPress Enter to Continue"
                }
            }
        # ____   _________________________
        #//¯¯\\__[____ Recycle DISM _____]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $DeployRoot     | ? { $_ -like "*Operating Systems*" } | % { GCI $_ } | ? { $_ -ne $Null } | % { RI $_.FullName -Recurse -Force -VB }

            $Output         = $HybridRoot | ? { $_ -like "*Images*" }

            $Output         | % { GCI $_ "*.wim*" } | ? { ! $Null } | % { RI $_.FullName -VB }
                    
            $Dest           = "$Output\$( Get-Date -UFormat "%m%d%Y" )"

            $Names          = @( "ImagePath" , "Index" | % { "Source$_" } ; "ImagePath" , "Name" | % { "Destination$_" } )

            ForEach ( $I in 0..( $Store.Count - 1 ) )
            {
                $Store[$I] | % { 
                
                    $Splat = @{

                        SourceImagePath      = $Catalog.Hybrid.Images[$I]
                        SourceIndex          = 1
                        DestinationImagePath = "{0}.x{1}_{2}.wim" -f $Dest , $_.InstallationType , $_.Version
                        DestinationName      = $_.ImageName
                        Verbose              = $True
                    }
                }

                $Values = $Names | % { $Splat.$_ }

                New-SubTable -Items $Names -Values $Values | % { 

                    New-Table -Title "DISM -> MDT" -Depth 1 -ID "( $( $Tag[$I] ) )" -Table $_ | % {

                        Write-Theme -Table $_
                    }
                }

                Export-WindowsImage @Splat
            }
        # ____   _________________________
        #//¯¯\\__[__ Clear MDT Content __]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $MDTOS      = $DeployRoot | ? { $_ -like "*Operating Systems*" } 
                    
            $MDTOS      | % { GCI $_ } | ? { ! $Null } | % { RI $_.FullName -VB -Recurse -Force }
                    
            $Paths      = "Operating Systems" , "Task Sequences" | % { $Root.DSDrive , $_ -join '\' } 
                    
            ForEach ( $I in $Paths )
            {
                GCI $I | % { 
                    
                    Write-Theme -Action "Relinquishing [+]" "$I\$( $_.Name )" 12 4 15
                    RI "$I\$( $_.Name )" -Recurse -Force 
                }
            }
        # ____   _________________________
        #//¯¯\\__[____ Recycle MDT ______]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $Output     | % { GCI $_ "*.wim*" } | % { 

                $File   = $_.FullName
                    
                $Parent , $Child = $_.BaseName.Split( '_' )

                $Parent = $Parent.Split( 'x' )[-1]

                "Operating Systems" , "Task Sequences" | % { 

                    $Splat = @{ Path     = "$( $Root.DSDrive )\$_"
                                Enable   = "True"
                                Name     = "$Parent"
                                Comments = "$( Get-Date -UFormat "%m%d%Y" )"
                                ItemType = "Folder" }
                            
                    Write-Theme -Action "Generating [+]" "$( $Splat.Path )\$Parent"
                            
                    New-Item @Splat | Out-Null

                    $Splat | % { 
                            
                        $_.Path = "$( $_.Path )\$Parent"
                        $_.Name = "$Child"
                    }

                    Write-Theme -Action "Generating [+]" "$( $Splat.Path )\$Child"

                    New-Item @Splat | Out-Null
                }

                $Splat = @{ Path              = "$( $Root.DSDrive )\Operating Systems\$Parent\$Child" 
                            SourceFile        = $File
                            DestinationFolder = $Child
                            Move              = $True   }
                        
                Write-Theme -Action "Importing [+]" "Operating System Image File" 11 11 15

                Import-MDTOperatingSystem @Splat | Out-Null
            }
        # ____   _________________________
        #//¯¯\\__[____ Task Sequences ___]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $Control  = GCI $Output "*Control*" | % { $_.FullName }

            $Toggle   = If ( $Root.Remaster -eq "-" ) { "MDT" } Else { "PSD" }

            ForEach ( $I in "Server" , "Client" )
            {
                $TS , $OS = "Task Sequences" , "Operating Systems" | % { $Root.DSDrive , $_ , $I -join '\' }

                $Build    = GCI $OS | % { $_.Name }

                GCI "$OS\$Build" | % {

                    $ID          = [ PSCustomObject ]@{
                        
                        Name     = $_.Name
                        GUID     = $_.GUID
                        Arch     = ""
                        Type     = ""
                        Path     = ( $Control , "\" + $Toggle + $I + "Mod.xml" ) -join ""
                        Template = ""
                    }

                    $ID.Arch     = 86 , 64 | ? { $ID.Name -match "x$_" }
                        
                    $ID.Template = GC $ID.Path
                    
                    0..( $ID.Template.Count - 1 ) | ? { $ID.Template[$_] -like "*OSGUID*" } | % { 

                        $ID.Template[$_] = $ID.Template[$_] | % { $_.Split( '{' )[0] , $ID.GUID , $_.Split( '}' )[1] -join '' }
                    }

                    SC $ID.Path -Value $ID.Template
                    
                    $ID.Type = $( If ( $I -eq "Server" ) { "DC2016" } Else 
                    { 
                        ( "Educ" , "E" ) , ( "Home" , "H" ) , ( "Pro" , "P" ) | ? { $ID.Name -match $_[0] } | % { 10 , $_[1] , $ID.Arch -join '' } 
                    })

                    $Splat = @{ Path                = "$TS\$Build"
                                Name                = $ID.Name
                                Template            = $ID.Path
                                Comments            = "Secure Digits Plus LLC [ Fighting Entropy ]"
                                ID                  = $ID.Name
                                Version             = "1.0"
                                OperatingSystemPath = $OS , $Build , $ID.Name -join '\'
                                FullName            = $Root.LMCred_User
                                OrgName             = $Root.Company
                                HomePage            = $Root.WWW
                                AdminPassword       = $Root.LMCred_Pass }

                    Write-Theme -Action "Importing [+]" ( "Task Sequence {0}" -f $ID.Name )

                    Import-MDTTaskSequence @Splat | Out-Null

                }
            }

            Write-Theme -Action "Imported [+]" "Task Sequences" 11 11 15
        # ____   _________________________
        #//¯¯\\__[____ Share Settings ___]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $Names  = @( "Comments" , "MonitorHost" ; 
            64 , 86 | % { "Boot.x$_" } | % { "$_.GenerateLiteTouchISO" ; "$_.LiteTouch" | % { "$_`WIMDescription" , "$_`ISOName" } ; "$_.BackgroundFile" } )

            $Values = @( "Secure Digits Plus LLC : Fighting Entropy ($( [ Char ]960 ))" , $Root.Server ; 
            64 , 86 | % { "True" ; "$( $Root.Company ) (x$_)" | % { "$_" , "$_.iso" } ; $Root.Background } )

            GP $Root.DSDrive | % { 
                        
                ForEach ( $i in 0..9 )
                {
                    If ( $_.$( $Names[$I] ) -ne $Values[$I] )
                    {
                        SP $Root.DSDrive -Name $Names[$I] -Value $Values[$I]

                        Write-Host ( "_" * 116 )

                        Write-Theme -Function "$( $Names[$I] )" 11 11 15

                        Write-Theme -Action "Configured [+]" "$( $Values[$I] )" 11 11 15

                        Write-Host ( "¯" * 116 )
                    }
                }
            }
        # ____   _________________________
        #//¯¯\\__[__ Enable Monitoring __]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            Write-Theme -Action "Resetting [~]" "MDT Monitor Service"
                    
            GCIM Win32_Service | ? { $_.Name -eq "MDT_Monitor" } | % {
            
                If ( $_.State -eq "Running" )
                {
                    Try { Disable-MDTMonitorService }

                    Catch { Set-Service -Name MDT_Monitor -Status Stopped }
                }
            }
                
            $Splat = @{ EventPort = 9800 ; DataPort  = 9801 }

            Enable-MDTMonitorService @Splat

            $Control = $DeployRoot | ? { $_ -like "*Control*" }
            $Script  = $DeployRoot | ? { $_ -like "*Scripts*" }

        # ____   _________________________
        #//¯¯\\__[____ Bridge Script ____]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            Write-Theme -Action "Login [~]" "Provide a valid Deployment Credential"

            Export-BridgeScript | % { $DCCred = $_.DCCred }

            $FullUpdate                = 0
        # ____   _________________________
        #//¯¯\\__[____ Bootstrap INI ____]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $BootStrap                 = @{ 
                    
                Settings               = @{
                        
                    Priority           = "Default" 
                }
                        
                Default                = @{
                        
                    DeployRoot         = $Provision.NetworkPath
                    UserID             = $DCCred.Username
                    UserPassword       = $DCCred.GetNetworkCredential().Password
                    UserDomain         = $Root.Branch 
                    SkipBDDWelcome     = "YES" 
                } 
            }

            $Splat                     = @{ 
                    
                Path                   = $Control
                Name                   = "Bootstrap.ini"
                Table                  = $Bootstrap
                Encoding               = "UTF8"
                UTF8NoBom              = $True 
                Force                  = $True 
            }

            $File                      = [ PSCustomObject ]@{ 

                Script                 = Convert-HashToArray -Table $Bootstrap
                Content                = GC "$Control\Bootstrap.ini"
                Match                  = @( )
            }

            0..( $Compare.Count - 1 )  | % { 
            
                If ( $File.Script[$_] -ne $File.Content[$_] ) 
                {
                    Write-Theme -Action "Confirmed [+]" "Updating Bootstrap.ini"
                    Export-INI @Splat
                    $FullUpdate        = 1
                    Break
                }
            }

        # ____   _________________________
        #//¯¯\\__[_ CustomSettings INI __]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $CustomSettings            = @{ 
                    
                Settings               = @{ 
                        
                    Priority           = "Default" 
                    Properties         = "MyCustomProperty" 
                } 
                        
                Default                = @{

                    _SMSTSOrgName      = $Root.Company
                    OSInstall          = "Y" 
                    SkipCapture        = "NO" 
                    SkipAdminPassword  = "YES" 
                    SkipProductKey     = "YES" 
                    SkipComputerBackup = "NO" 
                    SkipBitLocker      = "YES" 
                    KeyboardLocale     = "en-US" 
                    TimeZoneName       = Get-TimeZone | % { $_.ID } 
                    EventService       = "http://$( $Root.Server ):9800"
                } 
            }

            $Splat                     | % { 
                    
                $_.Name                = "CustomSettings.ini"
                $_.Table               = $CustomSettings 
            }

            $File                      = [ PSCustomObject ]@{ 

                Script                 = Convert-HashToArray -Table $CustomSettings
                Content                = GC "$Control\CustomSettings.ini"
                Match                  = @( )
            }

            0..( $Compare.Count - 1 )  | % { 
            
                If ( $File.Script[$_] -ne $File.Content[$_] ) 
                {
                    Write-Theme -Action "Confirmed [+]" "Updating CustomSettings.ini"
                    Export-INI @Splat
                    $FullUpdate        = 1
                    Break
                }
            }
            
        # ____   _________________________
        #//¯¯\\__[_____ PXE Graphics ____]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            ForEach ( $i in "computer.png" , "header-image.png" )
            {
                $X = GCI $HybridROot "*$I*" -Recurse | % { $_.FullName }
                $Y = "$Script\$I"

                If ( ( GP $X ).CreationTime -ne ( GP $Y ).CreationTime )
                {
                    CP $X $Y -Force
                    
                    Write-Theme -Action "Copied [+]" "PXE Graphic ( $I )" 11 11 15
                    
                    $FullUpdate        = 1
                }
            }
        # ____   _________________________
        #//¯¯\\__[___ MDT Boot Images ___]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            Write-Theme -Action "Updating [~]" "Deployment Share"

            If ( $FullUpdate -eq 1 )
            {
                Update-MDTDeploymentShare -Path $Root.DSDrive -Force -VB
            }

            If ( $FullUpdate -eq 0 )
            {
                Update-MDTDeploymentShare -Path $Root.DSDrive -VB
            }
        
        # ____   _________________________
        #//¯¯\\__[___ WDS Boot Images ___]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            $OEM , $LT = $Provision.Name.Replace( ' ' , '_' ) , "LiteTouchPE"

            $Boot      = $Root.Directory | % { GCI $_ *Boot* } | % { $_.FullName }

            $Boot      | % { GCI $_ *$OEM* } | % { RI $_.FullName -VB }

            $Boot      | % { GCI $_  *$LT* } | % { RNI $_.FullName -NewName $_.FullName.Replace( $LT , $OEM ) -VB }

            $WDSImages = $Boot | % { GCI $_ *.wim* } 

            $WDSBoot   = [ PSCustomObject ]@{ 

                Path   = $WDSImages | % { $_.FullName }
                Arch   = 64 , 86
                Name   = $WDSImages | % { Get-WindowsImage -ImagePath $_.FullName } | % { $_.ImageName }
            }
                    
            ForEach ( $I in 0..1 )
            {
                $WDSBoot | % { 

                    $Path = $_.Path[$I]
                    $Arch = $_.Arch[$I]
                    $Name = $_.Name[$I]
                }

                Get-WDSBootImage -Architecture "X$Arch" -ImageName $Name -EA 0 | ? { ! $Null } | % {

                    Write-Theme -Action "Found [~]" "$Name"
                            
                    Remove-WDSBootImage -Architecture "x$Arch" -ImageName $Name

                    Write-Theme -Action "Removed [+]" "$Name"
                }

                Write-Theme -Action "Importing [~]" "$Name"

                Import-WDSBootImage -Path $Path -NewDescription $Name -SkipVerify
                    
            }

            Write-Theme -Action "Complete [+]" "WDS Boot Images Recyled"
            
        # ____   _________________________
        #//¯¯\\__[_ Restart WDS Service _]
        #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            Write-Theme -Action "Restarting [~]" "WDS Service"

            Restart-Service -Name WDSServer

            If ( $? -eq $True )
            { 
                Write-Theme -Foot
                Write-Theme -Action "Successful [+]" "Hybrid-DSC Fully Recycled"
            }

            Else
            { 
                Write-Theme -Action "Exception [!]" "The WDS Service has experienced an issue" 12 4 15
            }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Sync-DNSSuffix # Modified / Jeff Hicks @ github.com/jdhitsolutions _________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( 
        
            # Not supporting multiple or network based computers yet.
            # Based on registry modification, was still very critical to implement domain membership sync

            [ Parameter ( Position = 0 , ParameterSetName = "Get" ) ] [ Switch ] $Get    ,
            [ Parameter ( Position = 0 , ParameterSetName = "Set" ) ] [ Switch ] $Set    ,
            [ Parameter ( Position = 1 , ParameterSetName = "Set" ) ] [ Switch ] $Domain )

            Begin 
            {
                $Query = "HKLM:\System\CurrentControlSet\Services\TCPIP\Parameters"
                $CS    = GCIM Win32_ComputerSystem
            }

            Process
            {
                If ( $Get )
                {
                    GP $Query | % { 

                        [ PSCustomObject ]@{

                            Computername      = $_.hostname
                            Domain            = $_.Domain
                            'NV Domain'       = $_.'NV Domain'
                            SynchronizeSuffix = $_.SyncDomainWithMembership -as [ Bool ]
                        }
                    }
                }

                If ( $Set )
                {
                    If ( ! ( $CS.PartOfDomain ) )
                    {
                        "Domain" | % { $_ , "NV $_" } | % { 
                        
                            SP -Path $Query -Name $_ -Value $Domain
                        }

                        SP -Path $Query -Name SyncDomainWithMembership -Value 1
                    }

                    If ( $CS.PartOfDomain )
                    {
                        [ System.Windows.Forms.MessageBox ]::Show( "System is part of a domain" , "Exception" )
                    }
                }
            }                                                                        #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
     Function Register-PDCTimeSource # What Free Actually Means _________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
     {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True ) ] [ String [] ] $Servers        ,
            [ Parameter ( Position = 1 ) ]                     [    Int    ] $Phase   = 3600 )

        $Time = "HKLM:\SYSTEM\CurrentControlSet\Services\W32Time"

        ( "Parameters"              , "Type"                  ,    "NTP" ) ,
        ( "Config"                  , "AnnounceFlags"         ,        5 ) ,
        ( "TimeProviders\NTPServer" , "Enabled"               ,        1 ) ,
        ( "Parameters"              , "NTPServer"             , $Servers ) ,
        ( "Config"                  , "MaxPosPhaseCorrection" ,     3600 ) | % {

            $Splat    = @{ 
            
                Path  = $Time , $_[0] -join '\'
                Name  = $_[1]
                Value = $_[2]
            }

            SP @Splat

            Write-Theme -Action   $_[1] $_[2] 
            Write-Theme -Function $Splat.Path
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DiskInfo # Report consumable disk info _________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( 
        
            [ Parameter ( ValueFromPipeline ) ] [ String ] $ComputerName = $env:COMPUTERNAME )
 
        GWMI Win32_LogicalDisk | ? { $_.DriveType -eq 3 } | % { 

            $Size = ( $_.Size / 1GB )
            $Free = ( $_.FreeSpace / 1GB ) | % { $_ , ( ( $_ * 100 ) / $Size ) }
            $Used = ( ( $_.Size - $_.FreeSpace ) / 1GB ) | % { $_ , ( ( $_ * 100 ) / $Size ) }

            [ PSCustomObject ]@{ 

                DriveLetter  = $_.DeviceID
                DriveLabel   = $_.VolumeName | % { If ( !$_ ) { "N/A" } Else { $_ } }
                Total        = "{0:n2}GB" -f $Size
                Free         = "{0:n2}GB ({1:n2}%)" -f $Free
                Used         = "{0:n2}GB ({1:n2}%)" -f $Used
            }
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Publish-HybridDSC # Publishes the content to a package for distribution ____//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        "$Home\Documents\WindowsPowerShell\Modules" | % { 
    
            $Package                    = [ PSCustomObject ]@{ 
    
                Name                    = "Hybrid-DSC"
                Root                    = $_
                Full                    = ""
                Folders                 = ""
                Files                   = ""
                Install                 = "Install-HybridDSCModule"
            }
        }

        $Package | % {
            
            $_.Full                     = $_.Root , $_.Name -join '\'
            $_.Folders                  = $_.Full | % { GCI $_ -Directory }

            $_.Folders.FullName         | % { 

                $Splat                  = @{

                    Path                = "$_"
                    DestinationPath     = "$_.zip"
                }

                $Splat.DestinationPath | ? { Test-Path $_ } | % { RI $_ -Force }

                Compress-Archive @Splat -VB
            }

            $_.Files                    = GCI $_.Full -File
            $_.Files.FullName           | % { 
            
                $Splat                  = @{
                
                    Path                = "$_"
                    DestinationPath     = $Package | % { $_.Full.Replace( $_.Name , $_.Install ) }
                    Update              = $True
                }
                
                Compress-Archive @Splat -VB
            }

            $_.Folders.FullName         | % { RI "$_.zip" -Force } 

            $Path                       = $Package | % { $_.Root , $_.Install -join '\' }

                SC -Path "$Path.ps1" -Value @'
                Function Get-ScriptDirectory 
                {
                    ( $PSCommandPath , $PSISE.CurrentFile.FullPath )[ $PSISE -ne $Null ] | % {

                        [ PSCustomObject ]@{ 
            
                            Parent = Split-Path $_ -Parent
                            Leaf   = Split-Path $_ -Leaf 
                        }
                    }
                }
    
                Function Install-HybridDSCModule
                {
                    $Control          = [ PSCustomObject ]@{ 

                        Path          = $env:USERPROFILE
                        Target        = "Documents\WindowsPowerShell\Modules\Hybrid-DSC"
                        Chunk         = ""
                        Full          = ""
                        Source        = Get-ScriptDirectory | % { $_.Parent }
                    }
        
                    $Control          | % { 
        
                        $_.Full       = "{0}\{1}" -f $_.Path , $_.Target
                        $_.Chunk      = $_.Target.Split('\')
                        $Path         = $_.Path
                    }

                    ForEach ( $i in 0..( $Control.Chunk.Count - 1 ) )
                    {
                        $Leaf         = $Control.Chunk[$I]

                        If ( ! ( Test-Path "$Path\$Leaf" ) )
                        {
                            NI "$Path\$Leaf" -ItemType Directory | Out-Null
                            Write-Host "   Created [+] $Path" -F 11
                        }

                        Else
                        {
                            Write-Host "  Detected [~] $_" -F 11
                        }
                
                        $Path = "$Path\$Leaf"
                    }

                    If ( $Path -eq $Control.Full )
                    {
                        GCI $Control.Full | % { 
        
                            If ( $_ -ne $Null ) 
                            { 
                                Write-Host " Detected [!] $( $_.Name ), removing" -F 11 
                                RI $_.FullName -Recurse -Force 
                            }
                        }

                        $Control | % { 

                            ForEach ( $i in "Install-HybridDSCModule" )
                            {
                                If ( Test-Path "$( $_.Source )\$I.zip" )
                                {
                                    Write-Host "Extracting [~] $Path\$I" -F 14
                            
                                    Expand-Archive "$( $_.Source )\$I.zip" $_.Full -VB
                                }

                                Else
                                {
                                    Write-Host " Exception [!] Zip file not found"
                                }
                            }

                            ForEach ( $i in "Graphics" , "Control" , "Map" , "Services" ) 
                            {
                                Write-Host "Extracting [~] $( $_.Full )\$I.zip" -F 11
                        
                                Expand-Archive "$( $_.Full )\$I.zip" $_.Full
                        
                                RI "$Path\$I.zip"
                            }
                        }

                        IPMO Hybrid-DSC -Force
                    }
                }
    
                Install-HybridDSCModule

'@

                $Output = "$( $Package.Full ).zip"

                If ( Test-Path $Output )
                {
                    RI $Output -Force -VB
                }

                ForEach ( $i in "ps1" , "zip" )
                {
                    "$Path.$I" | % {

                        $Splat              = @{

                            Path            = $_
                            DestinationPath = $Output
                            Update          = $True
                        
                        }

                        Compress-Archive @Splat -VB
                
                        RI $_ -Force -VB
                    }
                }
            }                                                                        #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-CurrentPID # Collects the (QMark/Processor) ID _________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        ( Get-Service *_* | ? ServiceType -eq 224 )[0].Name.Split( '_' )[-1]         #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
        Write-Theme -Free # What Free Actually Means ____________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
     #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯       
